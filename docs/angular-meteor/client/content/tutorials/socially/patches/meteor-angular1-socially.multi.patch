From 976450256cfa541bf05dc95e0ed0aa7c13471393 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:23:05 +0200
Subject: [PATCH 001/244] Step 0.2: Remove all starter files

---
 socially.css  |  1 -
 socially.html | 14 --------------
 socially.js   | 23 -----------------------
 3 files changed, 38 deletions(-)
 delete mode 100644 socially.css
 delete mode 100644 socially.html
 delete mode 100644 socially.js

diff --git a/socially.css b/socially.css
deleted file mode 100644
index b6b4052..0000000
--- a/socially.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/socially.html b/socially.html
deleted file mode 100644
index cea01d7..0000000
--- a/socially.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<head>
-  <title>socially</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
diff --git a/socially.js b/socially.js
deleted file mode 100644
index 4f8c65d..0000000
--- a/socially.js
+++ /dev/null
@@ -1,23 +0,0 @@
-if (Meteor.isClient) {
-  // counter starts at 0
-  Session.setDefault('counter', 0);
-
-  Template.hello.helpers({
-    counter: function () {
-      return Session.get('counter');
-    }
-  });
-
-  Template.hello.events({
-    'click button': function () {
-      // increment the counter when button is clicked
-      Session.set('counter', Session.get('counter') + 1);
-    }
-  });
-}
-
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    // code to run on server at startup
-  });
-}
-- 
2.3.2 (Apple Git-55)


From f96c67cc04589bad3d84665b1ba0c3a71d4c772d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:24:02 +0200
Subject: [PATCH 002/244] Step 0.3: Create empty index.html file

---
 index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 index.html

diff --git a/index.html b/index.html
new file mode 100644
index 0000000..3887661
--- /dev/null
+++ b/index.html
@@ -0,0 +1,3 @@
+<body>
+<p>Nothing here</p>
+</body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2f6db90320c5dcd8077948e39c7cb1b739cc0853 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:27:26 +0200
Subject: [PATCH 003/244] Step 0.4: Remove meteor default package for UI
 handling

---
 .meteor/packages | 2 --
 1 file changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index a9f8340..2f62174 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -7,14 +7,12 @@
 meteor-base             # Packages every Meteor app needs to have
 mobile-experience       # Packages for a great mobile UX
 mongo                   # The database Meteor supports right now
-blaze-html-templates    # Compile .html files into Meteor Blaze views
 session                 # Client-side reactive dictionary for your app
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
 
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
-ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
-- 
2.3.2 (Apple Git-55)


From be7d185bd0160251f72d2637addc70c140099e7b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:32:15 +0200
Subject: [PATCH 004/244] Step 0.5: Add angular package to the project

---
 .meteor/packages | 1 +
 .meteor/versions | 9 +++++++--
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 2f62174..e3a131b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,3 +16,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+angular
diff --git a/.meteor/versions b/.meteor/versions
index 17859ef..afda2d1 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,7 @@
+angular@1.2.2
+angular-meteor-data@0.0.7
+angular-templates@0.0.1
+angular:angular@1.4.8
 autopublish@1.0.4
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
@@ -5,13 +9,13 @@ babel-runtime@0.1.4
 base64@1.0.4
 binary-heap@1.0.4
 blaze@2.1.3
-blaze-html-templates@1.0.1
 blaze-tools@1.0.4
 boilerplate-generator@1.0.4
 caching-compiler@1.0.0
 caching-html-compiler@1.0.2
 callback-hook@1.0.4
 check@1.1.0
+dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.2
@@ -31,6 +35,7 @@ http@1.1.1
 id-map@1.0.4
 insecure@1.0.4
 jquery@1.11.4
+lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
 logging@1.0.8
@@ -45,6 +50,7 @@ mongo-id@1.0.1
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
+pbastowski:angular-babel@1.0.6
 promise@0.5.1
 random@1.0.5
 reactive-dict@1.1.3
@@ -56,7 +62,6 @@ session@1.1.1
 spacebars@1.0.7
 spacebars-compiler@1.0.7
 standard-minifiers@1.0.2
-templating@1.1.5
 templating-tools@1.0.0
 tracker@1.0.9
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From b6a5ce48c814cef1bfd68d9460ea6fef2dc2ecd2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:36:22 +0200
Subject: [PATCH 005/244] Step 0.6: Move the main content to a new file

---
 main.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 main.html

diff --git a/main.html b/main.html
new file mode 100644
index 0000000..c1e3c17
--- /dev/null
+++ b/main.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 23f2c4d98f95c4fb38bcab2d8d924a798119c329 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:42:12 +0200
Subject: [PATCH 006/244] Step 0.7: Add `ng-include` that loads the main.html
 file

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index 3887661..510c4b2 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
 <body>
-<p>Nothing here</p>
+  <div ng-include src="'main.html'"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From be385cd69c2a1106dcae125730e3c245b7429411 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:42:38 +0200
Subject: [PATCH 007/244] Step 0.8: Add app.js with angular module

---
 app.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 app.js

diff --git a/app.js b/app.js
new file mode 100644
index 0000000..cc85a07
--- /dev/null
+++ b/app.js
@@ -0,0 +1,3 @@
+if (Meteor.isClient) {
+  angular.module('socially', ['angular-meteor']);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 58c5d468e000231a83f5104b76f21e5fc1fd6ec0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:42:55 +0200
Subject: [PATCH 008/244] Step 0.9: Add usage of `ng-app` in our app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index 510c4b2..4300d5c 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include src="'main.html'"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 53a2e932b951aa41805167e8a35a0a90bdfe2e68 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:43:30 +0200
Subject: [PATCH 009/244] Step 0.10: Add some AngularJS code !

---
 main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/main.html b/main.html
index c1e3c17..ff611cc 100644
--- a/main.html
+++ b/main.html
@@ -1 +1 @@
-<p>Nothing here</p>
\ No newline at end of file
+<p>Nothing here {{ 'yet' + '!' }}</p>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8a14640a96ca54c53fce100f0258fca1eb271d42 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 12:45:22 +0200
Subject: [PATCH 010/244] Step 1.1: Add some static HTML the to main page

---
 main.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/main.html b/main.html
index ff611cc..9ea318e 100644
--- a/main.html
+++ b/main.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
\ No newline at end of file
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8c09d812e26cd82325d9d3ad94044f7029b25d72 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:11:28 +0200
Subject: [PATCH 011/244] Step 2.1: Use dynamic template instead of static

---
 .meteor/versions |  6 +++---
 main.html        | 22 ++++++++--------------
 2 files changed, 11 insertions(+), 17 deletions(-)

diff --git a/.meteor/versions b/.meteor/versions
index afda2d1..3f53f36 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,6 +1,6 @@
-angular@1.2.2
-angular-meteor-data@0.0.7
-angular-templates@0.0.1
+angular@1.3.0
+angular-meteor-data@0.0.8
+angular-templates@0.0.2
 angular:angular@1.4.8
 autopublish@1.0.4
 autoupdate@1.2.4
diff --git a/main.html b/main.html
index 9ea318e..2838b47 100644
--- a/main.html
+++ b/main.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
\ No newline at end of file
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4fd7bf90d4e6814c382bef4e9a325cd8dc293b5d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:11:47 +0200
Subject: [PATCH 012/244] Step 2.2: Add the parties controller

---
 app.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/app.js b/app.js
index cc85a07..9cbfb86 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,20 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
+
+  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+    $scope.parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Can we please just for an evening not listen to dubstep.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+  }]);
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 28c12ad932a0e7e4241c25d5d8ef21095fa21d8b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:14:09 +0200
Subject: [PATCH 013/244] Step 2.3: Remove the DI manual decleration

---
 app.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 9cbfb86..eaef6a3 100644
--- a/app.js
+++ b/app.js
@@ -1,7 +1,7 @@
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', ['$scope', function ($scope) {
+  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
     $scope.parties = [
       {
         'name': 'Dubstep-Free Zone',
@@ -16,5 +16,5 @@ if (Meteor.isClient) {
         'description': 'Leisure suit required. And only fiercest manners.'
       }
     ];
-  }]);
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From fd7d291515c9c23d01904bea3c59911fdbaf11a5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:24:29 +0200
Subject: [PATCH 014/244] Step 2.4: Add ng-strict-di directive to the ng-app

---
 index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.html b/index.html
index 4300d5c..78bfb0d 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,3 @@
-<body ng-app="socially">
+<body ng-app="socially" ng-strict-di="">
   <div ng-include src="'main.html'"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 28b0789fa633517643513fe8ca55ac8f332db2c7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:25:16 +0200
Subject: [PATCH 015/244] Step 3.1: Add the parties collection

---
 app.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app.js b/app.js
index eaef6a3..89788bb 100644
--- a/app.js
+++ b/app.js
@@ -1,3 +1,5 @@
+Parties = new Mongo.Collection("parties");
+
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-- 
2.3.2 (Apple Git-55)


From 5dba4cbe9b195463fee6c3fe7bfb288b58f8e900 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:47:56 +0200
Subject: [PATCH 016/244] Step 3.2: Add the parties collection helper

---
 app.js | 17 ++++-------------
 1 file changed, 4 insertions(+), 13 deletions(-)

diff --git a/app.js b/app.js
index 89788bb..abadf15 100644
--- a/app.js
+++ b/app.js
@@ -4,19 +4,10 @@ if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
   angular.module('socially').controller('PartiesListCtrl', function ($scope) {
-    $scope.parties = [
-      {
-        'name': 'Dubstep-Free Zone',
-        'description': 'Can we please just for an evening not listen to dubstep.'
-      },
-      {
-        'name': 'All dubstep all the time',
-        'description': 'Get it on!'
-      },
-      {
-        'name': 'Savage lounging',
-        'description': 'Leisure suit required. And only fiercest manners.'
+    $scope.helpers({
+      parties: () => {
+        return Parties.find({});
       }
-    ];
+    });
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7c2e39b5b7fd1c9b4d197f787028c76e2d86b18a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:49:20 +0200
Subject: [PATCH 017/244] Step 3.3: Add some data to the parties collection

---
 server.js | 24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 server.js

diff --git a/server.js b/server.js
new file mode 100644
index 0000000..0e4439c
--- /dev/null
+++ b/server.js
@@ -0,0 +1,24 @@
+if (Meteor.isServer) {
+  Meteor.startup(function () {
+    if (Parties.find().count() === 0) {
+      var parties = [
+        {
+          'name': 'Dubstep-Free Zone',
+          'description': 'Fast just got faster with Nexus S.'
+        },
+        {
+          'name': 'All dubstep all the time',
+          'description': 'Get it on!'
+        },
+        {
+          'name': 'Savage lounging',
+          'description': 'Leisure suit required. And only fiercest manners.'
+        }
+      ];
+
+      for (var i = 0; i < parties.length; i++) {
+        Parties.insert(parties[i]);
+      }
+    }
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7834ce0ca6aa179877eb2a1b78a739b6df9db851 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:50:04 +0200
Subject: [PATCH 018/244] Step 3.4: Change to use controllerAs syntax

---
 main.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/main.html b/main.html
index 2838b47..5ffe156 100644
--- a/main.html
+++ b/main.html
@@ -1,6 +1,6 @@
-<div ng-controller="PartiesListCtrl">
+<div ng-controller="PartiesListCtrl as vm">
   <ul>
-    <li ng-repeat="party in parties">
+    <li ng-repeat="party in vm.parties">
       {{party.name}}
       <p>{{party.description}}</p>
     </li>
-- 
2.3.2 (Apple Git-55)


From d87c30af981380eed2d1d16c51445c0ead3d93e6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:50:54 +0200
Subject: [PATCH 019/244] Step 3.5: Change the parties controller to use
 $reactive and `this` instead of `$scope`

---
 app.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index abadf15..2dfdb11 100644
--- a/app.js
+++ b/app.js
@@ -3,8 +3,10 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', function ($scope) {
-    $scope.helpers({
+  angular.module('socially').controller('PartiesListCtrl', function ($scope, $reactive) {
+    $reactive(this).attach($scope);
+
+    this.helpers({
       parties: () => {
         return Parties.find({});
       }
-- 
2.3.2 (Apple Git-55)


From 7db115bb940062ab7fb19efb66e4b6d1cb75ed9b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 15:53:08 +0200
Subject: [PATCH 020/244] Step 3.6: Change usage from controllerAs to
 components code-style - view

---
 main.html | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

diff --git a/main.html b/main.html
index 5ffe156..3acf339 100644
--- a/main.html
+++ b/main.html
@@ -1,8 +1 @@
-<div ng-controller="PartiesListCtrl as vm">
-  <ul>
-    <li ng-repeat="party in vm.parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-    </li>
-  </ul>
-</div>
\ No newline at end of file
+<parties-list></parties-list>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0851a001fa84a08023449fb1fccaf61cc818c68d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:00:32 +0200
Subject: [PATCH 021/244] Step 3.7: Move the parties list to a different HTML
 file

---
 parties-list.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 parties-list.html

diff --git a/parties-list.html b/parties-list.html
new file mode 100644
index 0000000..64ac441
--- /dev/null
+++ b/parties-list.html
@@ -0,0 +1,6 @@
+<ul>
+  <li ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+  </li>
+</ul>
-- 
2.3.2 (Apple Git-55)


From 57243ec669f654b6167d34a4711dfc62919a0c5a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:00:58 +0200
Subject: [PATCH 022/244] Step 3.8: Change the PartiesListCtrl to use component
 code-style with directive

---
 app.js | 19 +++++++++++++------
 1 file changed, 13 insertions(+), 6 deletions(-)

diff --git a/app.js b/app.js
index 2dfdb11..95812d3 100644
--- a/app.js
+++ b/app.js
@@ -3,13 +3,20 @@ Parties = new Mongo.Collection("parties");
 if (Meteor.isClient) {
   angular.module('socially', ['angular-meteor']);
 
-  angular.module('socially').controller('PartiesListCtrl', function ($scope, $reactive) {
-    $reactive(this).attach($scope);
+  angular.module('socially').directive('partiesList', function() {
+    return {
+      restrict: 'E',
+      templateUrl: 'parties-list.html',
+      controllerAs: 'partiesList',
+      controller: function($scope, $reactive) {
+        $reactive(this).attach($scope);
 
-    this.helpers({
-      parties: () => {
-        return Parties.find({});
+        this.helpers({
+          parties: () => {
+            return Parties.find({});
+          }
+        });
       }
-    });
+    }
   });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ad43367f07d7f39b5295b81c7e015e1da3153d12 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:04:02 +0200
Subject: [PATCH 023/244] Step 4.1: Add new party form to the parties list view

---
 parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/parties-list.html b/parties-list.html
index 64ac441..dec4f1d 100644
--- a/parties-list.html
+++ b/parties-list.html
@@ -1,3 +1,10 @@
+<form>
+  <label>Party Name: </label>
+  <input type="text" />
+  <label>Description: </label>
+  <input type="text" />
+  <button>Add Party!</button>
+</form>
 <ul>
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
-- 
2.3.2 (Apple Git-55)


From ceb6e250d21ed1d369530bff27a0b13dc1c1d5c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:04:47 +0200
Subject: [PATCH 024/244] Step 4.2: Add ng-model to the form inputs

---
 parties-list.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/parties-list.html b/parties-list.html
index dec4f1d..3611d73 100644
--- a/parties-list.html
+++ b/parties-list.html
@@ -1,8 +1,8 @@
 <form>
   <label>Party Name: </label>
-  <input type="text" />
+  <input type="text" ng-model="partiesList.newParty.name" />
   <label>Description: </label>
-  <input type="text" />
+  <input type="text" ng-model="partiesList.newParty.description" />
   <button>Add Party!</button>
 </form>
 <ul>
-- 
2.3.2 (Apple Git-55)


From 96e3a2faaea08fddf2cb8cfec3376a62e0bfba63 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:05:17 +0200
Subject: [PATCH 025/244] Step 4.3: Add ng-click logic to the button

---
 parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/parties-list.html b/parties-list.html
index 3611d73..e4f0227 100644
--- a/parties-list.html
+++ b/parties-list.html
@@ -3,7 +3,7 @@
   <input type="text" ng-model="partiesList.newParty.name" />
   <label>Description: </label>
   <input type="text" ng-model="partiesList.newParty.description" />
-  <button>Add Party!</button>
+  <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
 <ul>
   <li ng-repeat="party in partiesList.parties">
-- 
2.3.2 (Apple Git-55)


From a0cb7394b84633833d65850d121dc13975748c6a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:08:15 +0200
Subject: [PATCH 026/244] Step 4.4: Add the code-behind to the controller

---
 app.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/app.js b/app.js
index 95812d3..593c1c8 100644
--- a/app.js
+++ b/app.js
@@ -11,11 +11,18 @@ if (Meteor.isClient) {
       controller: function($scope, $reactive) {
         $reactive(this).attach($scope);
 
+        this.newParty = {};
+
         this.helpers({
           parties: () => {
             return Parties.find({});
           }
         });
+
+        this.addParty = () => {
+          Parties.insert(this.newParty);
+          this.newParty = {};
+        };
       }
     }
   });
-- 
2.3.2 (Apple Git-55)


From 4a1cc8a1b6491d24d8e9575209cb2af0040e2bcc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:10:31 +0200
Subject: [PATCH 027/244] Step 4.5: Add X (delete button) to each party

---
 parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/parties-list.html b/parties-list.html
index e4f0227..7273bcb 100644
--- a/parties-list.html
+++ b/parties-list.html
@@ -9,5 +9,6 @@
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
     <p>{{party.description}}</p>
+    <button ng-click="partiesList.removeParty(party)">X</button>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 7218182b703f90a0f63c9373f26b367cce40c5c6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:13:38 +0200
Subject: [PATCH 028/244] Step 4.6: Implement the removeParty method in the
 controller

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index 593c1c8..9bc18e2 100644
--- a/app.js
+++ b/app.js
@@ -23,6 +23,10 @@ if (Meteor.isClient) {
           Parties.insert(this.newParty);
           this.newParty = {};
         };
+
+        this.removeParty = (party) => {
+          Parties.remove({_id: party._id});
+        }
       }
     }
   });
-- 
2.3.2 (Apple Git-55)


From b4e58eebfa89f1f004771ec592e798d06598257c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:15:56 +0200
Subject: [PATCH 029/244] Step 5.1: Add angular-ui-router package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index e3a131b..6734dc6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 angular
+angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index 3f53f36..d952ff2 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -2,6 +2,7 @@ angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
+angularui:angular-ui-router@0.2.15
 autopublish@1.0.4
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
-- 
2.3.2 (Apple Git-55)


From b6eb4afbc96ca12c964ebb015add76f723dd0905 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:16:25 +0200
Subject: [PATCH 030/244] Step 5.2: Add ui-router dependency

---
 app.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/app.js b/app.js
index 9bc18e2..389f1bc 100644
--- a/app.js
+++ b/app.js
@@ -1,7 +1,10 @@
 Parties = new Mongo.Collection("parties");
 
 if (Meteor.isClient) {
-  angular.module('socially', ['angular-meteor']);
+  angular.module('socially', [
+    'angular-meteor',
+    'ui.router'
+  ]);
 
   angular.module('socially').directive('partiesList', function() {
     return {
-- 
2.3.2 (Apple Git-55)


From 847d5fb20c648623e0a5471768b1e125ca527fdd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:17:30 +0200
Subject: [PATCH 031/244] Step 5.3: Add home button and add ui-view usage

---
 index.html | 15 +++++++++++++--
 1 file changed, 13 insertions(+), 2 deletions(-)

diff --git a/index.html b/index.html
index 78bfb0d..e5bf383 100644
--- a/index.html
+++ b/index.html
@@ -1,3 +1,14 @@
-<body ng-app="socially" ng-strict-di="">
-  <div ng-include src="'main.html'"></div>
+<head>
+  <base href="/">
+</head>
+<body>
+
+<div ng-app="socially" ng-strict-di="">
+  <h1>
+    <a href="/parties">Home</a>
+  </h1>
+
+  <div ui-view=""></div>
+</div>
+
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d35aa8ada8743e3c694b8d274fc68801d8a679ea Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:19:55 +0200
Subject: [PATCH 032/244] Step 5.4: Add route definition for parties list

---
 app.js | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 389f1bc..aeb26bc 100644
--- a/app.js
+++ b/app.js
@@ -6,12 +6,24 @@ if (Meteor.isClient) {
     'ui.router'
   ]);
 
-  angular.module('socially').directive('partiesList', function() {
+  angular.module('socially').config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
+    $locationProvider.html5Mode(true);
+
+    $stateProvider
+      .state('parties', {
+        url: '/parties',
+        template: '<parties-list></parties-list>'
+      });
+
+    $urlRouterProvider.otherwise("/parties");
+  });
+
+  angular.module('socially').directive('partiesList', function () {
     return {
       restrict: 'E',
       templateUrl: 'parties-list.html',
       controllerAs: 'partiesList',
-      controller: function($scope, $reactive) {
+      controller: function ($scope, $reactive) {
         $reactive(this).attach($scope);
 
         this.newParty = {};
-- 
2.3.2 (Apple Git-55)


From e635d43d2f1a0d02ad93331acdc92fed9f0d4017 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 16:20:09 +0200
Subject: [PATCH 033/244] Step 5.5: Remove main.html file

---
 main.html | 1 -
 1 file changed, 1 deletion(-)
 delete mode 100644 main.html

diff --git a/main.html b/main.html
deleted file mode 100644
index 3acf339..0000000
--- a/main.html
+++ /dev/null
@@ -1 +0,0 @@
-<parties-list></parties-list>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 42f491a2b498c17ecbc126600a90b86c519a2a4a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:06:45 +0200
Subject: [PATCH 034/244] Step 5.6: Add party details state in the routes file

---
 app.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/app.js b/app.js
index aeb26bc..ee0283e 100644
--- a/app.js
+++ b/app.js
@@ -13,6 +13,10 @@ if (Meteor.isClient) {
       .state('parties', {
         url: '/parties',
         template: '<parties-list></parties-list>'
+      })
+      .state('partyDetails', {
+        url: '/parties/:partyId',
+        template: '<party-details></party-details>'
       });
 
     $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 813b51cfac327bf339598653f50c6edfb8e12a06 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:17:22 +0200
Subject: [PATCH 035/244] Step 5.7: Add the party details component

---
 app.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/app.js b/app.js
index ee0283e..0533d71 100644
--- a/app.js
+++ b/app.js
@@ -49,4 +49,15 @@ if (Meteor.isClient) {
       }
     }
   });
+
+  angular.module('socially').directive('partyDetails', function () {
+    return {
+      restrict: 'E',
+      templateUrl: 'party-details.html',
+      controllerAs: 'partyDetails',
+      controller: function ($scope, $stateParams) {
+        this.partyId = $stateParams.partyId;
+      }
+    }
+  });
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6da3f20d1b22e92062f79fe0713628d85d6ac8ed Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:17:32 +0200
Subject: [PATCH 036/244] Step 5.8: Add the view of the party details component

---
 party-details.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 party-details.html

diff --git a/party-details.html b/party-details.html
new file mode 100644
index 0000000..b6fae63
--- /dev/null
+++ b/party-details.html
@@ -0,0 +1 @@
+The party your selected is: {{ partyDetails.partyId }}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 96f459ff45dedb889d93ce601b0acf241fdf3741 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:19:06 +0200
Subject: [PATCH 037/244] Step 6.1: Add the implementation for the party
 details component

---
 app.js | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/app.js b/app.js
index 0533d71..e16d507 100644
--- a/app.js
+++ b/app.js
@@ -55,8 +55,14 @@ if (Meteor.isClient) {
       restrict: 'E',
       templateUrl: 'party-details.html',
       controllerAs: 'partyDetails',
-      controller: function ($scope, $stateParams) {
-        this.partyId = $stateParams.partyId;
+      controller: function ($scope, $stateParams, $reactive) {
+        $reactive(this).attach($scope);
+
+        this.helpers({
+          party: () => {
+            return Parties.findOne({ _id: $stateParams.partyId });
+          }
+        });
       }
     }
   });
-- 
2.3.2 (Apple Git-55)


From 3afd7456a2f6a96b3728e8fb3e30d3e013927126 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:20:45 +0200
Subject: [PATCH 038/244] Step 6.2: Add form with the party details to the
 party details page

---
 party-details.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/party-details.html b/party-details.html
index b6fae63..a5f77ca 100644
--- a/party-details.html
+++ b/party-details.html
@@ -1 +1,5 @@
-The party your selected is: {{ partyDetails.partyId }}
\ No newline at end of file
+The party your selected is:
+<form>
+  Party name: <input type="text" ng-model="partyDetails.party.name" />
+  Description: <input type="text" ng-model="partyDetails.party.description" />
+</form>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4656c097c6094da96f751187880231fe585ecc0e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:23:26 +0200
Subject: [PATCH 039/244] Step 6.3: Add save and back buttons to the view

---
 party-details.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/party-details.html b/party-details.html
index a5f77ca..d0cf4be 100644
--- a/party-details.html
+++ b/party-details.html
@@ -2,4 +2,6 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
-</form>
\ No newline at end of file
+  <button ng-click="partyDetails.save()">Save</button>
+</form>
+<button ui-sref="parties">Back</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cee7cc5fe5bd4b32996d7507d67f8a9ba1adac32 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:24:50 +0200
Subject: [PATCH 040/244] Step 6.4: Implement save button on the component
 logic

---
 app.js | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/app.js b/app.js
index e16d507..0d65861 100644
--- a/app.js
+++ b/app.js
@@ -60,9 +60,18 @@ if (Meteor.isClient) {
 
         this.helpers({
           party: () => {
-            return Parties.findOne({ _id: $stateParams.partyId });
+            return Parties.findOne({_id: $stateParams.partyId});
           }
         });
+
+        this.save = () => {
+          Parties.update({_id: $stateParams.partyId}, {
+            $set: {
+              name: this.party.name,
+              description: this.party.description
+            }
+          });
+        };
       }
     }
   });
-- 
2.3.2 (Apple Git-55)


From e3321adaf986f596165d7a675a839897d132e1dc Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 17:28:40 +0200
Subject: [PATCH 041/244] Step 6.5: Handle success and fail for data actions

---
 app.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/app.js b/app.js
index 0d65861..bd703b2 100644
--- a/app.js
+++ b/app.js
@@ -70,6 +70,13 @@ if (Meteor.isClient) {
               name: this.party.name,
               description: this.party.description
             }
+          }, (error) => {
+            if (error) {
+              console.log('Oops, unable to update the party...');
+            }
+            else {
+              console.log('Done!');
+            }
           });
         };
       }
-- 
2.3.2 (Apple Git-55)


From 5184de27aa6f1a2abcb46a7e7f151409e4e0a486 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:36:43 +0200
Subject: [PATCH 042/244] Step 6.6: Add link to the party details page in the
 parties list

---
 parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/parties-list.html b/parties-list.html
index 7273bcb..b0fd6bb 100644
--- a/parties-list.html
+++ b/parties-list.html
@@ -6,7 +6,7 @@
   <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
 <ul>
-  <li ng-repeat="party in partiesList.parties">
+  <li ui-sref="partyDetails({ partyId: party._id })" ng-repeat="party in partiesList.parties">
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
-- 
2.3.2 (Apple Git-55)


From 94f8777feeb15c4d56f48a86ff0d9ee87ba91c1e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 18:07:03 +0200
Subject: [PATCH 043/244] Step 7.1: client/lib/app.js

---
 client/lib/app.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/lib/app.js

diff --git a/client/lib/app.js b/client/lib/app.js
new file mode 100644
index 0000000..708551d
--- /dev/null
+++ b/client/lib/app.js
@@ -0,0 +1 @@
+angular.module('socially', ['angular-meteor', 'ui.router']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 163b7a9fbda7e694ecb0ad244eeabdcf319361f2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 18:07:34 +0200
Subject: [PATCH 044/244] Step 7.2: model/parties.js

---
 model/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 model/parties.js

diff --git a/model/parties.js b/model/parties.js
new file mode 100644
index 0000000..dc0ccc3
--- /dev/null
+++ b/model/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection("parties");
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7836462064821c40a5f064cfc89ef07045b49f1f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:45:41 +0200
Subject: [PATCH 045/244] Step 7.3: server/startup/loadParties.js

---
 server/startup/loadParties.js | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
 create mode 100644 server/startup/loadParties.js

diff --git a/server/startup/loadParties.js b/server/startup/loadParties.js
new file mode 100644
index 0000000..e5af840
--- /dev/null
+++ b/server/startup/loadParties.js
@@ -0,0 +1,22 @@
+Meteor.startup(function () {
+  if (Parties.find().count() === 0) {
+    var parties = [
+      {
+        'name': 'Dubstep-Free Zone',
+        'description': 'Fast just got faster with Nexus S.'
+      },
+      {
+        'name': 'All dubstep all the time',
+        'description': 'Get it on!'
+      },
+      {
+        'name': 'Savage lounging',
+        'description': 'Leisure suit required. And only fiercest manners.'
+      }
+    ];
+
+    for (var i = 0; i < parties.length; i++) {
+      Parties.insert(parties[i]);
+    }
+  }
+});
-- 
2.3.2 (Apple Git-55)


From b717ee6f94c55e3366515c6f3b5be807f44346c6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:46:30 +0200
Subject: [PATCH 046/244] Step 7.4: client/routes.js

---
 client/routes.js | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 client/routes.js

diff --git a/client/routes.js b/client/routes.js
new file mode 100644
index 0000000..ee84b09
--- /dev/null
+++ b/client/routes.js
@@ -0,0 +1,15 @@
+angular.module('socially').config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
+  $locationProvider.html5Mode(true);
+
+  $stateProvider
+    .state('parties', {
+      url: '/parties',
+      template: '<parties-list></parties-list>'
+    })
+    .state('partyDetails', {
+      url: '/parties/:partyId',
+      template: '<party-details></party-details>'
+    });
+
+  $urlRouterProvider.otherwise("/parties");
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5b46038cf68167add5ba9ff34f2a488a8351027e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:49:47 +0200
Subject: [PATCH 047/244] Step 7.5:
 client/parties/parties-list/parties-list.component.js

---
 .../parties/parties-list/parties-list.component.js | 27 ++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 client/parties/parties-list/parties-list.component.js

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
new file mode 100644
index 0000000..e11446d
--- /dev/null
+++ b/client/parties/parties-list/parties-list.component.js
@@ -0,0 +1,27 @@
+angular.module('socially').directive('partiesList', function () {
+  return {
+    restrict: 'E',
+    templateUrl: 'parties-list.html',
+    controllerAs: 'partiesList',
+    controller: function ($scope, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.newParty = {};
+
+      this.helpers({
+        parties: () => {
+          return Parties.find({});
+        }
+      });
+
+      this.addParty = () => {
+        Parties.insert(this.newParty);
+        this.newParty = {};
+      };
+
+      this.removeParty = (party) => {
+        Parties.remove({_id: party._id});
+      }
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 23bceec804b4066f5a9439fc9ed806dfcf00c046 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:50:12 +0200
Subject: [PATCH 048/244] Step 7.6:
 client/parties/parties-list/parties-list.html

---
 client/parties/parties-list/parties-list.html | 14 ++++++++++++++
 parties-list.html                             | 14 --------------
 2 files changed, 14 insertions(+), 14 deletions(-)
 create mode 100644 client/parties/parties-list/parties-list.html
 delete mode 100644 parties-list.html

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
new file mode 100644
index 0000000..b0fd6bb
--- /dev/null
+++ b/client/parties/parties-list/parties-list.html
@@ -0,0 +1,14 @@
+<form>
+  <label>Party Name: </label>
+  <input type="text" ng-model="partiesList.newParty.name" />
+  <label>Description: </label>
+  <input type="text" ng-model="partiesList.newParty.description" />
+  <button ng-click="partiesList.addParty()">Add Party!</button>
+</form>
+<ul>
+  <li ui-sref="partyDetails({ partyId: party._id })" ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+    <button ng-click="partiesList.removeParty(party)">X</button>
+  </li>
+</ul>
diff --git a/parties-list.html b/parties-list.html
deleted file mode 100644
index b0fd6bb..0000000
--- a/parties-list.html
+++ /dev/null
@@ -1,14 +0,0 @@
-<form>
-  <label>Party Name: </label>
-  <input type="text" ng-model="partiesList.newParty.name" />
-  <label>Description: </label>
-  <input type="text" ng-model="partiesList.newParty.description" />
-  <button ng-click="partiesList.addParty()">Add Party!</button>
-</form>
-<ul>
-  <li ui-sref="partyDetails({ partyId: party._id })" ng-repeat="party in partiesList.parties">
-    {{party.name}}
-    <p>{{party.description}}</p>
-    <button ng-click="partiesList.removeParty(party)">X</button>
-  </li>
-</ul>
-- 
2.3.2 (Apple Git-55)


From 36896fe2811d559b5f39ee0b244a81acdfb2bf0e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:51:16 +0200
Subject: [PATCH 049/244] Step 7.7:
 client/parties/party-details/party-details.component.js

---
 .../party-details/party-details.component.js       | 32 ++++++++++++++++++++++
 1 file changed, 32 insertions(+)
 create mode 100644 client/parties/party-details/party-details.component.js

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
new file mode 100644
index 0000000..0203ffb
--- /dev/null
+++ b/client/parties/party-details/party-details.component.js
@@ -0,0 +1,32 @@
+angular.module('socially').directive('partyDetails', function () {
+  return {
+    restrict: 'E',
+    templateUrl: 'party-details.html',
+    controllerAs: 'partyDetails',
+    controller: function ($scope, $stateParams, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        party: () => {
+          return Parties.findOne({_id: $stateParams.partyId});
+        }
+      });
+
+      this.save = () => {
+        Parties.update({_id: $stateParams.partyId}, {
+          $set: {
+            name: this.party.name,
+            description: this.party.description
+          }
+        }, (error) => {
+          if (error) {
+            console.log('Oops, unable to update the party...');
+          }
+          else {
+            console.log('Done!');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b1e9a63320abfcde8516a453c0768341f086ab9b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:51:48 +0200
Subject: [PATCH 050/244] Step 7.8:
 client/parties/party-details/party-details.html

---
 client/parties/party-details/party-details.html | 7 +++++++
 party-details.html                              | 7 -------
 2 files changed, 7 insertions(+), 7 deletions(-)
 create mode 100644 client/parties/party-details/party-details.html
 delete mode 100644 party-details.html

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
new file mode 100644
index 0000000..d0cf4be
--- /dev/null
+++ b/client/parties/party-details/party-details.html
@@ -0,0 +1,7 @@
+The party your selected is:
+<form>
+  Party name: <input type="text" ng-model="partyDetails.party.name" />
+  Description: <input type="text" ng-model="partyDetails.party.description" />
+  <button ng-click="partyDetails.save()">Save</button>
+</form>
+<button ui-sref="parties">Back</button>
\ No newline at end of file
diff --git a/party-details.html b/party-details.html
deleted file mode 100644
index d0cf4be..0000000
--- a/party-details.html
+++ /dev/null
@@ -1,7 +0,0 @@
-The party your selected is:
-<form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" />
-  Description: <input type="text" ng-model="partyDetails.party.description" />
-  <button ng-click="partyDetails.save()">Save</button>
-</form>
-<button ui-sref="parties">Back</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 57edbbda17bed9117074803dd97b6ecf06661adb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:55:35 +0200
Subject: [PATCH 051/244] Step 7.9: Update templateUrl path in the components

---
 client/parties/parties-list/parties-list.component.js   | 2 +-
 client/parties/party-details/party-details.component.js | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index e11446d..015de29 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -1,7 +1,7 @@
 angular.module('socially').directive('partiesList', function () {
   return {
     restrict: 'E',
-    templateUrl: 'parties-list.html',
+    templateUrl: 'client/parties/parties-list/parties-list.html',
     controllerAs: 'partiesList',
     controller: function ($scope, $reactive) {
       $reactive(this).attach($scope);
diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 0203ffb..f28307f 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -1,7 +1,7 @@
 angular.module('socially').directive('partyDetails', function () {
   return {
     restrict: 'E',
-    templateUrl: 'party-details.html',
+    templateUrl: 'client/parties/party-details/party-details.html',
     controllerAs: 'partyDetails',
     controller: function ($scope, $stateParams, $reactive) {
       $reactive(this).attach($scope);
-- 
2.3.2 (Apple Git-55)


From a7ff546b517c8cd229b87fde933c8bb31e538ea5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 20:55:45 +0200
Subject: [PATCH 052/244] Step 7.10: Delete old files

---
 app.js    | 85 ---------------------------------------------------------------
 server.js | 24 ------------------
 2 files changed, 109 deletions(-)
 delete mode 100644 app.js
 delete mode 100644 server.js

diff --git a/app.js b/app.js
deleted file mode 100644
index bd703b2..0000000
--- a/app.js
+++ /dev/null
@@ -1,85 +0,0 @@
-Parties = new Mongo.Collection("parties");
-
-if (Meteor.isClient) {
-  angular.module('socially', [
-    'angular-meteor',
-    'ui.router'
-  ]);
-
-  angular.module('socially').config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
-    $locationProvider.html5Mode(true);
-
-    $stateProvider
-      .state('parties', {
-        url: '/parties',
-        template: '<parties-list></parties-list>'
-      })
-      .state('partyDetails', {
-        url: '/parties/:partyId',
-        template: '<party-details></party-details>'
-      });
-
-    $urlRouterProvider.otherwise("/parties");
-  });
-
-  angular.module('socially').directive('partiesList', function () {
-    return {
-      restrict: 'E',
-      templateUrl: 'parties-list.html',
-      controllerAs: 'partiesList',
-      controller: function ($scope, $reactive) {
-        $reactive(this).attach($scope);
-
-        this.newParty = {};
-
-        this.helpers({
-          parties: () => {
-            return Parties.find({});
-          }
-        });
-
-        this.addParty = () => {
-          Parties.insert(this.newParty);
-          this.newParty = {};
-        };
-
-        this.removeParty = (party) => {
-          Parties.remove({_id: party._id});
-        }
-      }
-    }
-  });
-
-  angular.module('socially').directive('partyDetails', function () {
-    return {
-      restrict: 'E',
-      templateUrl: 'party-details.html',
-      controllerAs: 'partyDetails',
-      controller: function ($scope, $stateParams, $reactive) {
-        $reactive(this).attach($scope);
-
-        this.helpers({
-          party: () => {
-            return Parties.findOne({_id: $stateParams.partyId});
-          }
-        });
-
-        this.save = () => {
-          Parties.update({_id: $stateParams.partyId}, {
-            $set: {
-              name: this.party.name,
-              description: this.party.description
-            }
-          }, (error) => {
-            if (error) {
-              console.log('Oops, unable to update the party...');
-            }
-            else {
-              console.log('Done!');
-            }
-          });
-        };
-      }
-    }
-  });
-}
\ No newline at end of file
diff --git a/server.js b/server.js
deleted file mode 100644
index 0e4439c..0000000
--- a/server.js
+++ /dev/null
@@ -1,24 +0,0 @@
-if (Meteor.isServer) {
-  Meteor.startup(function () {
-    if (Parties.find().count() === 0) {
-      var parties = [
-        {
-          'name': 'Dubstep-Free Zone',
-          'description': 'Fast just got faster with Nexus S.'
-        },
-        {
-          'name': 'All dubstep all the time',
-          'description': 'Get it on!'
-        },
-        {
-          'name': 'Savage lounging',
-          'description': 'Leisure suit required. And only fiercest manners.'
-        }
-      ];
-
-      for (var i = 0; i < parties.length; i++) {
-        Parties.insert(parties[i]);
-      }
-    }
-  });
-}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9042c51b9b08047d757d9fd236b370fb553d80a5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:05:44 +0200
Subject: [PATCH 053/244] Step 8.1: Remove insecure package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 6734dc6..a255582 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,6 +15,5 @@ standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 angular
 angularui:angular-ui-router
diff --git a/.meteor/versions b/.meteor/versions
index d952ff2..2f9d887 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -34,7 +34,6 @@ html-tools@1.0.5
 htmljs@1.0.5
 http@1.1.1
 id-map@1.0.4
-insecure@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
-- 
2.3.2 (Apple Git-55)


From 15d7003ba3e31a96b806e40a291b2b5268a288b7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:06:23 +0200
Subject: [PATCH 054/244] Step 8.2: Add accounts-password package

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a255582..c20f8f1 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,4 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index 2f9d887..3c4ad56 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.2
+accounts-password@1.1.4
 angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
@@ -20,12 +22,14 @@ dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
 ddp-common@1.2.2
+ddp-rate-limiter@1.0.0
 ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
 ecmascript@0.1.6
 ecmascript-runtime@0.2.6
 ejson@1.0.7
+email@1.0.8
 es5-shim@4.1.14
 fastclick@1.0.7
 geojson-utils@1.0.4
@@ -38,6 +42,7 @@ jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
 livedata@1.0.15
+localstorage@1.0.5
 logging@1.0.8
 meteor@1.1.10
 meteor-base@1.0.1
@@ -47,20 +52,25 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.6
 promise@0.5.1
 random@1.0.5
+rate-limit@1.0.0
 reactive-dict@1.1.3
 reactive-var@1.0.6
 reload@1.1.4
 retry@1.0.4
 routepolicy@1.0.6
+service-configuration@1.0.5
 session@1.1.1
+sha@1.0.4
 spacebars@1.0.7
 spacebars-compiler@1.0.7
+srp@1.0.4
 standard-minifiers@1.0.2
 templating-tools@1.0.0
 tracker@1.0.9
-- 
2.3.2 (Apple Git-55)


From b6a49aeee80086e8bbe2095c98187fc318ee8d0b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:07:03 +0200
Subject: [PATCH 055/244] Step 8.3: Add dotansimha:angular-accounts-ui package

---
 .meteor/packages | 1 +
 .meteor/versions | 6 ++++++
 2 files changed, 7 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c20f8f1..a5ed1f6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -18,3 +18,4 @@ autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
 accounts-password
+dotansimha:accounts-ui-angular
diff --git a/.meteor/versions b/.meteor/versions
index 3c4ad56..cc04f49 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.2
 accounts-password@1.1.4
+accounts-ui@1.1.6
+accounts-ui-unstyled@1.1.8
 angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
@@ -12,6 +14,7 @@ babel-runtime@0.1.4
 base64@1.0.4
 binary-heap@1.0.4
 blaze@2.1.3
+blaze-html-templates@1.0.1
 blaze-tools@1.0.4
 boilerplate-generator@1.0.4
 caching-compiler@1.0.0
@@ -26,6 +29,7 @@ ddp-rate-limiter@1.0.0
 ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
+dotansimha:accounts-ui-angular@0.0.2
 ecmascript@0.1.6
 ecmascript-runtime@0.2.6
 ejson@1.0.7
@@ -41,6 +45,7 @@ id-map@1.0.4
 jquery@1.11.4
 lai:collection-extensions@0.1.4
 launch-screen@1.0.4
+less@2.5.1
 livedata@1.0.15
 localstorage@1.0.5
 logging@1.0.8
@@ -72,6 +77,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.2
+templating@1.1.5
 templating-tools@1.0.0
 tracker@1.0.9
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From 9c980b140d730a70e25e1be5ba8c32489c5d9c26 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:07:42 +0200
Subject: [PATCH 056/244] Step 8.4: Add a dependecy for accounts-ui package

---
 client/lib/app.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 708551d..ab40ccc 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1 +1,5 @@
-angular.module('socially', ['angular-meteor', 'ui.router']);
\ No newline at end of file
+angular.module('socially', [
+  'angular-meteor',
+  'ui.router',
+  'accounts.ui'
+]);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From fff59e673e711caa9c799d836cabeeae692d1904 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:08:16 +0200
Subject: [PATCH 057/244] Step 8.5: Add usage for login-buttons directive

---
 index.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/index.html b/index.html
index e5bf383..a64c26b 100644
--- a/index.html
+++ b/index.html
@@ -4,6 +4,7 @@
 <body>
 
 <div ng-app="socially" ng-strict-di="">
+  <login-buttons></login-buttons>
   <h1>
     <a href="/parties">Home</a>
   </h1>
-- 
2.3.2 (Apple Git-55)


From da04173687b8f5da943e07efbd69d9f897df9078 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:09:02 +0200
Subject: [PATCH 058/244] Step 8.6: Add allow logic to the model

---
 model/parties.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/model/parties.js b/model/parties.js
index dc0ccc3..b793c1f 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -1 +1,13 @@
-Parties = new Mongo.Collection("parties");
\ No newline at end of file
+Parties = new Mongo.Collection("parties");
+
+Parties.allow({
+  insert: function (userId, party) {
+    return userId && party.owner === userId;
+  },
+  update: function (userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove: function (userId, party) {
+    return userId && party.owner === userId;
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1cd721716fc8da963176967b22638095df624795 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:11:40 +0200
Subject: [PATCH 059/244] Step 8.7: Add current user to the new party

---
 client/parties/parties-list/parties-list.component.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 015de29..85b6d90 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -15,6 +15,7 @@ angular.module('socially').directive('partiesList', function () {
       });
 
       this.addParty = () => {
+        this.newParty.owner = Meteor.user()._id;
         Parties.insert(this.newParty);
         this.newParty = {};
       };
-- 
2.3.2 (Apple Git-55)


From c0c48d42ee1bdb5f2d32453762594833dd2f33b0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:13:35 +0200
Subject: [PATCH 060/244] Step 8.8: Add accounts-facebook and accounts-twitter
 packages

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a5ed1f6..9cea96c 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,5 @@ angular
 angularui:angular-ui-router
 accounts-password
 dotansimha:accounts-ui-angular
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index cc04f49..b9b2985 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.2
+accounts-facebook@1.0.6
+accounts-oauth@1.1.8
 accounts-password@1.1.4
+accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
 angular@1.3.0
@@ -35,6 +38,7 @@ ecmascript-runtime@0.2.6
 ejson@1.0.7
 email@1.0.8
 es5-shim@4.1.14
+facebook@1.2.2
 fastclick@1.0.7
 geojson-utils@1.0.4
 hot-code-push@1.0.0
@@ -59,6 +63,9 @@ mongo@1.1.3
 mongo-id@1.0.1
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
+oauth@1.1.6
+oauth1@1.1.5
+oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.6
@@ -80,6 +87,7 @@ standard-minifiers@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
 tracker@1.0.9
+twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 url@1.0.5
-- 
2.3.2 (Apple Git-55)


From d96fb5d194dfe00696fd6047431540bb641a3e01 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:46:31 +0200
Subject: [PATCH 061/244] Step 8.9: Added permissions limit to the party
 details page

---
 client/routes.js | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)

diff --git a/client/routes.js b/client/routes.js
index ee84b09..8ce70b3 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -8,7 +8,17 @@ angular.module('socially').config(function ($urlRouterProvider, $stateProvider,
     })
     .state('partyDetails', {
       url: '/parties/:partyId',
-      template: '<party-details></party-details>'
+      template: '<party-details></party-details>',
+      resolve: {
+        currentUser: ($q) => {
+          if (Meteor.userId() == null) {
+            return $q.reject();
+          }
+          else {
+            return $q.resolve();
+          }
+        }
+      }
     });
 
   $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From 0cbc88f0a2e4f6e980ac043255afcc4bf6f48132 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:48:35 +0200
Subject: [PATCH 062/244] Step 8.10: Added the ability to detect if the user is
 not logged in

---
 client/routes.js | 48 ++++++++++++++++++++++++++++--------------------
 1 file changed, 28 insertions(+), 20 deletions(-)

diff --git a/client/routes.js b/client/routes.js
index 8ce70b3..545a926 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -1,25 +1,33 @@
-angular.module('socially').config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
-  $locationProvider.html5Mode(true);
+angular.module('socially')
+  .config(function ($urlRouterProvider, $stateProvider, $locationProvider) {
+    $locationProvider.html5Mode(true);
 
-  $stateProvider
-    .state('parties', {
-      url: '/parties',
-      template: '<parties-list></parties-list>'
-    })
-    .state('partyDetails', {
-      url: '/parties/:partyId',
-      template: '<party-details></party-details>',
-      resolve: {
-        currentUser: ($q) => {
-          if (Meteor.userId() == null) {
-            return $q.reject();
-          }
-          else {
-            return $q.resolve();
+    $stateProvider
+      .state('parties', {
+        url: '/parties',
+        template: '<parties-list></parties-list>'
+      })
+      .state('partyDetails', {
+        url: '/parties/:partyId',
+        template: '<party-details></party-details>',
+        resolve: {
+          currentUser: ($q) => {
+            if (Meteor.userId() == null) {
+              return $q.reject('AUTH_REQUIRED');
+            }
+            else {
+              return $q.resolve();
+            }
           }
         }
+      });
+
+    $urlRouterProvider.otherwise("/parties");
+  })
+  .run(function ($rootScope, $state) {
+    $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {
+      if (error === 'AUTH_REQUIRED') {
+        $state.go('parties');
       }
     });
-
-  $urlRouterProvider.otherwise("/parties");
-});
\ No newline at end of file
+  });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 631ad03eeb97afae2d8a141342998f33628fee0b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:49:29 +0200
Subject: [PATCH 063/244] Step 9.1: Remove autopublish package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 9cea96c..32813c3 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -14,7 +14,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifiers      # JS/CSS minifiers run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
-autopublish             # Publish all data to the clients (for prototyping)
 angular
 angularui:angular-ui-router
 accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index b9b2985..8bcf116 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,7 +10,6 @@ angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
 angularui:angular-ui-router@0.2.15
-autopublish@1.0.4
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From e64f68e7bb8b162923f4c0d9ceeeb1fa9835c013 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:51:43 +0200
Subject: [PATCH 064/244] Step 9.2: Add the 'parties' publication to the server

---
 server/parties.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 server/parties.js

diff --git a/server/parties.js b/server/parties.js
new file mode 100644
index 0000000..6aba8a3
--- /dev/null
+++ b/server/parties.js
@@ -0,0 +1,18 @@
+Meteor.publish("parties", function () {
+  return Parties.find({
+    $or: [
+      {
+        $and: [
+          {"public": true},
+          {"public": {$exists: true}}
+        ]
+      },
+      {
+        $and: [
+          {owner: this.userId},
+          {owner: {$exists: true}}
+        ]
+      }
+    ]
+  });
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6da59fe9908ec7d0b5a5dc87cb2389f28a90e75e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:57:09 +0200
Subject: [PATCH 065/244] Step 9.3: Add the `parties` subscription in the
 client side

---
 client/parties/parties-list/parties-list.component.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 85b6d90..1c8d791 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -8,6 +8,8 @@ angular.module('socially').directive('partiesList', function () {
 
       this.newParty = {};
 
+      this.subscribe('parties');
+
       this.helpers({
         parties: () => {
           return Parties.find({});
-- 
2.3.2 (Apple Git-55)


From cb322dfb92c80d46803b3c93a140f5f90c1eebdf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 21:57:40 +0200
Subject: [PATCH 066/244] Step 9.4: Add public party checkbox to the add new
 party form

---
 client/parties/parties-list/parties-list.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index b0fd6bb..bcff75b 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -3,6 +3,8 @@
   <input type="text" ng-model="partiesList.newParty.name" />
   <label>Description: </label>
   <input type="text" ng-model="partiesList.newParty.description" />
+  <label>Public Party?</label>
+  <input type="checkbox" ng-model="partiesList.newParty.public">
   <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
 <ul>
-- 
2.3.2 (Apple Git-55)


From 2b10b9d6e07b5493f235564428fd673fef27ae1d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:01:21 +0200
Subject: [PATCH 067/244] Step 9.5: Add is public checkbox to the party details
 view

---
 client/parties/party-details/party-details.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index d0cf4be..141f0c9 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -2,6 +2,7 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 <button ui-sref="parties">Back</button>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b784a8ea19e0af780065e939239f929faf6df25d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:01:40 +0200
Subject: [PATCH 068/244] Step 9.6: Add is public checkbox to the party details
 component

---
 client/parties/party-details/party-details.component.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index f28307f..7ae6989 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -16,7 +16,8 @@ angular.module('socially').directive('partyDetails', function () {
         Parties.update({_id: $stateParams.partyId}, {
           $set: {
             name: this.party.name,
-            description: this.party.description
+            description: this.party.description,
+            'public': this.party.public
           }
         }, (error) => {
           if (error) {
-- 
2.3.2 (Apple Git-55)


From 95e9ecc39a1901b800945a371600fa0db20daa34 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:02:20 +0200
Subject: [PATCH 069/244] Step 9.7: Create the users publication in the server

---
 server/users.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 server/users.js

diff --git a/server/users.js b/server/users.js
new file mode 100644
index 0000000..f5becea
--- /dev/null
+++ b/server/users.js
@@ -0,0 +1,3 @@
+Meteor.publish("users", function () {
+  return Meteor.users.find({}, {fields: {emails: 1, profile: 1}});
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 58f3d48d93f88e3d8d5a0246c1b4217c1333e20f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:07:26 +0200
Subject: [PATCH 070/244] Step 9.8: Add users subscription and helper

---
 client/parties/party-details/party-details.component.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 7ae6989..288c9c2 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -6,9 +6,14 @@ angular.module('socially').directive('partyDetails', function () {
     controller: function ($scope, $stateParams, $reactive) {
       $reactive(this).attach($scope);
 
+      this.subscribe('users');
+
       this.helpers({
         party: () => {
           return Parties.findOne({_id: $stateParams.partyId});
+        },
+        users: () => {
+          return Meteor.users.find({});
         }
       });
 
-- 
2.3.2 (Apple Git-55)


From 1f8b83b24656c92fb0e7843ed93d0289608fad14 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:07:38 +0200
Subject: [PATCH 071/244] Step 9.9: Add subscription to parties

---
 client/parties/party-details/party-details.component.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 288c9c2..3ecea19 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -6,6 +6,7 @@ angular.module('socially').directive('partyDetails', function () {
     controller: function ($scope, $stateParams, $reactive) {
       $reactive(this).attach($scope);
 
+      this.subscribe('parties');
       this.subscribe('users');
 
       this.helpers({
-- 
2.3.2 (Apple Git-55)


From 21afc9fcf4ea3a353e38ba7f5b4038d9bcf8a8f5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:08:26 +0200
Subject: [PATCH 072/244] Step 9.10: Add the users list to the party details
 view

---
 client/parties/party-details/party-details.html | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index 141f0c9..8b18a5f 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -5,4 +5,11 @@ The party your selected is:
   Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
   <button ng-click="partyDetails.save()">Save</button>
 </form>
-<button ui-sref="parties">Back</button>
\ No newline at end of file
+<button ui-sref="parties">Back</button>
+
+<ul>
+  Users:
+  <li ng-repeat="user in partyDetails.users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0f04c09d2690018763de2b3aefa250a47950466d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:15:04 +0200
Subject: [PATCH 073/244] Step 11.1: Update the module initialization

---
 client/lib/app.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index ab40ccc..01f6271 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -2,4 +2,15 @@ angular.module('socially', [
   'angular-meteor',
   'ui.router',
   'accounts.ui'
-]);
\ No newline at end of file
+]);
+
+function onReady() {
+  angular.bootstrap(document, ['socially'], {
+    strictDi: true
+  });
+}
+
+if (Meteor.isCordova)
+  angular.element(document).on("deviceready", onReady);
+else
+  angular.element(document).ready(onReady);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 66b682f24beee914783265a9e5421eab274a6a47 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:15:43 +0200
Subject: [PATCH 074/244] Step 11.2: Remove the ng-app usage

---
 index.html | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

diff --git a/index.html b/index.html
index a64c26b..ccecce2 100644
--- a/index.html
+++ b/index.html
@@ -3,13 +3,11 @@
 </head>
 <body>
 
-<div ng-app="socially" ng-strict-di="">
-  <login-buttons></login-buttons>
-  <h1>
-    <a href="/parties">Home</a>
-  </h1>
+<login-buttons></login-buttons>
+<h1>
+  <a href="/parties">Home</a>
+</h1>
 
-  <div ui-view=""></div>
-</div>
+<div ui-view=""></div>
 
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e706e1cb4988f115a1d2e4718ac1dc4a3b8a35bd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:17:36 +0200
Subject: [PATCH 075/244] Step 12.1: Add options to the parties publish

---
 server/parties.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/parties.js b/server/parties.js
index 6aba8a3..a0d40a9 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function () {
+Meteor.publish("parties", function (options) {
   return Parties.find({
     $or: [
       {
@@ -14,5 +14,5 @@ Meteor.publish("parties", function () {
         ]
       }
     ]
-  });
+  }, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cf57f61c97f4a0820ef7be1bdb05f6e1c5562722 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:18:09 +0200
Subject: [PATCH 076/244] Step 12.2: Add the pagination default params

---
 client/parties/parties-list/parties-list.component.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 1c8d791..ebfa3bc 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -7,12 +7,17 @@ angular.module('socially').directive('partiesList', function () {
       $reactive(this).attach($scope);
 
       this.newParty = {};
+      this.perPage = 3;
 
       this.subscribe('parties');
 
       this.helpers({
         parties: () => {
           return Parties.find({});
+        },
+        page: 1,
+        sort: {
+          name: 1
         }
       });
 
-- 
2.3.2 (Apple Git-55)


From b8a4b4a9cffa579956ce94f4a34f903514050d44 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:20:10 +0200
Subject: [PATCH 077/244] Step 12.3: Add the params to the subscription

---
 client/parties/parties-list/parties-list.component.js | 12 ++++++++++--
 1 file changed, 10 insertions(+), 2 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index ebfa3bc..4f58464 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -9,8 +9,6 @@ angular.module('socially').directive('partiesList', function () {
       this.newParty = {};
       this.perPage = 3;
 
-      this.subscribe('parties');
-
       this.helpers({
         parties: () => {
           return Parties.find({});
@@ -21,6 +19,16 @@ angular.module('socially').directive('partiesList', function () {
         }
       });
 
+      this.subscribe('parties', () => {
+        return [
+          {
+            limit: parseInt(this.perPage),
+            skip: parseInt((this.page - 1) * this.perPage),
+            sort: this.sort
+          }
+        ]
+      });
+
       this.addParty = () => {
         this.newParty.owner = Meteor.user()._id;
         Parties.insert(this.newParty);
-- 
2.3.2 (Apple Git-55)


From 7df855daf4a17b85cd5ea425905ba078c17c9d5e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:21:16 +0200
Subject: [PATCH 078/244] Step 12.4: Add the sort parameter to the collection
 helper

---
 client/parties/parties-list/parties-list.component.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 4f58464..a40ac14 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -11,7 +11,7 @@ angular.module('socially').directive('partiesList', function () {
 
       this.helpers({
         parties: () => {
-          return Parties.find({});
+          return Parties.find({}, { sort : this.sort });
         },
         page: 1,
         sort: {
-- 
2.3.2 (Apple Git-55)


From 215fe4ef6af4ee95c01ac987e86b0e7c54d26f8f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:22:34 +0200
Subject: [PATCH 079/244] Step 12.5: Add angularutils:pagination package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 32813c3..693b8cf 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -20,3 +20,4 @@ accounts-password
 dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
+angularutils:pagination
diff --git a/.meteor/versions b/.meteor/versions
index 8bcf116..719fc34 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,6 +10,7 @@ angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
 angularui:angular-ui-router@0.2.15
+angularutils:pagination@0.9.1_2
 autoupdate@1.2.4
 babel-compiler@5.8.24_1
 babel-runtime@0.1.4
-- 
2.3.2 (Apple Git-55)


From 86242a63fe2826fa3de67d18e8976c1d03bc04d6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:22:58 +0200
Subject: [PATCH 080/244] Step 12.6: Add dependency to
 angularUtils.directives.dirPagination

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 01f6271..a67eec8 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,7 +1,8 @@
 angular.module('socially', [
   'angular-meteor',
   'ui.router',
-  'accounts.ui'
+  'accounts.ui',
+  'angularUtils.directives.dirPagination'
 ]);
 
 function onReady() {
-- 
2.3.2 (Apple Git-55)


From d6386bbe194b581273af89e242ef29a6cfeca0e2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:23:49 +0200
Subject: [PATCH 081/244] Step 12.7: Add usage to the dir-pagination directive

---
 client/parties/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index bcff75b..9b996e1 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -8,7 +8,7 @@
   <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
 <ul>
-  <li ui-sref="partyDetails({ partyId: party._id })" ng-repeat="party in partiesList.parties">
+  <li ui-sref="partyDetails({ partyId: party._id })" dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
-- 
2.3.2 (Apple Git-55)


From 91cfb852723df009ba59c08a0e70100f42a91cdf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:24:26 +0200
Subject: [PATCH 082/244] Step 12.8: Add the pagination controls to the view

---
 client/parties/parties-list/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 9b996e1..2a6c244 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -14,3 +14,4 @@
     <button ng-click="partiesList.removeParty(party)">X</button>
   </li>
 </ul>
+<dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.3.2 (Apple Git-55)


From d2f8116cc0db1cb1d69e712d70a4a2193a963392 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:25:11 +0200
Subject: [PATCH 083/244] Step 12.9: Add the pageChanged method to the
 component

---
 client/parties/parties-list/parties-list.component.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index a40ac14..02b7fc4 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -37,7 +37,11 @@ angular.module('socially').directive('partiesList', function () {
 
       this.removeParty = (party) => {
         Parties.remove({_id: party._id});
-      }
+      };
+
+      this.pageChanged = (newPage) => {
+        this.page = newPage;
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8ced92a04e35c3cfff0e582ff91ae2d7dd40fd1e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:25:52 +0200
Subject: [PATCH 084/244] Step 12.10: Add tmeasday:publish-counts package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 693b8cf..6419b1b 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
 angularutils:pagination
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 719fc34..df2e395 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -86,6 +86,7 @@ srp@1.0.4
 standard-minifiers@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
+tmeasday:publish-counts@0.7.2
 tracker@1.0.9
 twitter@1.1.5
 ui@1.0.8
-- 
2.3.2 (Apple Git-55)


From 6817e40c08ef2b66cd604d78830af117dba2adaf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:27:19 +0200
Subject: [PATCH 085/244] Step 12.11: Add usage of Counts

---
 server/parties.js | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/server/parties.js b/server/parties.js
index a0d40a9..461d1b6 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,10 +1,10 @@
 Meteor.publish("parties", function (options) {
-  return Parties.find({
+  let selector = {
     $or: [
       {
         $and: [
-          {"public": true},
-          {"public": {$exists: true}}
+          {'public': true},
+          {'public': {$exists: true}}
         ]
       },
       {
@@ -14,5 +14,8 @@ Meteor.publish("parties", function (options) {
         ]
       }
     ]
-  }, options);
+  };
+
+  Counts.publish(this, 'numberOfParties', Parties.find(selector), {noReady: true});
+  return Parties.find(selector, options);
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0d9267ccd727bc48cdc5162d0659a0bad7c42c39 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 28 Nov 2015 22:29:25 +0200
Subject: [PATCH 086/244] Step 12.12: Add the Count usage in the component

---
 client/parties/parties-list/parties-list.component.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 02b7fc4..dcbe6f0 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -13,6 +13,9 @@ angular.module('socially').directive('partiesList', function () {
         parties: () => {
           return Parties.find({}, { sort : this.sort });
         },
+        partiesCount: () => {
+          return Counts.get('numberOfParties');
+        },
         page: 1,
         sort: {
           name: 1
-- 
2.3.2 (Apple Git-55)


From 9ac85419f2483fb65f47ce335ce599dc93e9fd4a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:13:40 +0200
Subject: [PATCH 087/244] Step 12.13: Changing the sort order reactively

---
 client/parties/parties-list/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 2a6c244..5107d89 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -7,6 +7,13 @@
   <input type="checkbox" ng-model="partiesList.newParty.public">
   <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
+<h1>Parties:</h1>
+<div>
+  <select ng-model="partiesList.orderProperty" ng-change="partiesList.updateSort()">
+    <option value="1">Ascending</option>
+    <option value="-1">Descending</option>
+  </select>
+</div>
 <ul>
   <li ui-sref="partyDetails({ partyId: party._id })" dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     {{party.name}}
-- 
2.3.2 (Apple Git-55)


From b4d4971144764c0010ca1d1c4cd4e0625c8741c4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:13:52 +0200
Subject: [PATCH 088/244] Step 12.14: Add order logic to the client

---
 client/parties/parties-list/parties-list.component.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index dcbe6f0..7a75d87 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -8,6 +8,7 @@ angular.module('socially').directive('partiesList', function () {
 
       this.newParty = {};
       this.perPage = 3;
+      this.orderProperty = '1';
 
       this.helpers({
         parties: () => {
@@ -45,6 +46,12 @@ angular.module('socially').directive('partiesList', function () {
       this.pageChanged = (newPage) => {
         this.page = newPage;
       };
+
+      this.updateSort = () => {
+        this.sort = {
+          name: parseInt(this.orderProperty)
+        }
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bf1d3dcf8ec15397203fa7108bb8a37a8e07c6f9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:14:39 +0200
Subject: [PATCH 089/244] Step 12.15: Add search string to the parties
 publication

---
 server/parties.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/server/parties.js b/server/parties.js
index 461d1b6..2efe8a9 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,4 +1,4 @@
-Meteor.publish("parties", function (options) {
+Meteor.publish("parties", function (options, searchString) {
   let selector = {
     $or: [
       {
-- 
2.3.2 (Apple Git-55)


From bd7613420c749bba7ce15d2aa8ac9d529b70f732 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:15:42 +0200
Subject: [PATCH 090/244] Step 12.16: Add the search logic

---
 server/parties.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index 2efe8a9..ac93a84 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -1,5 +1,10 @@
 Meteor.publish("parties", function (options, searchString) {
+  if (!searchString || searchString == null) {
+    searchString = '';
+  }
+
   let selector = {
+    name: { '$regex' : '.*' + searchString || '' + '.*', '$options' : 'i' },
     $or: [
       {
         $and: [
-- 
2.3.2 (Apple Git-55)


From e79b705f64f5a38e25d506137357b10a339ddc48 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:16:29 +0200
Subject: [PATCH 091/244] Step 12.17: Add the search input to the view

---
 client/parties/parties-list/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 5107d89..25e6cc8 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -9,6 +9,7 @@
 </form>
 <h1>Parties:</h1>
 <div>
+  <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
   <select ng-model="partiesList.orderProperty" ng-change="partiesList.updateSort()">
     <option value="1">Ascending</option>
     <option value="-1">Descending</option>
-- 
2.3.2 (Apple Git-55)


From 09cc8642d6fdbd791baa1a30bbd7ed7fb4a6cdcd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:17:24 +0200
Subject: [PATCH 092/244] Step 12.18: Add the helper and update the parties
 subscription

---
 client/parties/parties-list/parties-list.component.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 7a75d87..c7de45f 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -20,7 +20,8 @@ angular.module('socially').directive('partiesList', function () {
         page: 1,
         sort: {
           name: 1
-        }
+        },
+        searchText: ''
       });
 
       this.subscribe('parties', () => {
@@ -29,7 +30,8 @@ angular.module('socially').directive('partiesList', function () {
             limit: parseInt(this.perPage),
             skip: parseInt((this.page - 1) * this.perPage),
             sort: this.sort
-          }
+          },
+          this.searchText
         ]
       });
 
-- 
2.3.2 (Apple Git-55)


From 808c60702f8e0bff14d72bb16e659f0c1d24fd8a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:19:02 +0200
Subject: [PATCH 093/244] Step 13.1: Create the filter

---
 client/parties/filters/uninvited.js | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 client/parties/filters/uninvited.js

diff --git a/client/parties/filters/uninvited.js b/client/parties/filters/uninvited.js
new file mode 100644
index 0000000..45a5360
--- /dev/null
+++ b/client/parties/filters/uninvited.js
@@ -0,0 +1,11 @@
+angular.module('socially').filter('uninvited', function () {
+  return function (users, party) {
+    if (!party) {
+      return false;
+    }
+
+    return _.filter(users, function (user) {
+      return !(user._id == party.owner || _.contains(party.invited, user._id));
+    });
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f9d2949c01f1d10e04a9e6deac254d45d1d4628c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:21:04 +0200
Subject: [PATCH 094/244] Step 13.2: Use the filter in the users list on the
 party details view

---
 client/parties/party-details/party-details.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index 8b18a5f..f1ab955 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -8,8 +8,8 @@ The party your selected is:
 <button ui-sref="parties">Back</button>
 
 <ul>
-  Users:
-  <li ng-repeat="user in partyDetails.users">
+  Users to invite:
+  <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0921f8e632d7011f251069d30660f140305c5fb2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:23:28 +0200
Subject: [PATCH 095/244] Step 13.3: Create the displayName filter

---
 client/parties/filters/displayName.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 client/parties/filters/displayName.js

diff --git a/client/parties/filters/displayName.js b/client/parties/filters/displayName.js
new file mode 100644
index 0000000..279eec7
--- /dev/null
+++ b/client/parties/filters/displayName.js
@@ -0,0 +1,17 @@
+angular.module('socially').filter('displayName', function () {
+  return function (user) {
+    if (!user) {
+      return '';
+    }
+
+    if (user.profile && user.profile.name) {
+      return user.profile.name;
+    }
+    else if (user.emails) {
+      return user.emails[0].address;
+    }
+    else {
+      return user;
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c3cabd8b913cb4a0118d28da0b0d5d557437328e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:24:05 +0200
Subject: [PATCH 096/244] Step 13.4: Use the displayName filter

---
 client/parties/party-details/party-details.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index f1ab955..46cdb65 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -10,6 +10,6 @@ The party your selected is:
 <ul>
   Users to invite:
   <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayName }}</div>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 71d2231bafdf070b123767e5403bf529eee13191 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:31:00 +0200
Subject: [PATCH 097/244] Step 13.5: Add party owner details to the parties
 list

---
 client/parties/parties-list/parties-list.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 25e6cc8..4e4706b 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -20,6 +20,7 @@
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
+    <p><small>Posted by {{ partiesList.getPartyCreator(party) }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.3.2 (Apple Git-55)


From 1fcd758d08eb75a883ddecc9ef1c5ed63ecc3e5c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:31:25 +0200
Subject: [PATCH 098/244] Step 13.6: Implement the getPartyCreator method

---
 client/parties/parties-list/parties-list.component.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index c7de45f..2a89c99 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -54,6 +54,24 @@ angular.module('socially').directive('partiesList', function () {
           name: parseInt(this.orderProperty)
         }
       };
+
+      this.getPartyCreator = function(party){
+        if (!party) {
+          return '';
+        }
+
+        let owner = Meteor.users.findOne(party.owner);
+
+        if (!owner) {
+          return 'nobody';
+        }
+
+        if (Meteor.userId() !== null && owner._id === Meteor.userId()) {
+          return 'me';
+        }
+
+        return owner;
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2b87c25eb80576a0259b941041474af900a78072 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:31:42 +0200
Subject: [PATCH 099/244] Step 13.7: Add the users subscription

---
 client/parties/parties-list/parties-list.component.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 2a89c99..4e5d33e 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -24,6 +24,8 @@ angular.module('socially').directive('partiesList', function () {
         searchText: ''
       });
 
+      this.subscribe('users');
+
       this.subscribe('parties', () => {
         return [
           {
-- 
2.3.2 (Apple Git-55)


From 9ce625b4150e1f58ec50ab9697e1337e1cbb8423 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:32:37 +0200
Subject: [PATCH 100/244] Step 13.8: Add usage of displayName filter on the
 creator

---
 client/parties/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 4e4706b..2006722 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -20,7 +20,7 @@
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
-    <p><small>Posted by {{ partiesList.getPartyCreator(party) }}</small></p>
+    <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
 <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.3.2 (Apple Git-55)


From 15d5558df3d4c196a8f77d2d9ee7a3910c1de56c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:42:23 +0200
Subject: [PATCH 101/244] Step 14.1: Implement the invite method in the server

---
 model/parties.js | 47 +++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 47 insertions(+)

diff --git a/model/parties.js b/model/parties.js
index b793c1f..4ea9f9e 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -10,4 +10,51 @@ Parties.allow({
   remove: function (userId, party) {
     return userId && party.owner === userId;
   }
+});
+
+let getContactEmail = function (user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+
+  return null;
+};
+
+Meteor.methods({
+  invite: function (partyId, userId) {
+    check(partyId, String);
+    check(userId, String);
+
+    let party = Parties.findOne(partyId);
+
+    if (!party)
+      throw new Meteor.Error(404, "No such party!");
+
+    if (party.owner !== this.userId)
+      throw new Meteor.Error(404, "No permissions!");
+
+    if (party.public)
+      throw new Meteor.Error(400, "That party is public. No need to invite people.");
+
+    if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+      Parties.update(partyId, { $addToSet: { invited: userId } });
+
+      let from = getContactEmail(Meteor.users.findOne(this.userId));
+      let to = getContactEmail(Meteor.users.findOne(userId));
+
+      if (Meteor.isServer && to) {
+        Email.send({
+          from: "noreply@socially.com",
+          to: to,
+          replyTo: from || undefined,
+          subject: "PARTY: " + party.title,
+          text:
+          "Hey, I just invited you to '" + party.title + "' on Socially." +
+          "\n\nCome check it out: " + Meteor.absoluteUrl() + "\n"
+        });
+      }
+    }
+  }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6f5e25fd65e29f7a07eef5c0db0d1630f476377f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:43:03 +0200
Subject: [PATCH 102/244] Step 14.2: Add the check package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 6419b1b..d04b826 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ accounts-facebook
 accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
+check
-- 
2.3.2 (Apple Git-55)


From 2222c02b3e03715017fc2beed97f1fa03ac0a9b4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:44:04 +0200
Subject: [PATCH 103/244] Step 14.3: Add the email package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index d04b826..0a0fecf 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,4 @@ accounts-twitter
 angularutils:pagination
 tmeasday:publish-counts
 check
+email
-- 
2.3.2 (Apple Git-55)


From 8c760dcf2fb8cb4e02b583a401bd57ee0c6249f1 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:49:29 +0200
Subject: [PATCH 104/244] Step 14.4: Implement the invite method on the client
 side

---
 client/parties/party-details/party-details.component.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 3ecea19..7924457 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -34,6 +34,17 @@ angular.module('socially').directive('partyDetails', function () {
           }
         });
       };
+
+      this.invite = (user) => {
+        Meteor.call('invite', this.party._id, user._id, (error) => {
+          if (error) {
+            console.log('Oops, unable to invite!');
+          }
+          else {
+            console.log('Invited!');
+          }
+        });
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d47c00efc1643132b2bc001efc16edc7f82e7d50 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:51:05 +0200
Subject: [PATCH 105/244] Step 14.5: Add the invite button to the view

---
 client/parties/party-details/party-details.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index 46cdb65..3a5a42a 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -11,5 +11,6 @@ The party your selected is:
   Users to invite:
   <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
     <div>{{ user | displayName }}</div>
+    <button ng-click="partyDetails.invite(user)">Invite</button>
   </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 0b729541194bd128e1205b8296040f44851cf4a4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:56:53 +0200
Subject: [PATCH 106/244] Step 14.6: Update the parties subscription to include
 invited

---
 server/parties.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/server/parties.js b/server/parties.js
index ac93a84..f3559d0 100644
--- a/server/parties.js
+++ b/server/parties.js
@@ -17,6 +17,12 @@ Meteor.publish("parties", function (options, searchString) {
           {owner: this.userId},
           {owner: {$exists: true}}
         ]
+      },
+      {
+        $and: [
+          {invited: this.userId},
+          {invited: {$exists: true}}
+        ]
       }
     ]
   };
-- 
2.3.2 (Apple Git-55)


From e57c4e40cf7d06308251e49547218b22227d8be0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 20:59:41 +0200
Subject: [PATCH 107/244] Step 14.7: Implement the rsvp method in the server
 side

---
 model/parties.js | 49 +++++++++++++++++++++++++++++++++++++++++++++----
 1 file changed, 45 insertions(+), 4 deletions(-)

diff --git a/model/parties.js b/model/parties.js
index 4ea9f9e..0ae7376 100644
--- a/model/parties.js
+++ b/model/parties.js
@@ -38,8 +38,8 @@ Meteor.methods({
     if (party.public)
       throw new Meteor.Error(400, "That party is public. No need to invite people.");
 
-    if (userId !== party.owner && ! _.contains(party.invited, userId)) {
-      Parties.update(partyId, { $addToSet: { invited: userId } });
+    if (userId !== party.owner && !_.contains(party.invited, userId)) {
+      Parties.update(partyId, {$addToSet: {invited: userId}});
 
       let from = getContactEmail(Meteor.users.findOne(this.userId));
       let to = getContactEmail(Meteor.users.findOne(userId));
@@ -50,11 +50,52 @@ Meteor.methods({
           to: to,
           replyTo: from || undefined,
           subject: "PARTY: " + party.title,
-          text:
-          "Hey, I just invited you to '" + party.title + "' on Socially." +
+          text: "Hey, I just invited you to '" + party.title + "' on Socially." +
           "\n\nCome check it out: " + Meteor.absoluteUrl() + "\n"
         });
       }
     }
+  },
+  rsvp: function (partyId, rsvp) {
+    check(partyId, String);
+    check(rsvp, String);
+
+    if (!this.userId)
+      throw new Meteor.Error(403, "You must be logged in to RSVP");
+
+    if (!_.contains(['yes', 'no', 'maybe'], rsvp))
+      throw new Meteor.Error(400, "Invalid RSVP");
+
+    let party = Parties.findOne(partyId);
+
+    if (!party)
+      throw new Meteor.Error(404, "No such party");
+
+    if (!party.public && party.owner !== this.userId && !_.contains(party.invited, this.userId))
+      throw new Meteor.Error(403, "No such party"); // its private, but let's not tell this to the user
+
+    let rsvpIndex = _.indexOf(_.pluck(party.rsvps, 'user'), this.userId);
+
+    if (rsvpIndex !== -1) {
+      // update existing rsvp entry
+      if (Meteor.isServer) {
+        // update the appropriate rsvp entry with $
+        Parties.update(
+          {_id: partyId, "rsvps.user": this.userId},
+          {$set: {"rsvps.$.rsvp": rsvp}});
+      } else {
+        // minimongo doesn't yet support $ in modifier. as a temporary
+        // workaround, make a modifier that uses an index. this is
+        // safe on the client since there's only one thread.
+        let modifier = {$set: {}};
+        modifier.$set["rsvps." + rsvpIndex + ".rsvp"] = rsvp;
+
+        Parties.update(partyId, modifier);
+      }
+    } else {
+      // add new rsvp entry
+      Parties.update(partyId,
+        {$push: {rsvps: {user: this.userId, rsvp: rsvp}}});
+    }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6a4bf2df2097aa86cb6ec19ebbcaaf14f0fc2eec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:02:52 +0200
Subject: [PATCH 108/244] Step 14.8: Add the rsvp method to the client side

---
 client/parties/parties-list/parties-list.component.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 4e5d33e..2644653 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -74,6 +74,17 @@ angular.module('socially').directive('partiesList', function () {
 
         return owner;
       };
+
+      this.rsvp = (partyId, rsvp) => {
+        Meteor.call('rsvp', partyId, rsvp, (error) => {
+          if (error) {
+            console.log('Oops, unable to rsvp!');
+          }
+          else {
+            console.log('RSVP Done!');
+          }
+        });
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b4c55aed372ad86ac71f510889dc9cad66334db0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:03:03 +0200
Subject: [PATCH 109/244] Step 14.9: Add the RSVP button to the view

---
 client/parties/parties-list/parties-list.html | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 2006722..94728a5 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -20,6 +20,11 @@
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
+    <div>
+      <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')">
+      <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
+      <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')">
+    </div>
     <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 267e99841e2125f4fd753297dd5fdec6e312623b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:05:05 +0200
Subject: [PATCH 110/244] Step 14.10: Add the RSVP status to the view

---
 client/parties/parties-list/parties-list.html | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 94728a5..586eb0f 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -25,6 +25,21 @@
       <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')">
     </div>
+    <div>
+      Who is coming:
+      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
+      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
+      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
+        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
+        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
+        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      </div>
+    </div>
     <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From f9d1ca38493e900b295d0118f98337368d090c60 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:06:12 +0200
Subject: [PATCH 111/244] Step 14.11: Implement getUserById method

---
 client/parties/parties-list/parties-list.component.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 2644653..5788ba6 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -85,6 +85,10 @@ angular.module('socially').directive('partiesList', function () {
           }
         });
       };
+
+      this.getUserById = (userId) => {
+        return Meteor.users.findOne(userId);
+      }
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8f42a16e91ccde135b975b4265a441869d565326 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:07:06 +0200
Subject: [PATCH 112/244] Step 14.12: Add RSVP list to the view of users who
 not responded

---
 client/parties/parties-list/parties-list.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 586eb0f..da484e0 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -40,6 +40,12 @@
         {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
       </div>
     </div>
+    <ul>
+      Users who not responded:
+      <li ng-repeat="invitedUser in partiesList.outstandingInvitations(party)">
+        {{ invitedUser | displayName }}
+      </li>
+    </ul>
     <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 68ad784e33f3f71e00cefe35a785b399cb11c0c2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:08:24 +0200
Subject: [PATCH 113/244] Step 14.13: Added logic to the controller

---
 client/parties/parties-list/parties-list.component.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 5788ba6..d93ea0d 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -88,7 +88,13 @@ angular.module('socially').directive('partiesList', function () {
 
       this.getUserById = (userId) => {
         return Meteor.users.findOne(userId);
-      }
+      };
+
+      this.outstandingInvitations = (party) => {
+        return _.filter(this.users, (user) => {
+          return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
+        });
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7347c049acae1b5a5047b013f7e92a44286af2c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:09:13 +0200
Subject: [PATCH 114/244] Step 14.14: Add the users collection

---
 client/parties/parties-list/parties-list.component.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index d93ea0d..e3779a6 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -14,6 +14,9 @@ angular.module('socially').directive('partiesList', function () {
         parties: () => {
           return Parties.find({}, { sort : this.sort });
         },
+        users: () => {
+          return Meteor.users.find({});
+        },
         partiesCount: () => {
           return Counts.get('numberOfParties');
         },
-- 
2.3.2 (Apple Git-55)


From 01b305e117fc6d2743c9e35111ba499dcb5ea82c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:10:53 +0200
Subject: [PATCH 115/244] Step 15.1: Add usage of ng-show

---
 client/parties/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index da484e0..4da2488 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -1,4 +1,4 @@
-<form>
+<form ng-show="partiesList.isLoggedIn">
   <label>Party Name: </label>
   <input type="text" ng-model="partiesList.newParty.name" />
   <label>Description: </label>
-- 
2.3.2 (Apple Git-55)


From afef37bf78e3cc0d061172e0e08c5dec08721084 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:11:11 +0200
Subject: [PATCH 116/244] Step 15.2: Create a UI helper for isLoggedIn

---
 client/parties/parties-list/parties-list.component.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index e3779a6..4d17df0 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -24,7 +24,10 @@ angular.module('socially').directive('partiesList', function () {
         sort: {
           name: 1
         },
-        searchText: ''
+        searchText: '',
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        }
       });
 
       this.subscribe('users');
-- 
2.3.2 (Apple Git-55)


From 5e5a9e7e5544cddc85528ebee49f5499369fd02b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:12:12 +0200
Subject: [PATCH 117/244] Step 15.3: Add usage for ng-hide

---
 client/parties/parties-list/parties-list.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 4da2488..3996e8d 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -7,6 +7,9 @@
   <input type="checkbox" ng-model="partiesList.newParty.public">
   <button ng-click="partiesList.addParty()">Add Party!</button>
 </form>
+<div ng-hide="partiesList.isLoggedIn">
+  Log in to create a party!
+</div>
 <h1>Parties:</h1>
 <div>
   <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
-- 
2.3.2 (Apple Git-55)


From 51624aef0492a692a4a50d51cefd344c7aa762a6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:54:26 +0200
Subject: [PATCH 118/244] Step 15.4: Add ng-show to the RSVP buttons

---
 client/parties/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 3996e8d..bd73472 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -23,7 +23,7 @@
     {{party.name}}
     <p>{{party.description}}</p>
     <button ng-click="partiesList.removeParty(party)">X</button>
-    <div>
+    <div ng-show="partiesList.isLoggedIn">
       <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')">
       <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')">
-- 
2.3.2 (Apple Git-55)


From a5df3eb1a5eaa734ee5ea72703c857116986f7ed Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 21:55:01 +0200
Subject: [PATCH 119/244] Step 15.5: Add message for not-logged in users on the
 RSVP buttons

---
 client/parties/parties-list/parties-list.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index bd73472..51e4e1e 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -28,6 +28,9 @@
       <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
       <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')">
     </div>
+    <div ng-hide="partiesList.isLoggedIn">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
     <div>
       Who is coming:
       Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-- 
2.3.2 (Apple Git-55)


From b1ee41dce9910c2df19560d659cb8835d6cdaa72 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 22:58:16 +0200
Subject: [PATCH 120/244] Step 15.6: Add ng-show for delete button

---
 client/parties/parties-list/parties-list.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 51e4e1e..2c99dd3 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -22,7 +22,7 @@
   <li ui-sref="partyDetails({ partyId: party._id })" dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     {{party.name}}
     <p>{{party.description}}</p>
-    <button ng-click="partiesList.removeParty(party)">X</button>
+    <button ng-click="partiesList.removeParty(party)" ng-show="partiesList.isLoggedIn && party.owner == partiesList.currentUserId">X</button>
     <div ng-show="partiesList.isLoggedIn">
       <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')">
       <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
-- 
2.3.2 (Apple Git-55)


From d83a9b81229329e1224d36c32ff988e7eee00697 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 22:58:38 +0200
Subject: [PATCH 121/244] Step 15.7: Add currentUserId helper

---
 client/parties/parties-list/parties-list.component.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 4d17df0..7b359d7 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -27,6 +27,9 @@ angular.module('socially').directive('partiesList', function () {
         searchText: '',
         isLoggedIn: () => {
           return Meteor.userId() !== null;
+        },
+        currentUserId: () => {
+          return Meteor.userId();
         }
       });
 
-- 
2.3.2 (Apple Git-55)


From 220358909469e4139a173f9485738deb77d2b1b5 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 22:59:14 +0200
Subject: [PATCH 122/244] Step 15.8: Add ng-if usage

---
 client/parties/parties-list/parties-list.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 2c99dd3..ab4aa44 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -46,12 +46,15 @@
         {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
       </div>
     </div>
-    <ul>
+    <ul ng-if="!party.public">
       Users who not responded:
       <li ng-repeat="invitedUser in partiesList.outstandingInvitations(party)">
         {{ invitedUser | displayName }}
       </li>
     </ul>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
     <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
-- 
2.3.2 (Apple Git-55)


From 3cf1e32532dee8b68e29b4f0aaa4ae9f193157cb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 23:06:11 +0200
Subject: [PATCH 123/244] Step 15.9: Add canInvite method to the component

---
 client/parties/party-details/party-details.component.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 7924457..2c6425a 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -45,6 +45,13 @@ angular.module('socially').directive('partyDetails', function () {
           }
         });
       };
+
+      this.canInvite = () => {
+        if (!this.party)
+          return false;
+
+        return !this.party.public && this.party.owner === Meteor.userId();
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 53203002fa54693c21143e62942e0369010e44ac Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 23:09:22 +0200
Subject: [PATCH 124/244] Step 15.10: Added view usage with the canInvite
 method

---
 client/parties/party-details/party-details.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index 3a5a42a..dbd8132 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -7,10 +7,13 @@ The party your selected is:
 </form>
 <button ui-sref="parties">Back</button>
 
-<ul>
+<ul ng-show="partyDetails.canInvite()">
   Users to invite:
   <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
     <div>{{ user | displayName }}</div>
     <button ng-click="partyDetails.invite(user)">Invite</button>
   </li>
+  <li ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 691253834ec277710412dfac503837e306e23f88 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 23:14:30 +0200
Subject: [PATCH 125/244] Step 15.11: Added isLoggedIn helper to the party
 details component

---
 client/parties/party-details/party-details.component.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 2c6425a..71b9c8a 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -15,7 +15,10 @@ angular.module('socially').directive('partyDetails', function () {
         },
         users: () => {
           return Meteor.users.find({});
-        }
+        },
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
       });
 
       this.save = () => {
-- 
2.3.2 (Apple Git-55)


From 0415ab1b5ccc2ca509bd7ca397db1c9fe2b48e58 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 23:15:11 +0200
Subject: [PATCH 126/244] Step 15.12: Added usage for ng-disabled

---
 client/parties/party-details/party-details.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index dbd8132..ee5b2be 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -1,8 +1,8 @@
 The party your selected is:
 <form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" />
-  Description: <input type="text" ng-model="partyDetails.party.description" />
-  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
+  Party name: <input type="text" ng-model="partyDetails.party.name" ng-disabled="partyDetails.isLoggedIn" />
+  Description: <input type="text" ng-model="partyDetails.party.description" ng-disabled="partyDetails.isLoggedIn" />
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="partyDetails.isLoggedIn" />
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 <button ui-sref="parties">Back</button>
-- 
2.3.2 (Apple Git-55)


From 15b045acf5e5ea9249cf0af468f04019ba18dd03 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sun, 29 Nov 2015 23:15:51 +0200
Subject: [PATCH 127/244] Step 16.1: Add angularui:angular-google-maps package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 0a0fecf..c81fedf 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,4 @@ angularutils:pagination
 tmeasday:publish-counts
 check
 email
+angularui:angular-google-maps
diff --git a/.meteor/versions b/.meteor/versions
index df2e395..c6f3c05 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -9,6 +9,7 @@ angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
+angularui:angular-google-maps@2.2.1
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.9.1_2
 autoupdate@1.2.4
@@ -61,6 +62,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
 oauth@1.1.6
@@ -84,6 +86,7 @@ spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
 standard-minifiers@1.0.2
+stevezhu:lodash@1.0.2
 templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
-- 
2.3.2 (Apple Git-55)


From ea1599a40bac237d64727a882b6c661576c3c8e7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:18:45 +0200
Subject: [PATCH 128/244] Step 16.2: Add google maps module dependency

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index a67eec8..bd1083b 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -2,7 +2,8 @@ angular.module('socially', [
   'angular-meteor',
   'ui.router',
   'accounts.ui',
-  'angularUtils.directives.dirPagination'
+  'angularUtils.directives.dirPagination',
+  'uiGmapgoogle-maps'
 ]);
 
 function onReady() {
-- 
2.3.2 (Apple Git-55)


From a2be974a4528071989f9bcfedaced41ac5d93f5e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:19:42 +0200
Subject: [PATCH 129/244] Step 16.3: Add basic map to the view

---
 client/parties/party-details/party-details.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index ee5b2be..2850bae 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -16,4 +16,12 @@ The party your selected is:
   <li ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
     Everyone are already invited.
   </li>
-</ul>
\ No newline at end of file
+</ul>
+
+<div class="party-details-maps">
+  <div class="angular-google-map-container">
+    <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
+                        events="partyDetails.map.events" zoom="partyDetails.map.zoom">
+    </ui-gmap-google-map>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 990cb5416312636e9e8be6e0f22ab75055b03b02 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:21:16 +0200
Subject: [PATCH 130/244] Step 16.4: Add map params to the component

---
 client/parties/party-details/party-details.component.js | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 71b9c8a..2883272 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -18,9 +18,18 @@ angular.module('socially').directive('partyDetails', function () {
         },
         isLoggedIn: () => {
           return Meteor.userId() !== null;
-        },
+        }
       });
 
+      this.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        zoom: 8,
+        events: {}
+      };
+
       this.save = () => {
         Parties.update({_id: $stateParams.partyId}, {
           $set: {
-- 
2.3.2 (Apple Git-55)


From 37eb25e12af61df7b05d63827a144d38c89b099f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:21:57 +0200
Subject: [PATCH 131/244] Step 16.5: Create basic CSS style with google map
 style

---
 client/parties/styles/google-maps.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 client/parties/styles/google-maps.css

diff --git a/client/parties/styles/google-maps.css b/client/parties/styles/google-maps.css
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/client/parties/styles/google-maps.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 37011f0d44eeb98c2e4358f053e40ca871626aee Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:24:09 +0200
Subject: [PATCH 132/244] Step 16.6: Add party marker to the map

---
 client/parties/party-details/party-details.html | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index 2850bae..b9e4281 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -18,10 +18,11 @@ The party your selected is:
   </li>
 </ul>
 
-<div class="party-details-maps">
-  <div class="angular-google-map-container">
-    <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
-                        events="partyDetails.map.events" zoom="partyDetails.map.zoom">
-    </ui-gmap-google-map>
-  </div>
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
+                      events="partyDetails.map.events" zoom="partyDetails.map.zoom">
+    <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
+                    events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
+    </ui-gmap-marker>
+  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e5a2b7365b3a73e8d6a2d227dcb8235c8dc248b2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:24:48 +0200
Subject: [PATCH 133/244] Step 16.7: Add the marker creation logic to the
 controller

---
 .../party-details/party-details.component.js       | 27 +++++++++++++++++++++-
 1 file changed, 26 insertions(+), 1 deletion(-)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index 2883272..f1e1d87 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -27,7 +27,32 @@ angular.module('socially').directive('partyDetails', function () {
           longitude: -73
         },
         zoom: 8,
-        events: {}
+        events: {
+          click: function (mapModel, eventName, originalEventArgs) {
+            if (!$scope.party)
+              return;
+
+            if (!$scope.party.location)
+              $scope.party.location = {};
+
+            $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
+            $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
+            //scope apply required because this event handler is outside of the angular domain
+            $scope.$apply();
+          }
+        },
+        marker: {
+          options: { draggable: true },
+          events: {
+            dragend: function (marker, eventName, args) {
+              if (!$scope.party.location)
+                $scope.party.location = {};
+
+              $scope.party.location.latitude = marker.getPosition().lat();
+              $scope.party.location.longitude = marker.getPosition().lng();
+            }
+          }
+        }
       };
 
       this.save = () => {
-- 
2.3.2 (Apple Git-55)


From bb4b1fd1ce1741954a601db7471782dc60f22053 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:27:03 +0200
Subject: [PATCH 134/244] Step 16.8: Add map to the parties list

---
 client/parties/parties-list/parties-list.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index ab4aa44..12d54e5 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -58,4 +58,11 @@
     <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
   </li>
 </ul>
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partiesList.party.location || partiesList.map.center" zoom="partiesList.map.zoom">
+    <ui-gmap-markers models="partiesList.parties" coords="'location'"
+                     fit="true" idkey="'_id'" doRebuildAll="true">
+    </ui-gmap-markers>
+  </ui-gmap-google-map>
+</div>
 <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.3.2 (Apple Git-55)


From c9a108264d34134259f53b0b0b8f3ee5bee14c70 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:27:24 +0200
Subject: [PATCH 135/244] Step 16.9: Add map logic to the parties list
 controller

---
 client/parties/parties-list/parties-list.component.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 7b359d7..e376e3a 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -33,6 +33,14 @@ angular.module('socially').directive('partiesList', function () {
         }
       });
 
+      this.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        zoom: 8
+      };
+
       this.subscribe('users');
 
       this.subscribe('parties', () => {
-- 
2.3.2 (Apple Git-55)


From 2d5c0f71eb0ceb954c7d656c26937f8c5fe268fd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:28:10 +0200
Subject: [PATCH 136/244] Step 17.1: Add main CSS file

---
 client/styles/main.css | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/styles/main.css

diff --git a/client/styles/main.css b/client/styles/main.css
new file mode 100644
index 0000000..4397047
--- /dev/null
+++ b/client/styles/main.css
@@ -0,0 +1,3 @@
+body {
+    background-color: rgba(0,0,0,.04);
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c8afd5b6c0a3e2b6a4134f2e55edeca8dcff08af Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:28:57 +0200
Subject: [PATCH 137/244] Step 17.2: Add twbs:bootstrap to the project

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c81fedf..658a573 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,4 @@ tmeasday:publish-counts
 check
 email
 angularui:angular-google-maps
+twbs:bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index c6f3c05..96b875d 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -91,6 +91,7 @@ templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.9
+twbs:bootstrap@3.3.6
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 67926697dc5e29b9c453a5b1b0e92d5b6e65980b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:29:54 +0200
Subject: [PATCH 138/244] Step 17.3: Modify the main HTML file to use bootstrap

---
 index.html | 19 +++++++++++++------
 1 file changed, 13 insertions(+), 6 deletions(-)

diff --git a/index.html b/index.html
index ccecce2..4f52d8c 100644
--- a/index.html
+++ b/index.html
@@ -3,11 +3,18 @@
 </head>
 <body>
 
-<login-buttons></login-buttons>
-<h1>
-  <a href="/parties">Home</a>
-</h1>
-
-<div ui-view=""></div>
+<div>
+  <header class="navbar navbar-fixed-top">
+    <div class="container-fluid">
+      <div class="navbar-header">
+        <h1>
+          <a href="/parties">Home</a>
+        </h1>
+      </div>
+      <login-buttons></login-buttons>
+    </div>
+  </header>
+  <div ui-view class="container-fluid"></div>
+</div>
 
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9501dfd8b1e4b507334b0330ca9cae634cb372d3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:30:48 +0200
Subject: [PATCH 139/244] Step 17.4: Add less package to the project

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 658a573..8d6eb3a 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ check
 email
 angularui:angular-google-maps
 twbs:bootstrap
+less
-- 
2.3.2 (Apple Git-55)


From 55db9c41cc6f697cb831a514452ff85a3aea2afa Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:31:22 +0200
Subject: [PATCH 140/244] Step 17.5: Use LESS

---
 client/styles/main.css  | 3 ---
 client/styles/main.less | 8 ++++++++
 2 files changed, 8 insertions(+), 3 deletions(-)
 delete mode 100644 client/styles/main.css
 create mode 100644 client/styles/main.less

diff --git a/client/styles/main.css b/client/styles/main.css
deleted file mode 100644
index 4397047..0000000
--- a/client/styles/main.css
+++ /dev/null
@@ -1,3 +0,0 @@
-body {
-    background-color: rgba(0,0,0,.04);
-}
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
new file mode 100644
index 0000000..6acada4
--- /dev/null
+++ b/client/styles/main.less
@@ -0,0 +1,8 @@
+body {
+    background-color: rgba(0,0,0,.2);
+    padding-top: 70px;
+
+    .navbar {
+        background-color: #ffffff;
+    }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 308c012ea018991ef21c4430df034772ef998724 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:32:37 +0200
Subject: [PATCH 141/244] Step 17.6: Add angularui:angular-ui-bootstrap package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 8d6eb3a..8142da0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ email
 angularui:angular-google-maps
 twbs:bootstrap
 less
+angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 96b875d..2c97683 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -10,6 +10,7 @@ angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
 angularui:angular-google-maps@2.2.1
+angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
 angularutils:pagination@0.9.1_2
 autoupdate@1.2.4
-- 
2.3.2 (Apple Git-55)


From 9cb370aa5e1483433cab7b7dab81d36ed426bacb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:33:35 +0200
Subject: [PATCH 142/244] Step 17.7: Update the index.html style and tags

---
 index.html | 25 ++++++++++++++-----------
 1 file changed, 14 insertions(+), 11 deletions(-)

diff --git a/index.html b/index.html
index 4f52d8c..3b1f316 100644
--- a/index.html
+++ b/index.html
@@ -1,20 +1,23 @@
 <head>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
+  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
+  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
 </head>
 <body>
 
-<div>
-  <header class="navbar navbar-fixed-top">
-    <div class="container-fluid">
-      <div class="navbar-header">
-        <h1>
-          <a href="/parties">Home</a>
-        </h1>
-      </div>
+<nav class="navbar navbar-default navbar-fixed-top">
+  <div class="container">
+    <div class="navbar-header">
+      <a class="navbar-brand" href="/">socially</a>
+    </div>
+    <div class="navbar-right-container">
       <login-buttons></login-buttons>
     </div>
-  </header>
-  <div ui-view class="container-fluid"></div>
-</div>
+  </div>
+</nav>
 
+<div class="h100">
+  <div ui-view class="ma-main-container container-fluid h100"></div>
+</div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8402b75ec40a80f8e59613d3349cf5fe99eae65a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:34:33 +0200
Subject: [PATCH 143/244] Step 17.8: Add dependency for ui-bootstrap

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index bd1083b..8fd955a 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -3,7 +3,8 @@ angular.module('socially', [
   'ui.router',
   'accounts.ui',
   'angularUtils.directives.dirPagination',
-  'uiGmapgoogle-maps'
+  'uiGmapgoogle-maps',
+  'ui.bootstrap'
 ]);
 
 function onReady() {
-- 
2.3.2 (Apple Git-55)


From ab2392ccab3b1450e31540952b22c79b018c0b12 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:56:21 +0200
Subject: [PATCH 144/244] Step 17.9: Create the component for the modal

---
 .../add-new-party-modal.component.js               | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 client/parties/add-new-party-modal/add-new-party-modal.component.js

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
new file mode 100644
index 0000000..b224c7e
--- /dev/null
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -0,0 +1,25 @@
+angular.module('socially').directive('addNewPartyModal', function () {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/parties/add-new-party-modal/add-new-party-modal.html',
+    controllerAs: 'addNewPartyModal',
+    controller: function ($scope, $stateParams, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        }
+      });
+
+      this.newParty = {};
+
+      this.addNewParty = () => {
+        this.newParty.owner = Meteor.userId();
+        Parties.insert(this.newParty);
+        this.newParty = {};
+        $scope.$close();
+      };
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d2382396a91c87209243e62755bfa5d3b71f9139 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:56:37 +0200
Subject: [PATCH 145/244] Step 17.10: Create the view for the modal

---
 .../add-new-party-modal/add-new-party-modal.html   | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 client/parties/add-new-party-modal/add-new-party-modal.html

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
new file mode 100644
index 0000000..69a1af3
--- /dev/null
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -0,0 +1,24 @@
+<div class="container-fluid ma-add-new-party-container">
+  <div class="alert alert-info" ng-hide="addNewPartyModal.isLoggedIn">
+    Please log in to create a party!
+  </div>
+
+  <form ng-show="addNewPartyModal.isLoggedIn">
+    <h2>Create a new party</h2>
+
+    <div class="form-group">
+      <label for="nameInput">Name</label>
+      <input ng-model="addNewPartyModal.newParty.name" id="nameInput" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="description">Description</label>
+      <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" class="form-control">
+    </div>
+    <div class="form-group">
+      <label for="public">
+        <input type="checkbox" ng-model="addNewPartyModal.newParty.public" id="public"> Public
+      </label>
+    </div>
+    <button ng-click="addNewPartyModal.addNewParty()" class="btn">Add</button>
+  </form>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5ca5729f27644fbac1c0013e86219420dce04405 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:57:01 +0200
Subject: [PATCH 146/244] Step 17.11: Update the HTML and layout of the parties
 list

---
 client/parties/parties-list/parties-list.html | 165 ++++++++++++++++----------
 1 file changed, 103 insertions(+), 62 deletions(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 12d54e5..3179826 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -1,68 +1,109 @@
-<form ng-show="partiesList.isLoggedIn">
-  <label>Party Name: </label>
-  <input type="text" ng-model="partiesList.newParty.name" />
-  <label>Description: </label>
-  <input type="text" ng-model="partiesList.newParty.description" />
-  <label>Public Party?</label>
-  <input type="checkbox" ng-model="partiesList.newParty.public">
-  <button ng-click="partiesList.addParty()">Add Party!</button>
-</form>
-<div ng-hide="partiesList.isLoggedIn">
-  Log in to create a party!
-</div>
-<h1>Parties:</h1>
-<div>
-  <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
-  <select ng-model="partiesList.orderProperty" ng-change="partiesList.updateSort()">
-    <option value="1">Ascending</option>
-    <option value="-1">Descending</option>
-  </select>
-</div>
-<ul>
-  <li ui-sref="partyDetails({ partyId: party._id })" dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
-    {{party.name}}
-    <p>{{party.description}}</p>
-    <button ng-click="partiesList.removeParty(party)" ng-show="partiesList.isLoggedIn && party.owner == partiesList.currentUserId">X</button>
-    <div ng-show="partiesList.isLoggedIn">
-      <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')">
-      <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')">
-      <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')">
-    </div>
-    <div ng-hide="partiesList.isLoggedIn">
-      <i>Sign in to RSVP for this party.</i>
-    </div>
-    <div>
-      Who is coming:
-      Yes - {{ (party.rsvps | filter:{rsvp:'yes'}).length }}
-      Maybe - {{ (party.rsvps | filter:{rsvp:'maybe'}).length }}
-      No - {{ (party.rsvps | filter:{rsvp:'no'}).length }}
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'yes'}">
-        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
-      </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'maybe'}">
-        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+<div class="row h100">
+  <div class="col-md-6 ma-parties-col">
+    <div class="row">
+      <div class="col-xs-8">
+        <form class="form-inline search-form">
+          <div class="form-group">
+            <label class="sr-only" for="search">Search</label>
+
+            <div class="input-group">
+              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
+              <input type="text" ng-model="partiesList.searchText" placeholder="Search" id="search"
+                     class="form-control">
+            </div>
+          </div>
+          <div class="form-group">
+            <label class="sr-only" for="sort-order">Sort Order</label>
+            <select ng-model="partiesList.orderProperty" ng-change="partiesList.updateSort()">
+              <option value="1">Ascending</option>
+              <option value="-1">Descending</option>
+            </select>
+          </div>
+        </form>
       </div>
-      <div ng-repeat="rsvp in party.rsvps | filter:{rsvp:'no'}">
-        {{ partiesList.getUserById(rsvp.user) | displayName }} - {{ rsvp.rsvp }}
+      <div class="col-xs-4 ma-add-button-container">
+        <button ng-show="partiesList.isLoggedIn" class="btn" ng-click="partiesList.openAddNewPartyModal()"><i
+                class="fa fa-plus"></i></button>
       </div>
     </div>
-    <ul ng-if="!party.public">
-      Users who not responded:
-      <li ng-repeat="invitedUser in partiesList.outstandingInvitations(party)">
-        {{ invitedUser | displayName }}
+    <ul class="list-group">
+      <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage"
+          total-items="partiesList.partiesCount" class="list-group-item ma-party-item">
+        <i class="ma-remove fa fa-times" ng-click="partiesList.removeParty(party)"
+           ng-show="partiesList.isLoggedIn && party.owner == partiesList.currentUserId"></i>
+
+        <div class="row">
+          <div class="col-sm-8">
+            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+
+            <p class="ma-party-description">{{party.description}}</p>
+          </div>
+        </div>
+        <div class="row ma-party-item-bottom">
+          <div class="col-sm-8 ma-posted-by-col">
+            <span class="ma-posted-by">Posted by {{ partiesList.getPartyCreator(party) | displayName }}  </span>
+            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
+            <span ng-if="!party.public" class="ma-everyone-invited">
+                 <i class="fa fa-user-secret"></i>  This is a private event
+            </span>
+
+            <div ng-show="partiesList.isLoggedIn" class="ma-rsvp-buttons">
+              <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')" class="btn"
+                     ng-class="{'btn-primary' : partiesList.isRSVP('yes', party)}">
+              <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')" class="btn"
+                     ng-class="{'btn-primary' : partiesList.isRSVP('maybe', party)}">
+              <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')" class="btn"
+                     ng-class="{'btn-primary' : partiesList.isRSVP('no', party)}">
+            </div>
+            <div ng-hide="partiesList.isLoggedIn">
+              <i>Sign in to RSVP for this party.</i>
+            </div>
+          </div>
+          <div class="col-sm-4">
+            <div class="ma-rsvp-sum">
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  YES
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  MAYBE
+                </div>
+              </div>
+              <div class="ma-rsvp-amount">
+                <div class="ma-amount">
+                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
+                </div>
+                <div class="ma-rsvp-title">
+                  NO
+                </div>
+              </div>
+            </div>
+            <ul ng-if="!party.public">
+              <li ng-repeat="invitedUser in partiesList.outstandingInvitations(party)">
+                {{ invitedUser | displayName }}
+              </li>
+            </ul>
+          </div>
+        </div>
       </li>
     </ul>
-    <div ng-if="party.public">
-      Everyone is invited
+    <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+  </div>
+  <div class="col-md-6 h100 ma-angular-map-col">
+    <div class="angular-google-map-container h100">
+      <ui-gmap-google-map center="partiesList.map.center" zoom="partiesList.map.zoom" options="partiesList.map.options">
+        <ui-gmap-markers models="partiesList.parties" coords="'location'"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
     </div>
-    <p><small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small></p>
-  </li>
-</ul>
-<div class="angular-google-map-container">
-  <ui-gmap-google-map center="partiesList.party.location || partiesList.map.center" zoom="partiesList.map.zoom">
-    <ui-gmap-markers models="partiesList.parties" coords="'location'"
-                     fit="true" idkey="'_id'" doRebuildAll="true">
-    </ui-gmap-markers>
-  </ui-gmap-google-map>
-</div>
-<dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+  </div>
+</div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3f1d53bba120b5e6d7a1e685921c5055116824c9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 00:59:59 +0200
Subject: [PATCH 147/244] Step 17.12: Update the component, add the modal
 opening code and update the map theme

---
 .../parties/parties-list/parties-list.component.js | 66 +++++++++++++++++++---
 1 file changed, 58 insertions(+), 8 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index e376e3a..90bd850 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -3,10 +3,9 @@ angular.module('socially').directive('partiesList', function () {
     restrict: 'E',
     templateUrl: 'client/parties/parties-list/parties-list.html',
     controllerAs: 'partiesList',
-    controller: function ($scope, $reactive) {
+    controller: function ($scope, $reactive, $modal) {
       $reactive(this).attach($scope);
 
-      this.newParty = {};
       this.perPage = 3;
       this.orderProperty = '1';
 
@@ -38,6 +37,42 @@ angular.module('socially').directive('partiesList', function () {
           latitude: 45,
           longitude: -73
         },
+        options: {
+          maxZoom: 10,
+          styles: [{
+            "featureType": "administrative",
+            "elementType": "labels.text.fill",
+            "stylers": [{"color": "#444444"}]
+          }, {
+            "featureType": "landscape",
+            "elementType": "all",
+            "stylers": [{"color": "#f2f2f2"}]
+          }, {
+            "featureType": "poi",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "road",
+            "elementType": "all",
+            "stylers": [{"saturation": -100}, {"lightness": 45}]
+          }, {
+            "featureType": "road.highway",
+            "elementType": "all",
+            "stylers": [{"visibility": "simplified"}]
+          }, {
+            "featureType": "road.arterial",
+            "elementType": "labels.icon",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "transit",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "water",
+            "elementType": "all",
+            "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+          }]
+        },
         zoom: 8
       };
 
@@ -54,12 +89,6 @@ angular.module('socially').directive('partiesList', function () {
         ]
       });
 
-      this.addParty = () => {
-        this.newParty.owner = Meteor.user()._id;
-        Parties.insert(this.newParty);
-        this.newParty = {};
-      };
-
       this.removeParty = (party) => {
         Parties.remove({_id: party._id});
       };
@@ -112,6 +141,27 @@ angular.module('socially').directive('partiesList', function () {
           return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
         });
       };
+
+      this.openAddNewPartyModal = function () {
+        $modal.open({
+          animation: true,
+          template: '<add-new-party-modal></add-new-party-modal>'
+        });
+      };
+
+      this.isRSVP = (rsvp, party) => {
+        if (Meteor.userId() == null) {
+          return false;
+        }
+
+        let rsvpIndex = party.myRsvpIndex;
+        rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), Meteor.userId());
+
+        if (rsvpIndex !== -1) {
+          party.myRsvpIndex = rsvpIndex;
+          return party.rsvps[rsvpIndex].rsvp === rsvp;
+        }
+      }
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d6a9a3dd39abf81c140e4ae06ac88f8d48ba434d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 01:00:50 +0200
Subject: [PATCH 148/244] Step 17.13: Update the style colors in the main LESS
 file

---
 client/styles/main.less | 33 ++++++++++++++++++++++++++++-----
 1 file changed, 28 insertions(+), 5 deletions(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index 6acada4..e54157f 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,8 +1,31 @@
+@color1 : #2F2933;
+@color2 : #01A2A6;
+@color3 : #29D9C2;
+@color4 : #BDF271;
+@color5 : #FFFFA6;
+@color6 : #2F2933;
+@color7 : #FF6F69;
+
+html, body {
+  height: 100%;
+}
+
 body {
-    background-color: rgba(0,0,0,.2);
-    padding-top: 70px;
+  background-color: #f8f8f8;
+  padding-top: 50px;
+  font-family: 'Muli', sans-serif;
+}
+
+.h100 {
+  height: 100%;
+}
+
+.w100 {
+  width: 100%;
+}
 
-    .navbar {
-        background-color: #ffffff;
-    }
+.ma-main-container {
+  @media (min-width: 400px) {
+    padding-right: 0;
+  }
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From c7c6a491b98da5f51cd943c88bb936228adf9434 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:12:06 +0200
Subject: [PATCH 149/244] Step 17.14: Update the view of party details

---
 client/parties/party-details/party-details.html | 77 +++++++++++++++++--------
 1 file changed, 52 insertions(+), 25 deletions(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index b9e4281..c82f24f 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -1,28 +1,55 @@
-The party your selected is:
-<form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" ng-disabled="partyDetails.isLoggedIn" />
-  Description: <input type="text" ng-model="partyDetails.party.description" ng-disabled="partyDetails.isLoggedIn" />
-  Public Party? <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="partyDetails.isLoggedIn" />
-  <button ng-click="partyDetails.save()">Save</button>
-</form>
-<button ui-sref="parties">Back</button>
+<div class="row ma-party-details-container">
+  <div class="col-sm-6 col-sm-offset-3">
+    <legend>
+      View and Edit Your Party Details:
+    </legend>
+    <form class="form-horizontal">
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="partyDetails.party.name" ng-disabled="party.owner != currentUserId" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Party Name</label>
+        <input ng-model="partyDetails.party.description" ng-disabled="party.owner != currentUserId" type="text"
+               class="form-control">
+      </div>
+      <div class="form-group">
+        <label>Is public</label>
+        <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="party.owner != currentUserId">
+      </div>
+      <div class="form-group" ng-show="party.owner == currentUserId">
+        <button ng-click="partyDetails.save()" class="btn btn-primary">Save</button>
+      </div>
+    </form>
 
-<ul ng-show="partyDetails.canInvite()">
-  Users to invite:
-  <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
-    <div>{{ user | displayName }}</div>
-    <button ng-click="partyDetails.invite(user)">Invite</button>
-  </li>
-  <li ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
-    Everyone are already invited.
-  </li>
-</ul>
+    <div class="ma-invite-list" ng-show="partyDetails.canInvite()">
+      <h3>
+        Users to invite:
+      </h3>
+      <ul>
+        <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
+          <div>{{ user | displayName }}</div>
+          <button ng-click="partyDetails.invite(user)" class="btn btn-primary">Invite</button>
+        </li>
+        <li ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
+          Everyone are already invited.
+        </li>
+      </ul>
+    </div>
+
+    <h3 class="ma-map-title">
+      Click the map to set the party location
+    </h3>
+
+    <div class="angular-google-map-container">
+      <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
+                          events="partyDetails.map.events" zoom="partyDetails.map.zoom">
+        <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
+                        events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
+        </ui-gmap-marker>
+      </ui-gmap-google-map>
+    </div>
+  </div>
 
-<div class="angular-google-map-container">
-  <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
-                      events="partyDetails.map.events" zoom="partyDetails.map.zoom">
-    <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
-                    events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
-    </ui-gmap-marker>
-  </ui-gmap-google-map>
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 151b58e0026f942fe67ca847476181137ed4fa94 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:12:25 +0200
Subject: [PATCH 150/244] Step 17.15: Add currentUserId to the party details
 component

---
 client/parties/party-details/party-details.component.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
index f1e1d87..1bf8eca 100644
--- a/client/parties/party-details/party-details.component.js
+++ b/client/parties/party-details/party-details.component.js
@@ -18,6 +18,9 @@ angular.module('socially').directive('partyDetails', function () {
         },
         isLoggedIn: () => {
           return Meteor.userId() !== null;
+        },
+        currentUserId: () => {
+          return Meteor.userId();
         }
       });
 
-- 
2.3.2 (Apple Git-55)


From c3265b4c1ffdec539f45638161cf9b536e1b8d5b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 18:49:39 +0200
Subject: [PATCH 151/244] Step 17.16: Add style for each component

---
 .../add-new-party-modal.import.less                |  19 ++++
 .../parties/parties-list/parties-list.import.less  | 121 +++++++++++++++++++++
 .../party-details/party-details.import.less        |  26 +++++
 client/styles/navbar.import.less                   |  35 ++++++
 4 files changed, 201 insertions(+)
 create mode 100644 client/parties/add-new-party-modal/add-new-party-modal.import.less
 create mode 100644 client/parties/parties-list/parties-list.import.less
 create mode 100644 client/parties/party-details/party-details.import.less
 create mode 100644 client/styles/navbar.import.less

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
new file mode 100644
index 0000000..6c678fe
--- /dev/null
+++ b/client/parties/add-new-party-modal/add-new-party-modal.import.less
@@ -0,0 +1,19 @@
+.ma-add-new-party-container {
+  padding: 20px;
+  > form {
+    > h2 {
+      font-siz: 15px;
+      margin-bottom: 20px;
+    }
+    button {
+      background: @color3;
+      color: @color5;
+    }
+  }
+
+  .alert.alert-info {
+    background: @color3;
+    color: @color5;
+    margin-bottom: 0;
+  }
+}
\ No newline at end of file
diff --git a/client/parties/parties-list/parties-list.import.less b/client/parties/parties-list/parties-list.import.less
new file mode 100644
index 0000000..9abfd9f
--- /dev/null
+++ b/client/parties/parties-list/parties-list.import.less
@@ -0,0 +1,121 @@
+.ma-add-button-container {
+  button.btn {
+    background: @color3;
+    float: right;
+    margin-right: 5px;
+    outline: none;
+    i {
+      color: @color5;
+    }
+  }
+}
+
+.ma-parties-col {
+  padding-top: 20px;
+}
+
+.ma-party-item {
+  .ma-party-name {
+    margin-bottom: 20px;
+    a {
+      color: @color6;
+      text-decoration: none !important;
+      font-weight: 400;
+    }
+  }
+  .ma-party-description {
+    color: @color6;
+    font-weight: 300;
+    padding-left: 18px;
+    font-size: 14px;
+  }
+
+  .ma-remove {
+    color: lighten(@color7, 20%);
+    position: absolute;
+    right: 20px;
+    top: 20px;
+    &:hover {
+      color: @color7;
+    }
+  }
+
+  .ma-party-item-bottom {
+    padding-top: 10px;
+    .ma-posted-by-col {
+      .ma-posted-by {
+        color: darken(@color4, 30%);
+        font-size: 12px;
+      }
+      .ma-everyone-invited {
+        @media (max-width: 400px) {
+          display: block;
+          i {
+            margin-left: 0px !important;
+          }
+        }
+        font-size: 12px;
+        color: darken(@color4, 10%);
+        i {
+          color: darken(@color4, 10%);
+          margin-left: 5px;
+        }
+      }
+    }
+
+    .ma-rsvp-buttons {
+      input.btn {
+        color: darken(@color3, 20%);
+        background: transparent !important;
+        outline: none;
+        padding-left: 0;
+        &:active {
+          box-shadow: none;
+        }
+        &:hover {
+          color: darken(@color3, 30%);
+        }
+        &.btn-primary {
+          color: lighten(@color3, 10%);
+          border: 0;
+          background: transparent !important;
+        }
+      }
+    }
+
+    .ma-rsvp-sum {
+      width: 160px;
+      @media (min-width: 400px) {
+        float: right;
+      }
+      @media (max-width: 400px) {
+        margin: 0 auto;
+      }
+    }
+    .ma-rsvp-amount {
+      display: inline-block;
+      text-align: center;
+      width: 50px;
+      .ma-amount {
+        font-weight: bold;
+        font-size: 20px;
+      }
+      .ma-rsvp-title {
+        font-size: 11px;
+        color: #aaa;
+        text-transform: uppercase;
+      }
+    }
+  }
+}
+
+.ma-angular-map-col {
+  .angular-google-map-container, .angular-google-map {
+    height: 100%;
+    width: 100%;
+  }
+}
+
+.search-form {
+  margin-bottom: 1em;
+}
\ No newline at end of file
diff --git a/client/parties/party-details/party-details.import.less b/client/parties/party-details/party-details.import.less
new file mode 100644
index 0000000..4f19b98
--- /dev/null
+++ b/client/parties/party-details/party-details.import.less
@@ -0,0 +1,26 @@
+.ma-party-details-container {
+  padding: 20px;
+  .angular-google-map-container {
+    width: 100%;
+    height: 100%;
+  }
+  .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+  .ma-map-title {
+    font-size: 16px;
+    font-weight: bolder;
+  }
+  .ma-invite-list {
+    margin-top: 20px;
+    margin-bottom: 20px;
+    h3 {
+      font-size: 16px;
+      font-weight: bolder;
+    }
+    ul {
+      padding: 0;
+    }
+  }
+}
\ No newline at end of file
diff --git a/client/styles/navbar.import.less b/client/styles/navbar.import.less
new file mode 100644
index 0000000..96a6b49
--- /dev/null
+++ b/client/styles/navbar.import.less
@@ -0,0 +1,35 @@
+// Override Bootstrap navbar
+.navbar {
+  background-color: #ffffff;
+  border-bottom: #eee 1px solid;
+  color: @color3;
+  font-family: 'Muli', sans-serif;
+  a {
+    color: @color3;
+    text-decoration: none !important;
+  }
+
+  .navbar-right-container {
+    position: absolute;
+    top: 17px;
+    right: 17px;
+  }
+}
+
+// Overrise Meteor Login Buttons
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+#login-buttons .login-button,
+.accounts-dialog .login-button {
+  background: @color3;
+  color: white;
+  border: none;
+
+  &:hover {
+    background: @color3;
+    color: white;
+  }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a81ebd63df5c31079b997e7e2ab4210543dcd445 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 18:51:22 +0200
Subject: [PATCH 152/244] Step 17.17: Use the new LESS files in the main.less

---
 client/styles/main.less | 24 +++++++++++++++---------
 1 file changed, 15 insertions(+), 9 deletions(-)

diff --git a/client/styles/main.less b/client/styles/main.less
index e54157f..7eac7a1 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -6,8 +6,8 @@
 @color6 : #2F2933;
 @color7 : #FF6F69;
 
-html, body {
-  height: 100%;
+html,body{
+  height:100%;
 }
 
 body {
@@ -16,16 +16,22 @@ body {
   font-family: 'Muli', sans-serif;
 }
 
-.h100 {
-  height: 100%;
+.h100{
+  height : 100%;
 }
 
-.w100 {
-  width: 100%;
+.w100{
+  width:100%;
 }
 
-.ma-main-container {
+
+.ma-main-container{
   @media (min-width: 400px) {
-    padding-right: 0;
+    padding-right : 0;
   }
-}
\ No newline at end of file
+}
+
+@import "navbar.import.less";
+@import "../parties/add-new-party-modal/add-new-party-modal.import.less";
+@import "../parties/parties-list/parties-list.import.less";
+@import "../parties/party-details/party-details.import.less";
-- 
2.3.2 (Apple Git-55)


From 96121521ed108421ef83b84b9e997804f18eea98 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:29:06 +0200
Subject: [PATCH 153/244] Step 18.1: Remove twbs:bootstrap package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 8142da0..898c8f0 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,6 +25,5 @@ tmeasday:publish-counts
 check
 email
 angularui:angular-google-maps
-twbs:bootstrap
 less
 angularui:angular-ui-bootstrap
diff --git a/.meteor/versions b/.meteor/versions
index 2c97683..56a9fe4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -92,7 +92,6 @@ templating@1.1.5
 templating-tools@1.0.0
 tmeasday:publish-counts@0.7.2
 tracker@1.0.9
-twbs:bootstrap@3.3.6
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
-- 
2.3.2 (Apple Git-55)


From 855fee0ae05d171dd32090b1b12058f0ab3fdc78 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:30:05 +0200
Subject: [PATCH 154/244] Step 18.2: Add angular:angular-material package

---
 .meteor/packages | 1 +
 .meteor/versions | 3 +++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 898c8f0..5b8e404 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -27,3 +27,4 @@ email
 angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
+angular:angular-material
diff --git a/.meteor/versions b/.meteor/versions
index 56a9fe4..ced3741 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -9,6 +9,9 @@ angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
 angular:angular@1.4.8
+angular:angular-animate@1.4.8
+angular:angular-aria@1.4.8
+angular:angular-material@0.11.4
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
-- 
2.3.2 (Apple Git-55)


From 95d8508d1ce26a0ef7d5eb9eb4b6f47456cc59bd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:30:32 +0200
Subject: [PATCH 155/244] Step 18.3: Add ngMaterial dependency

---
 client/lib/app.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 8fd955a..d064ce2 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -4,7 +4,7 @@ angular.module('socially', [
   'accounts.ui',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ui.bootstrap'
+  'ngMaterial'
 ]);
 
 function onReady() {
-- 
2.3.2 (Apple Git-55)


From 351abbe0a4817cba15d9df2d6584f1b78e0af6f2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:31:55 +0200
Subject: [PATCH 156/244] Step 18.4: Replace $modal with $mdDialog

---
 client/parties/parties-list/parties-list.component.js | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 90bd850..64406b8 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -3,7 +3,7 @@ angular.module('socially').directive('partiesList', function () {
     restrict: 'E',
     templateUrl: 'client/parties/parties-list/parties-list.html',
     controllerAs: 'partiesList',
-    controller: function ($scope, $reactive, $modal) {
+    controller: function ($scope, $reactive, $mdDialog) {
       $reactive(this).attach($scope);
 
       this.perPage = 3;
@@ -11,7 +11,7 @@ angular.module('socially').directive('partiesList', function () {
 
       this.helpers({
         parties: () => {
-          return Parties.find({}, { sort : this.sort });
+          return Parties.find({}, {sort: this.sort});
         },
         users: () => {
           return Meteor.users.find({});
@@ -103,7 +103,7 @@ angular.module('socially').directive('partiesList', function () {
         }
       };
 
-      this.getPartyCreator = function(party){
+      this.getPartyCreator = function (party) {
         if (!party) {
           return '';
         }
@@ -143,9 +143,9 @@ angular.module('socially').directive('partiesList', function () {
       };
 
       this.openAddNewPartyModal = function () {
-        $modal.open({
-          animation: true,
-          template: '<add-new-party-modal></add-new-party-modal>'
+        $mdDialog.show({
+          template: '<add-new-party-modal></add-new-party-modal>',
+          clickOutsideToClose: true
         });
       };
 
-- 
2.3.2 (Apple Git-55)


From 328fc8514b669ae69fb36f5dd8b8b5ddf9f3f189 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:33:01 +0200
Subject: [PATCH 157/244] Step 18.5: Replace the close button with $mdDialog's
 hide

---
 .../parties/add-new-party-modal/add-new-party-modal.component.js  | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
index b224c7e..0b605fa 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -3,7 +3,7 @@ angular.module('socially').directive('addNewPartyModal', function () {
     restrict: 'E',
     templateUrl: 'client/parties/add-new-party-modal/add-new-party-modal.html',
     controllerAs: 'addNewPartyModal',
-    controller: function ($scope, $stateParams, $reactive) {
+    controller: function ($scope, $stateParams, $reactive, $mdDialog) {
       $reactive(this).attach($scope);
 
       this.helpers({
@@ -18,8 +18,12 @@ angular.module('socially').directive('addNewPartyModal', function () {
         this.newParty.owner = Meteor.userId();
         Parties.insert(this.newParty);
         this.newParty = {};
-        $scope.$close();
+        $mdDialog.hide();
       };
+
+      this.close = () => {
+        $mdDialog.hide();
+      }
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 39a5d3c1cd3b0e39af56bf3f439f4d192aba1f9c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Mon, 30 Nov 2015 21:34:26 +0200
Subject: [PATCH 158/244] Step 18.6: Update index.html to use angular-material
 components

---
 index.html | 28 +++++++++++-----------------
 1 file changed, 11 insertions(+), 17 deletions(-)

diff --git a/index.html b/index.html
index 3b1f316..5d08d6f 100644
--- a/index.html
+++ b/index.html
@@ -1,23 +1,17 @@
 <head>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <base href="/">
-  <link href='http://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>
-  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
+  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
-<body>
-
-<nav class="navbar navbar-default navbar-fixed-top">
-  <div class="container">
-    <div class="navbar-header">
-      <a class="navbar-brand" href="/">socially</a>
-    </div>
-    <div class="navbar-right-container">
-      <login-buttons></login-buttons>
-    </div>
+<body layout="column">
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <login-buttons></login-buttons>
   </div>
-</nav>
-
-<div class="h100">
-  <div ui-view class="ma-main-container container-fluid h100"></div>
-</div>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 63bdb4ab3fbd0d0fdb22b24826dde12e278cde63 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:06:21 +0200
Subject: [PATCH 159/244] Step 18.7: Update the less files to use
 angular-material

---
 .../add-new-party-modal.import.less                |  19 ---
 .../parties/parties-list/parties-list.import.less  | 154 +++++++--------------
 .../party-details/party-details.import.less        |  28 +---
 client/styles/main.less                            |  33 +----
 client/styles/navbar.import.less                   |  36 +----
 5 files changed, 59 insertions(+), 211 deletions(-)
 delete mode 100644 client/parties/add-new-party-modal/add-new-party-modal.import.less

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
deleted file mode 100644
index 6c678fe..0000000
--- a/client/parties/add-new-party-modal/add-new-party-modal.import.less
+++ /dev/null
@@ -1,19 +0,0 @@
-.ma-add-new-party-container {
-  padding: 20px;
-  > form {
-    > h2 {
-      font-siz: 15px;
-      margin-bottom: 20px;
-    }
-    button {
-      background: @color3;
-      color: @color5;
-    }
-  }
-
-  .alert.alert-info {
-    background: @color3;
-    color: @color5;
-    margin-bottom: 0;
-  }
-}
\ No newline at end of file
diff --git a/client/parties/parties-list/parties-list.import.less b/client/parties/parties-list/parties-list.import.less
index 9abfd9f..ea78dfb 100644
--- a/client/parties/parties-list/parties-list.import.less
+++ b/client/parties/parties-list/parties-list.import.less
@@ -1,121 +1,65 @@
-.ma-add-button-container {
-  button.btn {
-    background: @color3;
-    float: right;
-    margin-right: 5px;
-    outline: none;
-    i {
-      color: @color5;
-    }
-  }
+parties-list {
+  width: 100%;
 }
 
-.ma-parties-col {
-  padding-top: 20px;
+.navbar-text {
+  margin-right: 0;
 }
 
-.ma-party-item {
-  .ma-party-name {
-    margin-bottom: 20px;
-    a {
-      color: @color6;
-      text-decoration: none !important;
-      font-weight: 400;
-    }
-  }
-  .ma-party-description {
-    color: @color6;
-    font-weight: 300;
-    padding-left: 18px;
-    font-size: 14px;
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+.search-form {
+  margin-bottom: 1em;
+}
+
+.ma-parties-list {
+  .angular-google-map {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
+    -webkit-flex-direction: row;
+    -ms-flex-direction: row;
+    flex-direction: row;
+    box-sizing: border-box;
+    display: -webkit-flex;
+    display: -moz-flex;
+    display: -ms-flexbox;
+    display: flex;
   }
 
-  .ma-remove {
-    color: lighten(@color7, 20%);
-    position: absolute;
-    right: 20px;
-    top: 20px;
-    &:hover {
-      color: @color7;
-    }
+  .angular-google-map-container {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
   }
 
-  .ma-party-item-bottom {
-    padding-top: 10px;
-    .ma-posted-by-col {
-      .ma-posted-by {
-        color: darken(@color4, 30%);
-        font-size: 12px;
-      }
-      .ma-everyone-invited {
-        @media (max-width: 400px) {
-          display: block;
-          i {
-            margin-left: 0px !important;
-          }
-        }
-        font-size: 12px;
-        color: darken(@color4, 10%);
-        i {
-          color: darken(@color4, 10%);
-          margin-left: 5px;
-        }
-      }
+  .rsvps-sum {
+    float: left;
+    width: 50px;
+    text-align: center;
+    .rsvps-amount {
+      font-size: 24px;
     }
-
-    .ma-rsvp-buttons {
-      input.btn {
-        color: darken(@color3, 20%);
-        background: transparent !important;
-        outline: none;
-        padding-left: 0;
-        &:active {
-          box-shadow: none;
-        }
-        &:hover {
-          color: darken(@color3, 30%);
-        }
-        &.btn-primary {
-          color: lighten(@color3, 10%);
-          border: 0;
-          background: transparent !important;
-        }
-      }
+    .rsvps-title {
+      font-size: 13px;
+      color: #aaa;
     }
+  }
 
-    .ma-rsvp-sum {
-      width: 160px;
-      @media (min-width: 400px) {
-        float: right;
-      }
-      @media (max-width: 400px) {
-        margin: 0 auto;
+  .ma-party {
+    .ma-name {
+      a {
+        text-decoration: none;
+        color: #333;
       }
     }
-    .ma-rsvp-amount {
-      display: inline-block;
-      text-align: center;
-      width: 50px;
-      .ma-amount {
-        font-weight: bold;
-        font-size: 20px;
-      }
-      .ma-rsvp-title {
-        font-size: 11px;
-        color: #aaa;
-        text-transform: uppercase;
-      }
-    }
-  }
-}
+    .ma-description {
 
-.ma-angular-map-col {
-  .angular-google-map-container, .angular-google-map {
-    height: 100%;
-    width: 100%;
+    }
   }
-}
-
-.search-form {
-  margin-bottom: 1em;
 }
\ No newline at end of file
diff --git a/client/parties/party-details/party-details.import.less b/client/parties/party-details/party-details.import.less
index 4f19b98..dbaf8e2 100644
--- a/client/parties/party-details/party-details.import.less
+++ b/client/parties/party-details/party-details.import.less
@@ -1,26 +1,10 @@
-.ma-party-details-container {
-  padding: 20px;
-  .angular-google-map-container {
-    width: 100%;
-    height: 100%;
-  }
-  .angular-google-map {
+party-details {
+  width: 100%;
+}
+
+.ma-party-details {
+  .angular-google-map-container, .angular-google-map {
     width: 100%;
     height: 400px;
   }
-  .ma-map-title {
-    font-size: 16px;
-    font-weight: bolder;
-  }
-  .ma-invite-list {
-    margin-top: 20px;
-    margin-bottom: 20px;
-    h3 {
-      font-size: 16px;
-      font-weight: bolder;
-    }
-    ul {
-      padding: 0;
-    }
-  }
 }
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
index 7eac7a1..96f4c16 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,37 +1,6 @@
-@color1 : #2F2933;
-@color2 : #01A2A6;
-@color3 : #29D9C2;
-@color4 : #BDF271;
-@color5 : #FFFFA6;
-@color6 : #2F2933;
-@color7 : #FF6F69;
-
-html,body{
-  height:100%;
-}
-
-body {
-  background-color: #f8f8f8;
-  padding-top: 50px;
-  font-family: 'Muli', sans-serif;
-}
-
-.h100{
-  height : 100%;
-}
-
-.w100{
-  width:100%;
-}
-
-
-.ma-main-container{
-  @media (min-width: 400px) {
-    padding-right : 0;
-  }
+html, body {
 }
 
 @import "navbar.import.less";
-@import "../parties/add-new-party-modal/add-new-party-modal.import.less";
 @import "../parties/parties-list/parties-list.import.less";
 @import "../parties/party-details/party-details.import.less";
diff --git a/client/styles/navbar.import.less b/client/styles/navbar.import.less
index 96a6b49..3a4f13f 100644
--- a/client/styles/navbar.import.less
+++ b/client/styles/navbar.import.less
@@ -1,35 +1,5 @@
-// Override Bootstrap navbar
-.navbar {
-  background-color: #ffffff;
-  border-bottom: #eee 1px solid;
-  color: @color3;
-  font-family: 'Muli', sans-serif;
-  a {
-    color: @color3;
-    text-decoration: none !important;
-  }
-
-  .navbar-right-container {
-    position: absolute;
-    top: 17px;
-    right: 17px;
-  }
-}
-
-// Overrise Meteor Login Buttons
-#login-dropdown-list.accounts-dialog {
-  right: 14px;
-  left: auto;
-}
-
-#login-buttons .login-button,
-.accounts-dialog .login-button {
-  background: @color3;
-  color: white;
-  border: none;
-
-  &:hover {
-    background: @color3;
-    color: white;
+md-toolbar {
+  h2 {
+    margin: 0;
   }
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bcc1abce4a51156ee33ab8c47b34c8b635d3298e Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:07:04 +0200
Subject: [PATCH 160/244] Step 18.8: Update the layout of parties list

---
 client/parties/parties-list/parties-list.html | 158 ++++++++++----------------
 1 file changed, 61 insertions(+), 97 deletions(-)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 3179826..4f7a14f 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -1,109 +1,73 @@
-<div class="row h100">
-  <div class="col-md-6 ma-parties-col">
-    <div class="row">
-      <div class="col-xs-8">
-        <form class="form-inline search-form">
-          <div class="form-group">
-            <label class="sr-only" for="search">Search</label>
-
-            <div class="input-group">
-              <div class="input-group-addon"><i class="glyphicon glyphicon-search"></i></div>
-              <input type="text" ng-model="partiesList.searchText" placeholder="Search" id="search"
-                     class="form-control">
-            </div>
-          </div>
-          <div class="form-group">
-            <label class="sr-only" for="sort-order">Sort Order</label>
-            <select ng-model="partiesList.orderProperty" ng-change="partiesList.updateSort()">
-              <option value="1">Ascending</option>
-              <option value="-1">Descending</option>
-            </select>
-          </div>
-        </form>
-      </div>
-      <div class="col-xs-4 ma-add-button-container">
-        <button ng-show="partiesList.isLoggedIn" class="btn" ng-click="partiesList.openAddNewPartyModal()"><i
-                class="fa fa-plus"></i></button>
-      </div>
-    </div>
-    <ul class="list-group">
-      <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage"
-          total-items="partiesList.partiesCount" class="list-group-item ma-party-item">
-        <i class="ma-remove fa fa-times" ng-click="partiesList.removeParty(party)"
-           ng-show="partiesList.isLoggedIn && party.owner == partiesList.currentUserId"></i>
-
-        <div class="row">
-          <div class="col-sm-8">
-            <h2 class="ma-party-name"><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-
-            <p class="ma-party-description">{{party.description}}</p>
-          </div>
+<md-content flex layout="row" class="ma-parties-list">
+  <div layout="row" flex>
+    <div flex="50">
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="partiesList.searchText" placeholder="Search">
+          </md-input-container>
+          <md-select ng-model="partiesList.orderProperty" placeholder="Sort Order" md-on-close="partiesList.updateSort()">
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button ng-show="partiesList.isLoggedIn" class="md-fab" ng-click="partiesList.openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
         </div>
-        <div class="row ma-party-item-bottom">
-          <div class="col-sm-8 ma-posted-by-col">
-            <span class="ma-posted-by">Posted by {{ partiesList.getPartyCreator(party) | displayName }}  </span>
-            <span ng-if="party.public" class="ma-everyone-invited"><i class="fa fa-male"></i> Everyone is invited</span>
-            <span ng-if="!party.public" class="ma-everyone-invited">
-                 <i class="fa fa-user-secret"></i>  This is a private event
-            </span>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount" class="ma-party">
+          <md-card>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
 
-            <div ng-show="partiesList.isLoggedIn" class="ma-rsvp-buttons">
-              <input type="button" value="I'm going!" ng-click="partiesList.rsvp(party._id, 'yes')" class="btn"
-                     ng-class="{'btn-primary' : partiesList.isRSVP('yes', party)}">
-              <input type="button" value="Maybe" ng-click="partiesList.rsvp(party._id, 'maybe')" class="btn"
-                     ng-class="{'btn-primary' : partiesList.isRSVP('maybe', party)}">
-              <input type="button" value="No" ng-click="partiesList.rsvp(party._id, 'no')" class="btn"
-                     ng-class="{'btn-primary' : partiesList.isRSVP('no', party)}">
-            </div>
-            <div ng-hide="partiesList.isLoggedIn">
-              <i>Sign in to RSVP for this party.</i>
-            </div>
-          </div>
-          <div class="col-sm-4">
-            <div class="ma-rsvp-sum">
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  YES
+                  <div ng-show="partiesList.isLoggedIn" class="md-actions" layout="row">
+                    <md-button ng-click="partiesList.rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="partiesList.rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="partiesList.rsvp(party._id, 'no')">No</md-button>
+                  </div>
                 </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  MAYBE
-                </div>
-              </div>
-              <div class="ma-rsvp-amount">
-                <div class="ma-amount">
-                  {{ (party.rsvps | filter:{rsvp:'no'}).length || "0"}}
-                </div>
-                <div class="ma-rsvp-title">
-                  NO
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="partiesList.isLoggedIn" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
                 </div>
               </div>
-            </div>
-            <ul ng-if="!party.public">
-              <li ng-repeat="invitedUser in partiesList.outstandingInvitations(party)">
-                {{ invitedUser | displayName }}
-              </li>
-            </ul>
-          </div>
+            </md-card-content>
+          </md-card>
         </div>
-      </li>
-    </ul>
-    <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-  </div>
-  <div class="col-md-6 h100 ma-angular-map-col">
-    <div class="angular-google-map-container h100">
-      <ui-gmap-google-map center="partiesList.map.center" zoom="partiesList.map.zoom" options="partiesList.map.options">
+      </md-content>
+
+    </div>
+    <div flex="50" layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="partiesList.map.options" center="partiesList.map.center" zoom="partiesList.map.zoom" flex layout="row">
         <ui-gmap-markers models="partiesList.parties" coords="'location'"
                          fit="true" idkey="'_id'" doRebuildAll="true">
         </ui-gmap-markers>
       </ui-gmap-google-map>
     </div>
   </div>
-</div>
\ No newline at end of file
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e85da07ee489b905f057c48f80a64029d7d94a03 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:09:29 +0200
Subject: [PATCH 161/244] Step 18.9: Add planettraining:material-design-icons
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 5b8e404..a44a0f1 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -28,3 +28,4 @@ angularui:angular-google-maps
 less
 angularui:angular-ui-bootstrap
 angular:angular-material
+planettraining:material-design-icons
diff --git a/.meteor/versions b/.meteor/versions
index ced3741..fef35c8 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -75,6 +75,7 @@ oauth2@1.1.5
 observe-sequence@1.0.7
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.6
+planettraining:material-design-icons@2.0.0
 promise@0.5.1
 random@1.0.5
 rate-limit@1.0.0
-- 
2.3.2 (Apple Git-55)


From 85141ea65dc9a736f14e937a1ea6c4e589244691 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:10:43 +0200
Subject: [PATCH 162/244] Step 18.10: Add angular material icons definitions

---
 client/lib/app.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/client/lib/app.js b/client/lib/app.js
index d064ce2..6a711c3 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -7,6 +7,17 @@ angular.module('socially', [
   'ngMaterial'
 ]);
 
+angular.module('socially').config(($mdIconProvider) => {
+  $mdIconProvider
+    .iconSet("social", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-social.svg")
+    .iconSet("action", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-action.svg")
+    .iconSet("communication", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-communication.svg")
+    .iconSet("content", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-content.svg")
+    .iconSet("toggle", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-toggle.svg")
+    .iconSet("navigation", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-navigation.svg")
+    .iconSet("image", "/packages/planettraining_material-design-icons/bower_components/material-design-icons/sprites/svg-sprite/svg-sprite-image.svg");
+});
+
 function onReady() {
   angular.bootstrap(document, ['socially'], {
     strictDi: true
-- 
2.3.2 (Apple Git-55)


From 9692d70915c1936c979a05528a9d31adae9f0ca9 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:18:02 +0200
Subject: [PATCH 163/244] Step 18.11: Update the view of party details to use
 angular-material

---
 client/parties/party-details/party-details.html | 82 +++++++++++--------------
 1 file changed, 36 insertions(+), 46 deletions(-)

diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
index c82f24f..4024a14 100644
--- a/client/parties/party-details/party-details.html
+++ b/client/parties/party-details/party-details.html
@@ -1,55 +1,45 @@
-<div class="row ma-party-details-container">
-  <div class="col-sm-6 col-sm-offset-3">
-    <legend>
-      View and Edit Your Party Details:
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <legend style="margin:20px 0;">
+      Here you will see and change the details of the party:
     </legend>
-    <form class="form-horizontal">
-      <div class="form-group">
+    <form layout="column">
+      <md-input-container>
         <label>Party Name</label>
-        <input ng-model="partyDetails.party.name" ng-disabled="party.owner != currentUserId" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Party Name</label>
-        <input ng-model="partyDetails.party.description" ng-disabled="party.owner != currentUserId" type="text"
-               class="form-control">
-      </div>
-      <div class="form-group">
-        <label>Is public</label>
-        <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="party.owner != currentUserId">
-      </div>
-      <div class="form-group" ng-show="party.owner == currentUserId">
-        <button ng-click="partyDetails.save()" class="btn btn-primary">Save</button>
+        <input ng-model="partyDetails.party.name" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Name">
+      </md-input-container>
+      <md-input-container>
+        <label>Party Description</label>
+        <input ng-model="partyDetails.party.description" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Description">
+      </md-input-container>
+      <md-checkbox ng-model="partyDetails.party.public" ng-disabled="party.owner != partyDetails.currentUserId" aria-label="Public">
+        Is public
+      </md-checkbox>
+
+      <div layout="row" layout-align="left">
+        <md-button ng-show="party.owner == partyDetails.currentUserId" ng-click="partyDetails.save()">Save</md-button>
+        <md-button ng-href="/parties">Back</md-button>
       </div>
-    </form>
 
-    <div class="ma-invite-list" ng-show="partyDetails.canInvite()">
-      <h3>
-        Users to invite:
-      </h3>
-      <ul>
-        <li ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
+      <md-list ng-show="partyDetails.canInvite()">
+        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
+        <md-list-item ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
           <div>{{ user | displayName }}</div>
-          <button ng-click="partyDetails.invite(user)" class="btn btn-primary">Invite</button>
-        </li>
-        <li ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
+          <md-button ng-click="partyDetails.invite(user)">Invite</md-button>
+        </md-list-item>
+        <md-list-item ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
           Everyone are already invited.
-        </li>
-      </ul>
-    </div>
-
-    <h3 class="ma-map-title">
-      Click the map to set the party location
-    </h3>
+        </md-list-item>
+      </md-list>
 
-    <div class="angular-google-map-container">
-      <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
-                          events="partyDetails.map.events" zoom="partyDetails.map.zoom">
-        <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
-                        events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
-        </ui-gmap-marker>
-      </ui-gmap-google-map>
-    </div>
+      <div class="angular-google-map-container">
+        <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
+                            events="partyDetails.map.events" zoom="partyDetails.map.zoom">
+          <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
+                          events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
+          </ui-gmap-marker>
+        </ui-gmap-google-map>
+      </div>
+    </form>
   </div>
-
 </div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From fd8508a9e831f0fab89c2fe0b8d0d0ce749a721a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:24:28 +0200
Subject: [PATCH 164/244] Step 18.12: Update the view of add new party modal to
 use angular-material

---
 .../add-new-party-modal/add-new-party-modal.html   | 54 +++++++++++++---------
 client/styles/main.less                            |  4 ++
 2 files changed, 36 insertions(+), 22 deletions(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 69a1af3..3b657f5 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -1,24 +1,34 @@
-<div class="container-fluid ma-add-new-party-container">
-  <div class="alert alert-info" ng-hide="addNewPartyModal.isLoggedIn">
-    Please log in to create a party!
-  </div>
-
-  <form ng-show="addNewPartyModal.isLoggedIn">
-    <h2>Create a new party</h2>
-
-    <div class="form-group">
-      <label for="nameInput">Name</label>
-      <input ng-model="addNewPartyModal.newParty.name" id="nameInput" type="text" class="form-control">
+<md-dialog style="min-width: 600px;">
+  <form>
+    <md-toolbar>
+      <div class="md-toolbar-tools">
+        <h2> Create a new party</h2>
+        <span flex></span>
+      </div>
+    </md-toolbar>
+    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+      <div ng-show="addNewPartyModal.isLoggedIn">
+        <md-input-container>
+          <label>Name</label>
+          <input ng-model="addNewPartyModal.newParty.name" id="nameInput" type="text" aria-label="Name">
+        </md-input-container>
+        <md-input-container>
+          <label>Description</label>
+          <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" aria-label="Description">
+        </md-input-container>
+        <md-checkbox ng-model="addNewPartyModal.newParty.public" id="public" aria-label="Public">
+          Public
+        </md-checkbox>
+      </div>
+    </md-dialog-content>
+    <div class="md-actions" layout="row">
+      <span flex></span>
+      <md-button ng-click="addNewPartyModal.close()">
+        Close
+      </md-button>
+      <md-button ng-click="addNewPartyModal.addNewParty()" style="margin-right:20px;">
+        Add
+      </md-button>
     </div>
-    <div class="form-group">
-      <label for="description">Description</label>
-      <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" class="form-control">
-    </div>
-    <div class="form-group">
-      <label for="public">
-        <input type="checkbox" ng-model="addNewPartyModal.newParty.public" id="public"> Public
-      </label>
-    </div>
-    <button ng-click="addNewPartyModal.addNewParty()" class="btn">Add</button>
   </form>
-</div>
\ No newline at end of file
+</md-dialog>
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
index 96f4c16..afa9aaa 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -1,6 +1,10 @@
 html, body {
 }
 
+md-dialog {
+  opacity: 1 !important;
+}
+
 @import "navbar.import.less";
 @import "../parties/parties-list/parties-list.import.less";
 @import "../parties/party-details/party-details.import.less";
-- 
2.3.2 (Apple Git-55)


From 7125f71e7acf84e21e7679ae6d0dfff8ee959fb4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:38:39 +0200
Subject: [PATCH 165/244] Step 18.13: Replace the main HTML with component

---
 index.html | 11 +----------
 1 file changed, 1 insertion(+), 10 deletions(-)

diff --git a/index.html b/index.html
index 5d08d6f..de1bde8 100644
--- a/index.html
+++ b/index.html
@@ -4,14 +4,5 @@
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
 </head>
 <body layout="column">
-<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
-  <h2>
-    <a ui-sref="parties"><span class="md-title">Socially</span></a>
-  </h2>
-  <span flex></span>
-  <div class="navbar-right navbar-text">
-    <login-buttons></login-buttons>
-  </div>
-</md-toolbar>
-<div ui-view flex-gt-sm layout-gt-sm="row"></div>
+<socially></socially>
 </body>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a9e110e303fd402cbaa1fc3c8f876a5406540a35 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:38:57 +0200
Subject: [PATCH 166/244] Step 18.14: Create the socially component view

---
 client/socially/socially.html | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 client/socially/socially.html

diff --git a/client/socially/socially.html b/client/socially/socially.html
new file mode 100644
index 0000000..9411e27
--- /dev/null
+++ b/client/socially/socially.html
@@ -0,0 +1,10 @@
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <login-buttons></login-buttons>
+  </div>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 59c58268faf136465707b41eb8c533c371212edf Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:41:21 +0200
Subject: [PATCH 167/244] Step 18.15: Create the socially component

---
 client/socially/socially.component.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 client/socially/socially.component.js

diff --git a/client/socially/socially.component.js b/client/socially/socially.component.js
new file mode 100644
index 0000000..9f77880
--- /dev/null
+++ b/client/socially/socially.component.js
@@ -0,0 +1,19 @@
+angular.module('socially').directive('socially', function () {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/socially/socially.html',
+    controllerAs: 'socially',
+    controller: function ($scope, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUser: () => {
+          return Meteor.user();
+        }
+      });
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ca8693ed8fd286aadb05f467aebfd7c302344244 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:43:20 +0200
Subject: [PATCH 168/244] Step 18.16: Replace the login-buttons with custom
 view

---
 client/socially/socially.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/socially/socially.html b/client/socially/socially.html
index 9411e27..2cfe056 100644
--- a/client/socially/socially.html
+++ b/client/socially/socially.html
@@ -4,7 +4,10 @@
   </h2>
   <span flex></span>
   <div class="navbar-right navbar-text">
-    <login-buttons></login-buttons>
+    <md-button ng-href="/login" ng-hide="socially.isLoggedIn">Login</md-button>
+    <md-button ng-href="/register" ng-hide="socially.isLoggedIn">Sign up</md-button>
+    <div ng-show="socially.isLoggedIn">{{ socially.currentUser | displayName }}</div>
+    <md-button ng-click="socially.logout()" ng-show="socially.isLoggedIn">Logout</md-button>
   </div>
 </md-toolbar>
 <div ui-view flex-gt-sm layout-gt-sm="row"></div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 48376d974715788f53df2bd702c348cfa7cf616d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:43:41 +0200
Subject: [PATCH 169/244] Step 18.17: Add custom auth states

---
 client/routes.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/client/routes.js b/client/routes.js
index 545a926..41a3743 100644
--- a/client/routes.js
+++ b/client/routes.js
@@ -20,6 +20,18 @@ angular.module('socially')
             }
           }
         }
+      })
+      .state('login', {
+        url: '/login',
+        template: '<login></login>'
+      })
+      .state('register', {
+        url: '/register',
+        template: '<register></register>'
+      })
+      .state('resetpw', {
+        url: '/resetpw',
+        template: '<resetpw></resetpw>'
       });
 
     $urlRouterProvider.otherwise("/parties");
-- 
2.3.2 (Apple Git-55)


From f020432f4f6b7666b85e5b527f89df69a3a1081d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:50:48 +0200
Subject: [PATCH 170/244] Fix less file

---
 client/styles/main.less | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/styles/main.less b/client/styles/main.less
index afa9aaa..d4e20b2 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -5,6 +5,10 @@ md-dialog {
   opacity: 1 !important;
 }
 
+div[ui-view] > * {
+  width: 100%;
+}
+
 @import "navbar.import.less";
 @import "../parties/parties-list/parties-list.import.less";
 @import "../parties/party-details/party-details.import.less";
-- 
2.3.2 (Apple Git-55)


From 30b448f3be05ca0a17b54af8e98e5cf682385e22 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:54:06 +0200
Subject: [PATCH 171/244] Step 18.18: Create the login component

---
 client/auth/login/login.component.js | 28 ++++++++++++++++++++++++++++
 1 file changed, 28 insertions(+)
 create mode 100644 client/auth/login/login.component.js

diff --git a/client/auth/login/login.component.js b/client/auth/login/login.component.js
new file mode 100644
index 0000000..7ee375b
--- /dev/null
+++ b/client/auth/login/login.component.js
@@ -0,0 +1,28 @@
+angular.module("socially").directive('login', function() {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/auth/login/login.html',
+    controllerAs: 'login',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: '',
+        password: ''
+      };
+
+      this.error = '';
+
+      this.login = () => {
+        Meteor.loginWithPassword(this.credentials.email, this.credentials.password, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 5235645f6c42b7a6d31960917785837f4f9096ca Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:54:18 +0200
Subject: [PATCH 172/244] Step 18.19: Create the login view

---
 client/auth/login/login.html | 62 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 62 insertions(+)
 create mode 100644 client/auth/login/login.html

diff --git a/client/auth/login/login.html b/client/auth/login/login.html
new file mode 100644
index 0000000..9b3c7d1
--- /dev/null
+++ b/client/auth/login/login.html
@@ -0,0 +1,62 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Sign in </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Use existing account</p>
+      </div>
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container>
+          <label> Password </label>
+          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/resetpw">Forgot password?</a>
+          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login"
+                     ng-disabled="login.loginForm.$invalid()">Sign In
+          </md-button>
+        </div>
+      </form>
+      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ login.error }}</p>
+      </md-toolbar>
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/register">Need an account?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 6ce9ce5c9e2bd30bebe3539d584bf2732ec89241 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:54:32 +0200
Subject: [PATCH 173/244] Step 18.20: Create the logout method

---
 client/socially/socially.component.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/socially/socially.component.js b/client/socially/socially.component.js
index 9f77880..d3e7c60 100644
--- a/client/socially/socially.component.js
+++ b/client/socially/socially.component.js
@@ -14,6 +14,10 @@ angular.module('socially').directive('socially', function () {
           return Meteor.user();
         }
       });
+
+      this.logout = () => {
+        Accounts.logout();
+      }
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b5f1dc14522fe113026e91e5717f4f13d08e0c53 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:59:38 +0200
Subject: [PATCH 174/244] Step 18.21: Create the register component

---
 client/auth/register/register.component.js | 28 ++++++++++++++++++++++++++++
 1 file changed, 28 insertions(+)
 create mode 100644 client/auth/register/register.component.js

diff --git a/client/auth/register/register.component.js b/client/auth/register/register.component.js
new file mode 100644
index 0000000..54a884c
--- /dev/null
+++ b/client/auth/register/register.component.js
@@ -0,0 +1,28 @@
+angular.module("socially").directive('register', function() {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/auth/register/register.html',
+    controllerAs: 'register',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: '',
+        password: ''
+      };
+
+      this.error = '';
+
+      this.register = () => {
+        Accounts.createUser(this.credentials, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bd75ad8fcc4121c7bba338339babc20e71eccbce Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 19:59:59 +0200
Subject: [PATCH 175/244] Step 18.22: Create the register component view

---
 client/auth/register/register.html | 63 ++++++++++++++++++++++++++++++++++++++
 1 file changed, 63 insertions(+)
 create mode 100644 client/auth/register/register.html

diff --git a/client/auth/register/register.html b/client/auth/register/register.html
new file mode 100644
index 0000000..8100629
--- /dev/null
+++ b/client/auth/register/register.html
@@ -0,0 +1,63 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Register a new account</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Use your email?</p>
+      </div>
+
+      <form name="registerForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container >
+          <label> Email </label>
+          <input type="text" ng-model="register.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container >
+          <label> Password </label>
+          <input type="password" ng-model="register.credentials.password" placeholder="password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="register.register()" aria-label="login" ng-disabled="register.registerForm.$invalid()">Register</md-button>
+        </div>
+      </form>
+
+      <md-divider class="inset"></md-divider>
+
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Want to use an existing account? </p>
+      </div>
+
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-toolbar ng-show="register.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ register.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Already a user?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From da15e274038564cde3c81da104207f8fb369961a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:03:47 +0200
Subject: [PATCH 176/244] Step 18.23: Create the reset password component

---
 .../reset-password/reset-password.component.js     | 27 ++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 client/auth/reset-password/reset-password.component.js

diff --git a/client/auth/reset-password/reset-password.component.js b/client/auth/reset-password/reset-password.component.js
new file mode 100644
index 0000000..241ae8a
--- /dev/null
+++ b/client/auth/reset-password/reset-password.component.js
@@ -0,0 +1,27 @@
+angular.module("socially").directive('resetpw', function() {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/auth/reset-password/reset-password.html',
+    controllerAs: 'resetpw',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: ''
+      };
+
+      this.error = '';
+
+      this.reset = () => {
+        Accounts.forgotPassword(this.credentials, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 8c106e1fbc26c71e2ada70a585d6bceb13300c97 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:03:57 +0200
Subject: [PATCH 177/244] Step 18.24: Create the reset password component view

---
 client/auth/reset-password/reset-password.html | 40 ++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 client/auth/reset-password/reset-password.html

diff --git a/client/auth/reset-password/reset-password.html b/client/auth/reset-password/reset-password.html
new file mode 100644
index 0000000..138ecf4
--- /dev/null
+++ b/client/auth/reset-password/reset-password.html
@@ -0,0 +1,40 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Reset Password</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Enter your email so we can send you a reset link</p>
+      </div>
+
+      <form name="resetForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="resetpw.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="resetpw.reset()" aria-label="reset"
+                     ng-disabled="resetpw.resetForm.$invalid()">Send Email
+          </md-button>
+        </div>
+      </form>
+
+      <md-toolbar ng-show="resetpw.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ resetpw.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Sign in</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7f82b521f25e4fe63e8c3c41f34aafc628442723 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:06:42 +0200
Subject: [PATCH 178/244] Step 20.1: Add cfs:standard-packages package

---
 .meteor/packages |  1 +
 .meteor/versions | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index a44a0f1..72f5ab6 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -29,3 +29,4 @@ less
 angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
+cfs:standard-packages
diff --git a/.meteor/versions b/.meteor/versions
index fef35c8..66bb9d0 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -28,6 +28,22 @@ boilerplate-generator@1.0.4
 caching-compiler@1.0.0
 caching-html-compiler@1.0.2
 callback-hook@1.0.4
+cfs:access-point@0.1.49
+cfs:base-package@0.0.30
+cfs:collection@0.5.5
+cfs:collection-filters@0.2.4
+cfs:data-man@0.0.6
+cfs:file@0.1.17
+cfs:http-methods@0.0.30
+cfs:http-publish@0.0.13
+cfs:power-queue@0.9.11
+cfs:reactive-list@0.0.9
+cfs:reactive-property@0.0.4
+cfs:standard-packages@0.5.9
+cfs:storage-adapter@0.2.3
+cfs:tempstore@0.1.5
+cfs:upload-http@0.0.20
+cfs:worker@0.1.4
 check@1.1.0
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
@@ -66,6 +82,7 @@ mobile-experience@1.0.1
 mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
+mongo-livedata@1.0.9
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
@@ -77,6 +94,7 @@ ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.6
 planettraining:material-design-icons@2.0.0
 promise@0.5.1
+raix:eventemitter@0.1.3
 random@1.0.5
 rate-limit@1.0.0
 reactive-dict@1.1.3
-- 
2.3.2 (Apple Git-55)


From b4274610ca0cceb1a0333db912d26b4e97b57473 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:08:00 +0200
Subject: [PATCH 179/244] Step 20.2: Add cfs:gridfs package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 72f5ab6..83c7679 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -30,3 +30,4 @@ angularui:angular-ui-bootstrap
 angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
+cfs:gridfs
diff --git a/.meteor/versions b/.meteor/versions
index 66bb9d0..1c9708c 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -34,6 +34,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
 cfs:power-queue@0.9.11
-- 
2.3.2 (Apple Git-55)


From c11123d7e2f70e8ac0ea141bcb1130fd46964de2 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:14:09 +0200
Subject: [PATCH 180/244] Step 20.3: Create the Images collection and publish
 it

---
 model/images.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 model/images.js

diff --git a/model/images.js b/model/images.js
new file mode 100644
index 0000000..5cec451
--- /dev/null
+++ b/model/images.js
@@ -0,0 +1,31 @@
+Images = new FS.Collection("images", {
+  stores: [
+    new FS.Store.GridFS("original")
+  ],
+  filter: {
+    allow: {
+      contentTypes: ['image/*']
+    }
+  }
+});
+
+if (Meteor.isServer) {
+  Images.allow({
+    insert: function (userId) {
+      return (userId ? true : false);
+    },
+    remove: function (userId) {
+      return (userId ? true : false);
+    },
+    download: function () {
+      return true;
+    },
+    update: function (userId) {
+      return (userId ? true : false);
+    }
+  });
+
+  Meteor.publish('images', function() {
+    return Images.find({});
+  });
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b27662464a2205c0ffc50c314ba5bd1b80859826 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:16:04 +0200
Subject: [PATCH 181/244] Step 20.4: Add subscription and images collection to
 the parties list

---
 client/parties/parties-list/parties-list.component.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index 64406b8..a9565c5 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -29,9 +29,14 @@ angular.module('socially').directive('partiesList', function () {
         },
         currentUserId: () => {
           return Meteor.userId();
+        },
+        images: () => {
+          return Images.find({});
         }
       });
 
+      this.subscribe('images');
+
       this.map = {
         center: {
           latitude: 45,
-- 
2.3.2 (Apple Git-55)


From fe79739cd05b33c0e1441905cf1b2612c1460705 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:17:20 +0200
Subject: [PATCH 182/244] Step 20.5: Add danialfarid:ng-file-upload package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 83c7679..cd07b1d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -31,3 +31,4 @@ angular:angular-material
 planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
+danialfarid:ng-file-upload
diff --git a/.meteor/versions b/.meteor/versions
index 1c9708c..74b0f82 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -46,6 +46,7 @@ cfs:tempstore@0.1.5
 cfs:upload-http@0.0.20
 cfs:worker@0.1.4
 check@1.1.0
+danialfarid:ng-file-upload@5.0.9
 dburles:mongo-collection-instances@0.3.4
 ddp@1.2.2
 ddp-client@1.2.1
-- 
2.3.2 (Apple Git-55)


From 49bb172b22243b7e94b9741c91ccdcb92e84c3a4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:17:46 +0200
Subject: [PATCH 183/244] Step 20.6: Add dependency for ngFileUpload

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 6a711c3..04eef2d 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -4,7 +4,8 @@ angular.module('socially', [
   'accounts.ui',
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
-  'ngMaterial'
+  'ngMaterial',
+  'ngFileUpload'
 ]);
 
 angular.module('socially').config(($mdIconProvider) => {
-- 
2.3.2 (Apple Git-55)


From e31c36733d497996d1054dcf36dc6a8864bbb677 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:22:49 +0200
Subject: [PATCH 184/244] Step 20.7: Use ngFileUpload in the view

---
 .../add-new-party-modal/add-new-party-modal.html       | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 3b657f5..6da5f7b 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -16,6 +16,24 @@
           <label>Description</label>
           <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" aria-label="Description">
         </md-input-container>
+        <md-whiteframe class="md-whiteframe-z1" layout="column">
+          <div layout="row" class="images-container-title">
+            <div flex>
+              <h3>Add photos to your party!</h3>
+                <div ngf-drop ngf-select
+                     ngf-change="addNewPartyModal.addImages($files)"
+                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
+                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
+                     ngf-drop-available="true">
+                  <div>Click here to select image</div>
+                  <div>
+                    <strong>OR</strong>
+                  </div>
+                  You can also drop image to here
+                </div>
+            </div>
+          </div>
+        </md-whiteframe>
         <md-checkbox ng-model="addNewPartyModal.newParty.public" id="public" aria-label="Public">
           Public
         </md-checkbox>
-- 
2.3.2 (Apple Git-55)


From ab6a266153b5bcac5f72778a0708e2a2ade601f6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:23:10 +0200
Subject: [PATCH 185/244] Step 20.8: Add some style rules for the file upload
 box

---
 .../add-new-party-modal.import.less                    | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 client/parties/add-new-party-modal/add-new-party-modal.import.less

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
new file mode 100644
index 0000000..cedf68b
--- /dev/null
+++ b/client/parties/add-new-party-modal/add-new-party-modal.import.less
@@ -0,0 +1,18 @@
+.drop-box {
+  background: #F8F8F8;
+  border: 5px dashed #DDD;
+  width: 230px;
+  height: 120px;
+  text-align: center;
+  padding-top: 25px;
+  margin-left: 10px;
+  margin-bottom: 20px;
+}
+
+.drop-box.dragover {
+  border: 5px dashed blue;
+}
+
+.drop-box.dragover-err {
+  border: 5px dashed red;
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ea8ce87503d44f32fc22dd28a582a8c729c26850 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:23:22 +0200
Subject: [PATCH 186/244] Step 20.9: Import the new LESS file

---
 client/styles/main.less | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/styles/main.less b/client/styles/main.less
index d4e20b2..6c61f8e 100644
--- a/client/styles/main.less
+++ b/client/styles/main.less
@@ -12,3 +12,4 @@ div[ui-view] > * {
 @import "navbar.import.less";
 @import "../parties/parties-list/parties-list.import.less";
 @import "../parties/party-details/party-details.import.less";
+@import "../parties/add-new-party-modal/add-new-party-modal.import.less";
-- 
2.3.2 (Apple Git-55)


From b5ee146657c0a41700a27ca34fa255761dcb71ac Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:24:38 +0200
Subject: [PATCH 187/244] Step 20.10: Implement the actual image upload logic

---
 .../parties/add-new-party-modal/add-new-party-modal.component.js  | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
index 0b605fa..836f564 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -23,7 +23,13 @@ angular.module('socially').directive('addNewPartyModal', function () {
 
       this.close = () => {
         $mdDialog.hide();
-      }
+      };
+
+      this.addImages = (files) => {
+        if (files.length > 0) {
+          Images.insert(files[0]);
+        }
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 4e722b142b490c16eb2b578f44ba16b2bb875ea0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:25:36 +0200
Subject: [PATCH 188/244] Step 20.11: Add alexk111:ng-img-crop package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index cd07b1d..ad1608a 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -32,3 +32,4 @@ planettraining:material-design-icons
 cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
+alexk111:ng-img-crop
diff --git a/.meteor/versions b/.meteor/versions
index 74b0f82..a2dbaf4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -5,6 +5,7 @@ accounts-password@1.1.4
 accounts-twitter@1.0.6
 accounts-ui@1.1.6
 accounts-ui-unstyled@1.1.8
+alexk111:ng-img-crop@0.3.2
 angular@1.3.0
 angular-meteor-data@0.0.8
 angular-templates@0.0.2
-- 
2.3.2 (Apple Git-55)


From c6ee0252eed72920b397c0c9c549b088fac072e3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:26:18 +0200
Subject: [PATCH 189/244] Step 20.12: Add dependency for ngImgCrop

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 04eef2d..ccf221d 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -5,7 +5,8 @@ angular.module('socially', [
   'angularUtils.directives.dirPagination',
   'uiGmapgoogle-maps',
   'ngMaterial',
-  'ngFileUpload'
+  'ngFileUpload',
+  'ngImgCrop'
 ]);
 
 angular.module('socially').config(($mdIconProvider) => {
-- 
2.3.2 (Apple Git-55)


From 4910c698ab41e7a4f391a50e8068a67fea4a4619 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:49:00 +0200
Subject: [PATCH 190/244] Step 20.13: Add the image crop usage

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 6da5f7b..c6183c1 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -20,7 +20,7 @@
           <div layout="row" class="images-container-title">
             <div flex>
               <h3>Add photos to your party!</h3>
-                <div ngf-drop ngf-select
+                <div ng-hide="addNewPartyModal.cropImgSrc" ngf-drop ngf-select
                      ngf-change="addNewPartyModal.addImages($files)"
                      ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
                      ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
@@ -31,6 +31,10 @@
                   </div>
                   You can also drop image to here
                 </div>
+              <div ng-show="addNewPartyModal.cropImgSrc" class="ng-crop-container">
+                <h3>Great! Now edit & crop your image...</h3><br />
+                <img-crop image="addNewPartyModal.cropImgSrc" result-image="addNewPartyModal.myCroppedImage" area-type="square"></img-crop>
+              </div>
             </div>
           </div>
         </md-whiteframe>
-- 
2.3.2 (Apple Git-55)


From c6d6e712af27dec87cde039543c77293e721b23a Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:49:18 +0200
Subject: [PATCH 191/244] Step 20.14: Added some CSS rules for the image crop
 container

---
 .../parties/add-new-party-modal/add-new-party-modal.import.less  | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
index cedf68b..34965fb 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.import.less
+++ b/client/parties/add-new-party-modal/add-new-party-modal.import.less
@@ -15,4 +15,13 @@
 
 .drop-box.dragover-err {
   border: 5px dashed red;
+}
+
+.uploaded-image {
+  max-height: 100px;
+  max-width: 200px;
+}
+
+.ng-crop-container {
+  height: 400px;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e6dbf90ed053ffd49adcb5d084a13da4acef083c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 20:49:50 +0200
Subject: [PATCH 192/244] Step 20.15: Implement the file read in the client
 side and use it in the crop directive

---
 .../add-new-party-modal/add-new-party-modal.component.js   | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
index 836f564..489298b 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -27,7 +27,19 @@ angular.module('socially').directive('addNewPartyModal', function () {
 
       this.addImages = (files) => {
         if (files.length > 0) {
-          Images.insert(files[0]);
+          let reader = new FileReader();
+
+          reader.onload = (e) => {
+            $scope.$apply(() => {
+              this.cropImgSrc = e.target.result;
+              this.myCroppedImage = '';
+            });
+          };
+
+          reader.readAsDataURL(files[0]);
+        }
+        else {
+          this.cropImgSrc = undefined;
         }
       };
     }
-- 
2.3.2 (Apple Git-55)


From ac58be0bf39f1d41a249ab2604c7bee6e10e8d55 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:09:19 +0200
Subject: [PATCH 193/244] Step 20.15: Add save button for the cropped image

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index c6183c1..62d1929 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -32,7 +32,10 @@
                   You can also drop image to here
                 </div>
               <div ng-show="addNewPartyModal.cropImgSrc" class="ng-crop-container">
-                <h3>Great! Now edit & crop your image...</h3><br />
+                <h3>Great! Now edit & crop your image...</h3>
+                <md-button ng-click="addNewPartyModal.saveCroppedImage()" ng-disabled="!addNewPartyModal.cropImgSrc" class="md-primary">
+                  Save Image
+                </md-button>
                 <img-crop image="addNewPartyModal.cropImgSrc" result-image="addNewPartyModal.myCroppedImage" area-type="square"></img-crop>
               </div>
             </div>
-- 
2.3.2 (Apple Git-55)


From 880436ed3690586b293b937d08e1745e6d58698b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:41:47 +0200
Subject: [PATCH 194/244] Step 20.17: Add the logic for saving the cropped
 image

---
 .../add-new-party-modal.component.js                   | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
index 489298b..af671df 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -16,6 +16,10 @@ angular.module('socially').directive('addNewPartyModal', function () {
 
       this.addNewParty = () => {
         this.newParty.owner = Meteor.userId();
+        this.newParty.images = this.newParty.images.map((image) => {
+          return image._id;
+        });
+
         Parties.insert(this.newParty);
         this.newParty = {};
         $mdDialog.hide();
@@ -42,6 +46,20 @@ angular.module('socially').directive('addNewPartyModal', function () {
           this.cropImgSrc = undefined;
         }
       };
+
+      this.saveCroppedImage = () => {
+        if (this.myCroppedImage !== '') {
+          Images.insert(this.myCroppedImage, (err, fileObj) => {
+            if (!this.newParty.images) {
+              this.newParty.images = [];
+            }
+
+            this.newParty.images.push(fileObj);
+            this.cropImgSrc = undefined;
+            this.myCroppedImage = '';
+          });
+        }
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From a6aab03b4c37d68d53d1db6008c01fd52521cd9c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:41:51 +0200
Subject: [PATCH 195/244] Step 20.18: Add the display of the uploaded image

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 62d1929..8871380 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -40,6 +40,12 @@
               </div>
             </div>
           </div>
+          <br />
+          <div layout="row" class="images-container-title">
+            <div class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
+              <img ng-src="{{ image.url() }}"/><br/>
+            </div>
+          </div>
         </md-whiteframe>
         <md-checkbox ng-model="addNewPartyModal.newParty.public" id="public" aria-label="Public">
           Public
-- 
2.3.2 (Apple Git-55)


From 80ea928403013cedd3ac6e2572098ba65cf4b54c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:43:22 +0200
Subject: [PATCH 196/244] Step 20.19: Add vitalets:angular-xeditable package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index ad1608a..2e67c6d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -33,3 +33,4 @@ cfs:standard-packages
 cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
+vitalets:angular-xeditable
diff --git a/.meteor/versions b/.meteor/versions
index a2dbaf4..c272612 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -121,5 +121,6 @@ twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
 url@1.0.5
+vitalets:angular-xeditable@0.1.9
 webapp@1.2.3
 webapp-hashing@1.0.5
-- 
2.3.2 (Apple Git-55)


From 74c352157c9de05a383d6fdd4aa7d995841cb2d6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:44:09 +0200
Subject: [PATCH 197/244] Step 20.20: Add dependecy for xeditable

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index ccf221d..3bbefc9 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -6,7 +6,8 @@ angular.module('socially', [
   'uiGmapgoogle-maps',
   'ngMaterial',
   'ngFileUpload',
-  'ngImgCrop'
+  'ngImgCrop',
+  'xeditable'
 ]);
 
 angular.module('socially').config(($mdIconProvider) => {
-- 
2.3.2 (Apple Git-55)


From 97c460649a21dc4795a684dacbcb4f17843b13a0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:47:26 +0200
Subject: [PATCH 198/244] Step 20.21: Add angular-xeditable usage

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 8871380..caf0962 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -1,5 +1,5 @@
 <md-dialog style="min-width: 600px;">
-  <form>
+  <div>
     <md-toolbar>
       <div class="md-toolbar-tools">
         <h2> Create a new party</h2>
@@ -44,6 +44,8 @@
           <div layout="row" class="images-container-title">
             <div class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
               <img ng-src="{{ image.url() }}"/><br/>
+              <a href="#" editable-text="image.metadata.description"
+                 onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
             </div>
           </div>
         </md-whiteframe>
@@ -61,5 +63,5 @@
         Add
       </md-button>
     </div>
-  </form>
+  </div>
 </md-dialog>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 05d4cd699001196908e73028bd2770f014d1d814 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:47:36 +0200
Subject: [PATCH 199/244] Step 20.22: Implement updateDescription method

---
 client/parties/add-new-party-modal/add-new-party-modal.component.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
index af671df..2a8809b 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ b/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -60,6 +60,10 @@ angular.module('socially').directive('addNewPartyModal', function () {
           });
         }
       };
+
+      this.updateDescription = ($data, image) => {
+        Images.update({_id: image._id}, {$set: {'metadata.description': $data}});
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 520fcc41e28d6938c0d9b302892399c11087bd4c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:49:30 +0200
Subject: [PATCH 200/244] Step 20.23: Add netanelgilad:angular-sortable-view
 package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 2e67c6d..382c618 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -34,3 +34,4 @@ cfs:gridfs
 danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
+netanelgilad:angular-sortable-view
diff --git a/.meteor/versions b/.meteor/versions
index c272612..c4c605f 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -86,6 +86,7 @@ mobile-status-bar@1.0.6
 mongo@1.1.3
 mongo-id@1.0.1
 mongo-livedata@1.0.9
+netanelgilad:angular-sortable-view@0.0.13_1
 nmccready:angular-simple-logger@0.0.4
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.39_1
-- 
2.3.2 (Apple Git-55)


From fac8242aed82119ac4cd7b4c0699821a63556e57 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:49:54 +0200
Subject: [PATCH 201/244] Step 20.24: Add angular-sortable-view dependency

---
 client/lib/app.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 3bbefc9..1e6949b 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -7,7 +7,8 @@ angular.module('socially', [
   'ngMaterial',
   'ngFileUpload',
   'ngImgCrop',
-  'xeditable'
+  'xeditable',
+  'angular-sortable-view'
 ]);
 
 angular.module('socially').config(($mdIconProvider) => {
-- 
2.3.2 (Apple Git-55)


From fc584ab28c87f3cd106d4a8cf1b4cdd15717da52 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:54:33 +0200
Subject: [PATCH 202/244] Step 20.25: Add sortable usage

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index caf0962..3a38027 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -41,9 +41,9 @@
             </div>
           </div>
           <br />
-          <div layout="row" class="images-container-title">
-            <div class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
-              <img ng-src="{{ image.url() }}"/><br/>
+          <div layout="row" class="images-container-title" sv-root sv-part="addNewPartyModal.newParty.images">
+            <div sv-element class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
+              <img draggable="false" ng-src="{{ image.url() }}"/><br/>
               <a href="#" editable-text="image.metadata.description"
                  onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
             </div>
-- 
2.3.2 (Apple Git-55)


From b22d8dbc245c21a8a4b95cc741adc587e23de9da Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:55:25 +0200
Subject: [PATCH 203/244] Step 20.26: Add indication for the main image

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 3a38027..5cd2755 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -43,6 +43,7 @@
           <br />
           <div layout="row" class="images-container-title" sv-root sv-part="addNewPartyModal.newParty.images">
             <div sv-element class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
+              <div class="main-image" ng-show="$index === 0">Main Image</div>
               <img draggable="false" ng-src="{{ image.url() }}"/><br/>
               <a href="#" editable-text="image.metadata.description"
                  onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
-- 
2.3.2 (Apple Git-55)


From f995bd146d5e2cc99a5998ea76db9d2d1d414c8f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 21:55:40 +0200
Subject: [PATCH 204/244] Step 20.27: Add style for the sortable list

---
 .../add-new-party-modal.import.less                | 26 ++++++++++++++++++++++
 1 file changed, 26 insertions(+)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
index 34965fb..b609f03 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.import.less
+++ b/client/parties/add-new-party-modal/add-new-party-modal.import.less
@@ -24,4 +24,30 @@
 
 .ng-crop-container {
   height: 400px;
+}
+
+
+.images-container-title {
+  padding-bottom: 30px;
+}
+
+.party-image-container {
+  position: relative;
+  margin-right: 10px;
+  max-height: 200px;
+  max-width: 200px;
+
+  img {
+    max-height: 100%;
+    max-width: 100%;
+  }
+}
+
+.main-image {
+  position: absolute;
+  top: 0;
+  left: 0;
+  width: 100%;
+  text-align: center;
+  background-color: #f8f8f8;
 }
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From edcf0a3924e1c5c901dc046dcda533639902465f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:04:31 +0200
Subject: [PATCH 205/244] Step 20.28: Add the main image to the parties list
 view

---
 client/parties/parties-list/parties-list.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
index 4f7a14f..15ca915 100644
--- a/client/parties/parties-list/parties-list.html
+++ b/client/parties/parties-list/parties-list.html
@@ -20,6 +20,10 @@
         <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
         <div dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount" class="ma-party">
           <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="partiesList.getMainImage(party.images)"
+                 class="party-image">
+            </div>
             <md-card-content>
               <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
               <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-- 
2.3.2 (Apple Git-55)


From 3580997726701ee678601998b37d4176daaaaf95 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:04:54 +0200
Subject: [PATCH 206/244] Step 20.29: Implement the getMainImage method

---
 client/parties/parties-list/parties-list.component.js | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
index a9565c5..f9d5795 100644
--- a/client/parties/parties-list/parties-list.component.js
+++ b/client/parties/parties-list/parties-list.component.js
@@ -3,7 +3,7 @@ angular.module('socially').directive('partiesList', function () {
     restrict: 'E',
     templateUrl: 'client/parties/parties-list/parties-list.html',
     controllerAs: 'partiesList',
-    controller: function ($scope, $reactive, $mdDialog) {
+    controller: function ($scope, $reactive, $mdDialog, $filter) {
       $reactive(this).attach($scope);
 
       this.perPage = 3;
@@ -166,7 +166,17 @@ angular.module('socially').directive('partiesList', function () {
           party.myRsvpIndex = rsvpIndex;
           return party.rsvps[rsvpIndex].rsvp === rsvp;
         }
-      }
+      };
+
+      this.getMainImage = (images) => {
+        if (images && images.length && images[0] && images[0]) {
+          var url = $filter('filter')(this.images, {_id: images[0]})[0].url();
+
+          return {
+            'background-image': 'url("' + url + '")'
+          }
+        }
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From f075f2eaf281b64db5f43c8fe3bfad6e4493dade Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:05:02 +0200
Subject: [PATCH 207/244] Step 20.30: Add some CSS

---
 client/parties/parties-list/parties-list.import.less | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/client/parties/parties-list/parties-list.import.less b/client/parties/parties-list/parties-list.import.less
index ea78dfb..3ce0188 100644
--- a/client/parties/parties-list/parties-list.import.less
+++ b/client/parties/parties-list/parties-list.import.less
@@ -52,6 +52,12 @@ parties-list {
   }
 
   .ma-party {
+    .party-image {
+      background-size: cover;
+      width: 100%;
+      height: 200px;
+    }
+
     .ma-name {
       a {
         text-decoration: none;
-- 
2.3.2 (Apple Git-55)


From b7eb43e70ff1b8aa5c6789196e52c11f1b6a69b6 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:06:52 +0200
Subject: [PATCH 208/244] Step 20.31: Add the thumbnails store

---
 model/images.js | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/model/images.js b/model/images.js
index 5cec451..3b06d5f 100644
--- a/model/images.js
+++ b/model/images.js
@@ -1,6 +1,11 @@
 Images = new FS.Collection("images", {
   stores: [
-    new FS.Store.GridFS("original")
+    new FS.Store.GridFS("original"),
+    new FS.Store.GridFS("thumbnail", {
+      transformWrite: function(fileObj, readStream, writeStream) {
+        gm(readStream, fileObj.name()).resize('32', '32', '!').stream().pipe(writeStream);
+      }
+    })
   ],
   filter: {
     allow: {
-- 
2.3.2 (Apple Git-55)


From 44a6403a33859c236aaf4515175826c9f3fb013d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:07:41 +0200
Subject: [PATCH 209/244] Step 20.32: Use the thumbnails store

---
 client/parties/add-new-party-modal/add-new-party-modal.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
index 5cd2755..299d8ba 100644
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ b/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -44,7 +44,7 @@
           <div layout="row" class="images-container-title" sv-root sv-part="addNewPartyModal.newParty.images">
             <div sv-element class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
               <div class="main-image" ng-show="$index === 0">Main Image</div>
-              <img draggable="false" ng-src="{{ image.url() }}"/><br/>
+              <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
               <a href="#" editable-text="image.metadata.description"
                  onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
             </div>
-- 
2.3.2 (Apple Git-55)


From 9b2ac9ed0e7d5c0d62315043189e0d7c2c650b42 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:11:05 +0200
Subject: [PATCH 210/244] Step 21.1: Add mobile platform support

---
 .meteor/packages  | 1 +
 .meteor/platforms | 3 ++-
 .meteor/versions  | 1 +
 3 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/.meteor/packages b/.meteor/packages
index 382c618..8502fde 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -35,3 +35,4 @@ danialfarid:ng-file-upload
 alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
+cfs:graphicsmagick
diff --git a/.meteor/platforms b/.meteor/platforms
index efeba1b..81ae701 100644
--- a/.meteor/platforms
+++ b/.meteor/platforms
@@ -1,2 +1,3 @@
-server
 browser
+ios
+server
diff --git a/.meteor/versions b/.meteor/versions
index c4c605f..2a107c0 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -35,6 +35,7 @@ cfs:collection@0.5.5
 cfs:collection-filters@0.2.4
 cfs:data-man@0.0.6
 cfs:file@0.1.17
+cfs:graphicsmagick@0.0.18
 cfs:gridfs@0.0.33
 cfs:http-methods@0.0.30
 cfs:http-publish@0.0.13
-- 
2.3.2 (Apple Git-55)


From 5ea018deec004fd98b9cdf8e94f3a5ba5c887839 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:12:36 +0200
Subject: [PATCH 211/244] Step 21.2: Create the socially-mobile package

---
 packages/socially-mobile/README.md                |  0
 packages/socially-mobile/package.js               | 24 +++++++++++++++++++++++
 packages/socially-mobile/socially-mobile-tests.js |  5 +++++
 packages/socially-mobile/socially-mobile.js       |  1 +
 4 files changed, 30 insertions(+)
 create mode 100644 packages/socially-mobile/README.md
 create mode 100644 packages/socially-mobile/package.js
 create mode 100644 packages/socially-mobile/socially-mobile-tests.js
 create mode 100644 packages/socially-mobile/socially-mobile.js

diff --git a/packages/socially-mobile/README.md b/packages/socially-mobile/README.md
new file mode 100644
index 0000000..e69de29
diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
new file mode 100644
index 0000000..079cecc
--- /dev/null
+++ b/packages/socially-mobile/package.js
@@ -0,0 +1,24 @@
+Package.describe({
+  name: 'socially-mobile',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.1');
+  api.use('ecmascript');
+  api.addFiles('socially-mobile.js');
+});
+
+Package.onTest(function(api) {
+  api.use('ecmascript');
+  api.use('tinytest');
+  api.use('socially-mobile');
+  api.addFiles('socially-mobile-tests.js');
+});
diff --git a/packages/socially-mobile/socially-mobile-tests.js b/packages/socially-mobile/socially-mobile-tests.js
new file mode 100644
index 0000000..c5623d8
--- /dev/null
+++ b/packages/socially-mobile/socially-mobile-tests.js
@@ -0,0 +1,5 @@
+// Write your tests here!
+// Here is an example.
+Tinytest.add('example', function (test) {
+  test.equal(true, true);
+});
diff --git a/packages/socially-mobile/socially-mobile.js b/packages/socially-mobile/socially-mobile.js
new file mode 100644
index 0000000..164ddd9
--- /dev/null
+++ b/packages/socially-mobile/socially-mobile.js
@@ -0,0 +1 @@
+// Write your package code here!
-- 
2.3.2 (Apple Git-55)


From f5f67353701ad73a2cbe8cd08a648e586a6dcfba Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:13:22 +0200
Subject: [PATCH 212/244] Step 21.3: Cleanup the base package

---
 packages/socially-mobile/package.js               | 4 ----
 packages/socially-mobile/socially-mobile-tests.js | 5 -----
 packages/socially-mobile/socially-mobile.js       | 1 -
 3 files changed, 10 deletions(-)
 delete mode 100644 packages/socially-mobile/socially-mobile-tests.js
 delete mode 100644 packages/socially-mobile/socially-mobile.js

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 079cecc..fc1955a 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -12,13 +12,9 @@ Package.describe({
 
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
-  api.use('ecmascript');
-  api.addFiles('socially-mobile.js');
 });
 
 Package.onTest(function(api) {
-  api.use('ecmascript');
   api.use('tinytest');
   api.use('socially-mobile');
-  api.addFiles('socially-mobile-tests.js');
 });
diff --git a/packages/socially-mobile/socially-mobile-tests.js b/packages/socially-mobile/socially-mobile-tests.js
deleted file mode 100644
index c5623d8..0000000
--- a/packages/socially-mobile/socially-mobile-tests.js
+++ /dev/null
@@ -1,5 +0,0 @@
-// Write your tests here!
-// Here is an example.
-Tinytest.add('example', function (test) {
-  test.equal(true, true);
-});
diff --git a/packages/socially-mobile/socially-mobile.js b/packages/socially-mobile/socially-mobile.js
deleted file mode 100644
index 164ddd9..0000000
--- a/packages/socially-mobile/socially-mobile.js
+++ /dev/null
@@ -1 +0,0 @@
-// Write your package code here!
-- 
2.3.2 (Apple Git-55)


From 54de099918925f3dea9a58739d87ffe4f567f953 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:13:43 +0200
Subject: [PATCH 213/244] Step 21.4: Add dependency for angular

---
 packages/socially-mobile/package.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index fc1955a..c185b97 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -12,6 +12,7 @@ Package.describe({
 
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
+  api.use('angular');
 });
 
 Package.onTest(function(api) {
-- 
2.3.2 (Apple Git-55)


From f73096b70051ca93665c33c7012f0d2c8db07fc8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:14:19 +0200
Subject: [PATCH 214/244] Step 21.5: Create the angular module for the mobile
 package

---
 packages/socially-mobile/client/lib/module.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-mobile/client/lib/module.js

diff --git a/packages/socially-mobile/client/lib/module.js b/packages/socially-mobile/client/lib/module.js
new file mode 100644
index 0000000..f078654
--- /dev/null
+++ b/packages/socially-mobile/client/lib/module.js
@@ -0,0 +1 @@
+angular.module('socially.mobile', []);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 71677f6c0068034c9fab9bc22cc204c63d1719c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:17:15 +0200
Subject: [PATCH 215/244] Step 21.6: Create the login component

---
 packages/socially-mobile/client/auth/login/login.component.js | 10 ++++++++++
 1 file changed, 10 insertions(+)
 create mode 100644 packages/socially-mobile/client/auth/login/login.component.js

diff --git a/packages/socially-mobile/client/auth/login/login.component.js b/packages/socially-mobile/client/auth/login/login.component.js
new file mode 100644
index 0000000..7a2127e
--- /dev/null
+++ b/packages/socially-mobile/client/auth/login/login.component.js
@@ -0,0 +1,10 @@
+angular.module("socially.mobile").directive('login', function() {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/auth/login/login.html',
+    controllerAs: 'login',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From bf88997bb89fe1a565a0c4932d939fbc48a1d326 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:17:39 +0200
Subject: [PATCH 216/244] Step 21.7: Create the login component view

---
 packages/socially-mobile/client/auth/login/login.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 packages/socially-mobile/client/auth/login/login.html

diff --git a/packages/socially-mobile/client/auth/login/login.html b/packages/socially-mobile/client/auth/login/login.html
new file mode 100644
index 0000000..9fac81a
--- /dev/null
+++ b/packages/socially-mobile/client/auth/login/login.html
@@ -0,0 +1 @@
+Some temp html :)
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 9ab60c605d6c72d449e20f396aba21335791acf3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:17:50 +0200
Subject: [PATCH 217/244] Step 21.8: Update package.js with the new file

---
 packages/socially-mobile/package.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index c185b97..56df1f5 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -13,6 +13,12 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('angular');
+
+  api.addFiles([
+    'client/lib/module.js',
+    'client/auth/login/login.component.js',
+    'client/auth/login/login.html'
+  ], 'client');
 });
 
 Package.onTest(function(api) {
-- 
2.3.2 (Apple Git-55)


From 70cf7bec5f10033dfb3f8d8befa9969dd52e5f36 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:19:48 +0200
Subject: [PATCH 218/244] Step 21.9: Add modules isolation

---
 client/lib/app.js | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/client/lib/app.js b/client/lib/app.js
index 1e6949b..5fec315 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -1,4 +1,4 @@
-angular.module('socially', [
+let modulesToLoad =  [
   'angular-meteor',
   'ui.router',
   'accounts.ui',
@@ -9,7 +9,13 @@ angular.module('socially', [
   'ngImgCrop',
   'xeditable',
   'angular-sortable-view'
-]);
+];
+
+if (Meteor.isCordova) {
+  modulesToLoad = modulesToLoad.concat(['socially.mobile']);
+}
+
+angular.module('socially', modulesToLoad);
 
 angular.module('socially').config(($mdIconProvider) => {
   $mdIconProvider
-- 
2.3.2 (Apple Git-55)


From f8322a497209e89c08af790a2aa04da73fd23de0 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:20:24 +0200
Subject: [PATCH 219/244] Step 21.10: Add the socially browser package loading

---
 client/lib/app.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/lib/app.js b/client/lib/app.js
index 5fec315..b4488fb 100644
--- a/client/lib/app.js
+++ b/client/lib/app.js
@@ -14,6 +14,9 @@ let modulesToLoad =  [
 if (Meteor.isCordova) {
   modulesToLoad = modulesToLoad.concat(['socially.mobile']);
 }
+else {
+  modulesToLoad = modulesToLoad.concat(['socially.browser']);
+}
 
 angular.module('socially', modulesToLoad);
 
-- 
2.3.2 (Apple Git-55)


From 5f0f48201bd70c47c97b093ae21fda15d6ae45c8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:25:16 +0200
Subject: [PATCH 220/244] Step 21.11: Create socially-browser package

---
 packages/socially-browser/README.md                |  0
 .../client/auth/login/login.component.js           | 10 ++++++++
 .../socially-browser/client/auth/login/login.html  |  1 +
 packages/socially-browser/client/lib/module.js     |  1 +
 packages/socially-browser/package.js               | 27 ++++++++++++++++++++++
 5 files changed, 39 insertions(+)
 create mode 100644 packages/socially-browser/README.md
 create mode 100644 packages/socially-browser/client/auth/login/login.component.js
 create mode 100644 packages/socially-browser/client/auth/login/login.html
 create mode 100644 packages/socially-browser/client/lib/module.js
 create mode 100644 packages/socially-browser/package.js

diff --git a/packages/socially-browser/README.md b/packages/socially-browser/README.md
new file mode 100644
index 0000000..e69de29
diff --git a/packages/socially-browser/client/auth/login/login.component.js b/packages/socially-browser/client/auth/login/login.component.js
new file mode 100644
index 0000000..dc7153b
--- /dev/null
+++ b/packages/socially-browser/client/auth/login/login.component.js
@@ -0,0 +1,10 @@
+angular.module("socially.browser").directive('login', function() {
+  return {
+    restrict: 'E',
+    templateUrl: 'client/auth/login/login.html',
+    controllerAs: 'login',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/auth/login/login.html b/packages/socially-browser/client/auth/login/login.html
new file mode 100644
index 0000000..aa99eeb
--- /dev/null
+++ b/packages/socially-browser/client/auth/login/login.html
@@ -0,0 +1 @@
+Browser login
\ No newline at end of file
diff --git a/packages/socially-browser/client/lib/module.js b/packages/socially-browser/client/lib/module.js
new file mode 100644
index 0000000..b0d348f
--- /dev/null
+++ b/packages/socially-browser/client/lib/module.js
@@ -0,0 +1 @@
+angular.module('socially.browser', []);
\ No newline at end of file
diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
new file mode 100644
index 0000000..50d5df4
--- /dev/null
+++ b/packages/socially-browser/package.js
@@ -0,0 +1,27 @@
+Package.describe({
+  name: 'socially-browser',
+  version: '0.0.1',
+  // Brief, one-line summary of the package.
+  summary: '',
+  // URL to the Git repository containing the source code for this package.
+  git: '',
+  // By default, Meteor will default to using README.md for documentation.
+  // To avoid submitting documentation, set this field to null.
+  documentation: 'README.md'
+});
+
+Package.onUse(function(api) {
+  api.versionsFrom('1.2.1');
+  api.use('angular');
+
+  api.addFiles([
+    'client/lib/module.js',
+    'client/auth/login/login.component.js',
+    'client/auth/login/login.html'
+  ], 'client');
+});
+
+Package.onTest(function(api) {
+  api.use('tinytest');
+  api.use('socially-mobile');
+});
-- 
2.3.2 (Apple Git-55)


From 3cc196aa48d529d450e3d99f637115126604485d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:25:26 +0200
Subject: [PATCH 221/244] Step 21.12: Add the packges to the root project

---
 .meteor/packages | 2 ++
 .meteor/versions | 2 ++
 2 files changed, 4 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 8502fde..7c373d8 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -36,3 +36,5 @@ alexk111:ng-img-crop
 vitalets:angular-xeditable
 netanelgilad:angular-sortable-view
 cfs:graphicsmagick
+socially-browser
+socially-mobile
diff --git a/.meteor/versions b/.meteor/versions
index 2a107c0..85916b6 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -110,6 +110,8 @@ routepolicy@1.0.6
 service-configuration@1.0.5
 session@1.1.1
 sha@1.0.4
+socially-browser@0.0.1
+socially-mobile@0.0.1
 spacebars@1.0.7
 spacebars-compiler@1.0.7
 srp@1.0.4
-- 
2.3.2 (Apple Git-55)


From af9d8681fb69b117627b0a66d50ac52517d3a6db Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:40:26 +0200
Subject: [PATCH 222/244] Step 21.13: Implement the actual browser login
 component

---
 .../client/auth/login/login.component.js             | 20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/client/auth/login/login.component.js b/packages/socially-browser/client/auth/login/login.component.js
index dc7153b..ac29504 100644
--- a/packages/socially-browser/client/auth/login/login.component.js
+++ b/packages/socially-browser/client/auth/login/login.component.js
@@ -1,10 +1,28 @@
 angular.module("socially.browser").directive('login', function() {
   return {
     restrict: 'E',
-    templateUrl: 'client/auth/login/login.html',
+    templateUrl: '/packages/socially-browser/client/auth/login/login.html',
     controllerAs: 'login',
     controller: function ($scope, $reactive, $state) {
       $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: '',
+        password: ''
+      };
+
+      this.error = '';
+
+      this.login = () => {
+        Meteor.loginWithPassword(this.credentials.email, this.credentials.password, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From cd753a014e70e4b26915e327e1f8c82de4c951ec Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:40:34 +0200
Subject: [PATCH 223/244] Step 21.14: Implement the actual browser login
 component view

---
 .../socially-browser/client/auth/login/login.html  | 63 +++++++++++++++++++++-
 1 file changed, 62 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/client/auth/login/login.html b/packages/socially-browser/client/auth/login/login.html
index aa99eeb..9b3c7d1 100644
--- a/packages/socially-browser/client/auth/login/login.html
+++ b/packages/socially-browser/client/auth/login/login.html
@@ -1 +1,62 @@
-Browser login
\ No newline at end of file
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Sign in </h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Use existing account</p>
+      </div>
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-divider class="inset"></md-divider>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Sign in with your email</p>
+      </div>
+
+      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container>
+          <label> Password </label>
+          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="space-between center">
+          <a class="md-button" href="/resetpw">Forgot password?</a>
+          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login"
+                     ng-disabled="login.loginForm.$invalid()">Sign In
+          </md-button>
+        </div>
+      </form>
+      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ login.error }}</p>
+      </md-toolbar>
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/register">Need an account?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From d4553ccebabff3f614eff414b6d6b6340c260e47 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:40:48 +0200
Subject: [PATCH 224/244] Step 21.15: Remove the old login component from the
 root project

---
 client/auth/login/login.component.js | 28 ----------------
 client/auth/login/login.html         | 62 ------------------------------------
 2 files changed, 90 deletions(-)
 delete mode 100644 client/auth/login/login.component.js
 delete mode 100644 client/auth/login/login.html

diff --git a/client/auth/login/login.component.js b/client/auth/login/login.component.js
deleted file mode 100644
index 7ee375b..0000000
--- a/client/auth/login/login.component.js
+++ /dev/null
@@ -1,28 +0,0 @@
-angular.module("socially").directive('login', function() {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/auth/login/login.html',
-    controllerAs: 'login',
-    controller: function ($scope, $reactive, $state) {
-      $reactive(this).attach($scope);
-
-      this.credentials = {
-        email: '',
-        password: ''
-      };
-
-      this.error = '';
-
-      this.login = () => {
-        Meteor.loginWithPassword(this.credentials.email, this.credentials.password, (err) => {
-          if (err) {
-            this.error = err;
-          }
-          else {
-            $state.go('parties');
-          }
-        });
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/auth/login/login.html b/client/auth/login/login.html
deleted file mode 100644
index 9b3c7d1..0000000
--- a/client/auth/login/login.html
+++ /dev/null
@@ -1,62 +0,0 @@
-<md-content layout="row" layout-align="center start" layout-fill layout-margin>
-
-  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-
-    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
-      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
-        <h3 class="md-display-1"> Sign in </h3>
-      </div>
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Use existing account</p>
-      </div>
-      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
-          <span> Google</span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
-          <span>Facebook </span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
-          <span>Twitter </span>
-        </md-button>
-      </div>
-      <md-divider class="inset"></md-divider>
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Sign in with your email</p>
-      </div>
-
-      <form name="loginForm" layout="column" layout-fill layout-padding layout-margin>
-        <md-input-container>
-          <label> Email </label>
-          <input type="text" ng-model="login.credentials.email" aria-label="email" required/>
-        </md-input-container>
-        <md-input-container>
-          <label> Password </label>
-          <input type="password" ng-model="login.credentials.password" aria-label="password" required/>
-        </md-input-container>
-        <div layout="row" layout-align="space-between center">
-          <a class="md-button" href="/resetpw">Forgot password?</a>
-          <md-button class="md-raised md-primary" ng-click="login.login()" aria-label="login"
-                     ng-disabled="login.loginForm.$invalid()">Sign In
-          </md-button>
-        </div>
-      </form>
-      <md-toolbar ng-show="login.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-        <p class="md-body-1">{{ login.error }}</p>
-      </md-toolbar>
-      <md-divider></md-divider>
-      <div layout="row" layout-align="center">
-        <a class="md-button" href="/register">Need an account?</a>
-      </div>
-
-    </div>
-
-  </md-whiteframe>
-</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 19fcf7e0ddcc44ee382050cbb19d7b2405078ccd Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 13:26:59 +0200
Subject: [PATCH 225/244] Step 21.16: Add okland:accounts-phone package

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7c373d8..e51480d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -38,3 +38,4 @@ netanelgilad:angular-sortable-view
 cfs:graphicsmagick
 socially-browser
 socially-mobile
+okland:accounts-phone
diff --git a/.meteor/versions b/.meteor/versions
index 85916b6..2b69ad3 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -95,6 +95,7 @@ oauth@1.1.6
 oauth1@1.1.5
 oauth2@1.1.5
 observe-sequence@1.0.7
+okland:accounts-phone@0.0.21
 ordered-dict@1.0.4
 pbastowski:angular-babel@1.0.6
 planettraining:material-design-icons@2.0.0
-- 
2.3.2 (Apple Git-55)


From 1fc1df444ce27963f1f022a04635cee9cee64743 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:47:36 +0200
Subject: [PATCH 226/244] Step 21.17: Implement the mobile login component

---
 .../client/auth/login/login.component.js           | 23 +++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/auth/login/login.component.js b/packages/socially-mobile/client/auth/login/login.component.js
index 7a2127e..77510fb 100644
--- a/packages/socially-mobile/client/auth/login/login.component.js
+++ b/packages/socially-mobile/client/auth/login/login.component.js
@@ -1,10 +1,31 @@
 angular.module("socially.mobile").directive('login', function() {
   return {
     restrict: 'E',
-    templateUrl: 'client/auth/login/login.html',
+    templateUrl: '/packages/socially-mobile/client/auth/login/login.html',
     controllerAs: 'login',
     controller: function ($scope, $reactive, $state) {
       $reactive(this).attach($scope);
+
+      this.isStepTwo = false;
+      this.phoneNumber = '';
+      this.verificationCode = '';
+      this.error = '';
+
+      this.verifyPhone = () => {
+        Accounts.requestPhoneVerification(this.phoneNumber);
+        this.isStepTwo = true;
+      };
+
+      this.verifyCode = () => {
+        Accounts.verifyPhone(this.phoneNumber, this.verificationCode, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      }
     }
   }
 });
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b526187e5951afed35f81089c229242a4b4225c7 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Wed, 2 Dec 2015 23:47:44 +0200
Subject: [PATCH 227/244] Step 21.18: Implement the mobile login component view

---
 .../socially-mobile/client/auth/login/login.html   | 34 +++++++++++++++++++++-
 1 file changed, 33 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/auth/login/login.html b/packages/socially-mobile/client/auth/login/login.html
index 9fac81a..0f04865 100644
--- a/packages/socially-mobile/client/auth/login/login.html
+++ b/packages/socially-mobile/client/auth/login/login.html
@@ -1 +1,33 @@
-Some temp html :)
\ No newline at end of file
+<md-content layout="row">
+  <span flex></span>
+  <md-whiteframe layout="column" flex="50">
+    <div layout="row" layout-align="space-around center">
+      <div>Login with SMS</div>
+    </div>
+    <div ng-show="login.error" class="md-warn">
+      <small>{{ login.error }}</small>
+    </div>
+    <form layout="column" ng-show="login.isStepTwo">
+      <md-input-container>
+        <input type="text" ng-model="login.verificationCode"
+               placeholder="code"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="login.verifyCode()"
+                 aria-label="login">Verify Code
+      </md-button>
+    </form>
+    <form layout="column" ng-show="!login.isStepTwo">
+      <md-input-container>
+        <input type="text" ng-model="login.phoneNumber"
+               placeholder="phone"/>
+      </md-input-container>
+      <md-button class="md-raised md-primary" ng-click="login.verifyPhone()"
+                 aria-label="login">Send SMS
+      </md-button>
+    </form>
+    <div layout="row" layout-align="space-around center">
+      <a href="/resetpw">Forgot password?</a>
+    </div>
+  </md-whiteframe>
+  <span flex></span>
+</md-content>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From b7ee11376c147815b6b15056e2ab7a3129772c56 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 13:58:04 +0200
Subject: [PATCH 228/244] Step 22.1: Move the socially directive to the browser
 package

---
 client/socially/socially.component.js              | 23 ----------------------
 client/socially/socially.html                      | 13 ------------
 .../client/socially/socially.component.js          | 23 ++++++++++++++++++++++
 .../socially-browser/client/socially/socially.html | 13 ++++++++++++
 4 files changed, 36 insertions(+), 36 deletions(-)
 delete mode 100644 client/socially/socially.component.js
 delete mode 100644 client/socially/socially.html
 create mode 100644 packages/socially-browser/client/socially/socially.component.js
 create mode 100644 packages/socially-browser/client/socially/socially.html

diff --git a/client/socially/socially.component.js b/client/socially/socially.component.js
deleted file mode 100644
index d3e7c60..0000000
--- a/client/socially/socially.component.js
+++ /dev/null
@@ -1,23 +0,0 @@
-angular.module('socially').directive('socially', function () {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/socially/socially.html',
-    controllerAs: 'socially',
-    controller: function ($scope, $reactive) {
-      $reactive(this).attach($scope);
-
-      this.helpers({
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUser: () => {
-          return Meteor.user();
-        }
-      });
-
-      this.logout = () => {
-        Accounts.logout();
-      }
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/socially/socially.html b/client/socially/socially.html
deleted file mode 100644
index 2cfe056..0000000
--- a/client/socially/socially.html
+++ /dev/null
@@ -1,13 +0,0 @@
-<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
-  <h2>
-    <a ui-sref="parties"><span class="md-title">Socially</span></a>
-  </h2>
-  <span flex></span>
-  <div class="navbar-right navbar-text">
-    <md-button ng-href="/login" ng-hide="socially.isLoggedIn">Login</md-button>
-    <md-button ng-href="/register" ng-hide="socially.isLoggedIn">Sign up</md-button>
-    <div ng-show="socially.isLoggedIn">{{ socially.currentUser | displayName }}</div>
-    <md-button ng-click="socially.logout()" ng-show="socially.isLoggedIn">Logout</md-button>
-  </div>
-</md-toolbar>
-<div ui-view flex-gt-sm layout-gt-sm="row"></div>
\ No newline at end of file
diff --git a/packages/socially-browser/client/socially/socially.component.js b/packages/socially-browser/client/socially/socially.component.js
new file mode 100644
index 0000000..a77e445
--- /dev/null
+++ b/packages/socially-browser/client/socially/socially.component.js
@@ -0,0 +1,23 @@
+angular.module('socially.browser').directive('socially', function () {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/socially/socially.html',
+    controllerAs: 'socially',
+    controller: function ($scope, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUser: () => {
+          return Meteor.user();
+        }
+      });
+
+      this.logout = () => {
+        Accounts.logout();
+      }
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/socially/socially.html b/packages/socially-browser/client/socially/socially.html
new file mode 100644
index 0000000..2cfe056
--- /dev/null
+++ b/packages/socially-browser/client/socially/socially.html
@@ -0,0 +1,13 @@
+<md-toolbar md-scroll-shrink layout="row" layout-align="start center" layout-padding>
+  <h2>
+    <a ui-sref="parties"><span class="md-title">Socially</span></a>
+  </h2>
+  <span flex></span>
+  <div class="navbar-right navbar-text">
+    <md-button ng-href="/login" ng-hide="socially.isLoggedIn">Login</md-button>
+    <md-button ng-href="/register" ng-hide="socially.isLoggedIn">Sign up</md-button>
+    <div ng-show="socially.isLoggedIn">{{ socially.currentUser | displayName }}</div>
+    <md-button ng-click="socially.logout()" ng-show="socially.isLoggedIn">Logout</md-button>
+  </div>
+</md-toolbar>
+<div ui-view flex-gt-sm layout-gt-sm="row"></div>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 1dee4bae21ac3e1304862c2070622dbbaf7cdb30 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 13:58:39 +0200
Subject: [PATCH 229/244] Step 22.2: Update the package.js of the browser
 package

---
 packages/socially-browser/package.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 50d5df4..4093c55 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -17,7 +17,9 @@ Package.onUse(function(api) {
   api.addFiles([
     'client/lib/module.js',
     'client/auth/login/login.component.js',
-    'client/auth/login/login.html'
+    'client/auth/login/login.html',
+    'client/socially/socially.component.js',
+    'client/socially/socially.html'
   ], 'client');
 });
 
-- 
2.3.2 (Apple Git-55)


From fb1b898bcbf85c6d762cfd717e215d44799d9962 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:12:48 +0200
Subject: [PATCH 230/244] Step 22.3: Move all browser components to
 socially-browser package

---
 client/auth/register/register.component.js         |  28 ----
 client/auth/register/register.html                 |  63 -------
 .../reset-password/reset-password.component.js     |  27 ---
 client/auth/reset-password/reset-password.html     |  40 -----
 .../add-new-party-modal.component.js               |  69 --------
 .../add-new-party-modal/add-new-party-modal.html   |  68 --------
 .../add-new-party-modal.import.less                |  53 ------
 .../parties/parties-list/parties-list.component.js | 182 ---------------------
 client/parties/parties-list/parties-list.html      |  77 ---------
 .../parties/parties-list/parties-list.import.less  |  71 --------
 .../party-details/party-details.component.js       |  97 -----------
 client/parties/party-details/party-details.html    |  45 -----
 .../party-details/party-details.import.less        |  10 --
 client/parties/styles/google-maps.css              |   4 -
 client/styles/main.less                            |  15 --
 client/styles/navbar.import.less                   |   5 -
 .../client/auth/register/register.component.js     |  28 ++++
 .../client/auth/register/register.html             |  63 +++++++
 .../reset-password/reset-password.component.js     |  27 +++
 .../client/auth/reset-password/reset-password.html |  40 +++++
 .../add-new-party-modal.component.js               |  69 ++++++++
 .../add-new-party-modal/add-new-party-modal.html   |  68 ++++++++
 .../add-new-party-modal.import.less                |  53 ++++++
 .../parties/parties-list/parties-list.component.js | 182 +++++++++++++++++++++
 .../client/parties/parties-list/parties-list.html  |  77 +++++++++
 .../parties/parties-list/parties-list.import.less  |  71 ++++++++
 .../party-details/party-details.component.js       |  97 +++++++++++
 .../parties/party-details/party-details.html       |  45 +++++
 .../party-details/party-details.import.less        |  10 ++
 .../client/parties/styles/google-maps.css          |   4 +
 packages/socially-browser/client/styles/main.less  |  15 ++
 .../client/styles/navbar.import.less               |   5 +
 32 files changed, 854 insertions(+), 854 deletions(-)
 delete mode 100644 client/auth/register/register.component.js
 delete mode 100644 client/auth/register/register.html
 delete mode 100644 client/auth/reset-password/reset-password.component.js
 delete mode 100644 client/auth/reset-password/reset-password.html
 delete mode 100644 client/parties/add-new-party-modal/add-new-party-modal.component.js
 delete mode 100644 client/parties/add-new-party-modal/add-new-party-modal.html
 delete mode 100644 client/parties/add-new-party-modal/add-new-party-modal.import.less
 delete mode 100644 client/parties/parties-list/parties-list.component.js
 delete mode 100644 client/parties/parties-list/parties-list.html
 delete mode 100644 client/parties/parties-list/parties-list.import.less
 delete mode 100644 client/parties/party-details/party-details.component.js
 delete mode 100644 client/parties/party-details/party-details.html
 delete mode 100644 client/parties/party-details/party-details.import.less
 delete mode 100644 client/parties/styles/google-maps.css
 delete mode 100644 client/styles/main.less
 delete mode 100644 client/styles/navbar.import.less
 create mode 100644 packages/socially-browser/client/auth/register/register.component.js
 create mode 100644 packages/socially-browser/client/auth/register/register.html
 create mode 100644 packages/socially-browser/client/auth/reset-password/reset-password.component.js
 create mode 100644 packages/socially-browser/client/auth/reset-password/reset-password.html
 create mode 100644 packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.component.js
 create mode 100644 packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.html
 create mode 100644 packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.import.less
 create mode 100644 packages/socially-browser/client/parties/parties-list/parties-list.component.js
 create mode 100644 packages/socially-browser/client/parties/parties-list/parties-list.html
 create mode 100644 packages/socially-browser/client/parties/parties-list/parties-list.import.less
 create mode 100644 packages/socially-browser/client/parties/party-details/party-details.component.js
 create mode 100644 packages/socially-browser/client/parties/party-details/party-details.html
 create mode 100644 packages/socially-browser/client/parties/party-details/party-details.import.less
 create mode 100644 packages/socially-browser/client/parties/styles/google-maps.css
 create mode 100644 packages/socially-browser/client/styles/main.less
 create mode 100644 packages/socially-browser/client/styles/navbar.import.less

diff --git a/client/auth/register/register.component.js b/client/auth/register/register.component.js
deleted file mode 100644
index 54a884c..0000000
--- a/client/auth/register/register.component.js
+++ /dev/null
@@ -1,28 +0,0 @@
-angular.module("socially").directive('register', function() {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/auth/register/register.html',
-    controllerAs: 'register',
-    controller: function ($scope, $reactive, $state) {
-      $reactive(this).attach($scope);
-
-      this.credentials = {
-        email: '',
-        password: ''
-      };
-
-      this.error = '';
-
-      this.register = () => {
-        Accounts.createUser(this.credentials, (err) => {
-          if (err) {
-            this.error = err;
-          }
-          else {
-            $state.go('parties');
-          }
-        });
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/auth/register/register.html b/client/auth/register/register.html
deleted file mode 100644
index 8100629..0000000
--- a/client/auth/register/register.html
+++ /dev/null
@@ -1,63 +0,0 @@
-<md-content layout="row" layout-align="center start" layout-fill layout-margin>
-  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-
-    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
-      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
-        <h3 class="md-display-1"> Register a new account</h3>
-      </div>
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2">Use your email?</p>
-      </div>
-
-      <form name="registerForm" layout="column" layout-fill layout-padding layout-margin>
-        <md-input-container >
-          <label> Email </label>
-          <input type="text" ng-model="register.credentials.email" placeholder="email" aria-label="email" required/>
-        </md-input-container>
-        <md-input-container >
-          <label> Password </label>
-          <input type="password" ng-model="register.credentials.password" placeholder="password" aria-label="password" required/>
-        </md-input-container>
-        <div layout="row" layout-align="end center">
-          <md-button class="md-raised md-primary" ng-click="register.register()" aria-label="login" ng-disabled="register.registerForm.$invalid()">Register</md-button>
-        </div>
-      </form>
-
-      <md-divider class="inset"></md-divider>
-
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2"> Want to use an existing account? </p>
-      </div>
-
-      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
-          <span> Google</span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
-          <span>Facebook </span>
-        </md-button>
-        <md-button class="md-raised">
-          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
-          <span>Twitter </span>
-        </md-button>
-      </div>
-      <md-toolbar ng-show="register.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-        <p class="md-body-1">{{ register.error }}</p>
-      </md-toolbar>
-
-      <md-divider></md-divider>
-      <div layout="row" layout-align="center">
-        <a class="md-button" href="/login">Already a user?</a>
-      </div>
-
-    </div>
-
-  </md-whiteframe>
-</md-content>
\ No newline at end of file
diff --git a/client/auth/reset-password/reset-password.component.js b/client/auth/reset-password/reset-password.component.js
deleted file mode 100644
index 241ae8a..0000000
--- a/client/auth/reset-password/reset-password.component.js
+++ /dev/null
@@ -1,27 +0,0 @@
-angular.module("socially").directive('resetpw', function() {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/auth/reset-password/reset-password.html',
-    controllerAs: 'resetpw',
-    controller: function ($scope, $reactive, $state) {
-      $reactive(this).attach($scope);
-
-      this.credentials = {
-        email: ''
-      };
-
-      this.error = '';
-
-      this.reset = () => {
-        Accounts.forgotPassword(this.credentials, (err) => {
-          if (err) {
-            this.error = err;
-          }
-          else {
-            $state.go('parties');
-          }
-        });
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/auth/reset-password/reset-password.html b/client/auth/reset-password/reset-password.html
deleted file mode 100644
index 138ecf4..0000000
--- a/client/auth/reset-password/reset-password.html
+++ /dev/null
@@ -1,40 +0,0 @@
-<md-content layout="row" layout-align="center start" layout-fill layout-margin>
-  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
-
-    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
-      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
-        <h3 class="md-display-1"> Reset Password</h3>
-      </div>
-    </md-toolbar>
-
-    <div layout="column" layout-fill layout-margin layout-padding>
-
-      <div layout="row" layout-fill layout-margin>
-        <p class="md-body-2">Enter your email so we can send you a reset link</p>
-      </div>
-
-      <form name="resetForm" layout="column" layout-fill layout-padding layout-margin>
-        <md-input-container>
-          <label> Email </label>
-          <input type="text" ng-model="resetpw.credentials.email" placeholder="email" aria-label="email" required/>
-        </md-input-container>
-        <div layout="row" layout-align="end center">
-          <md-button class="md-raised md-primary" ng-click="resetpw.reset()" aria-label="reset"
-                     ng-disabled="resetpw.resetForm.$invalid()">Send Email
-          </md-button>
-        </div>
-      </form>
-
-      <md-toolbar ng-show="resetpw.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
-        <p class="md-body-1">{{ resetpw.error }}</p>
-      </md-toolbar>
-
-      <md-divider></md-divider>
-      <div layout="row" layout-align="center">
-        <a class="md-button" href="/login">Sign in</a>
-      </div>
-
-    </div>
-
-  </md-whiteframe>
-</md-content>
\ No newline at end of file
diff --git a/client/parties/add-new-party-modal/add-new-party-modal.component.js b/client/parties/add-new-party-modal/add-new-party-modal.component.js
deleted file mode 100644
index 2a8809b..0000000
--- a/client/parties/add-new-party-modal/add-new-party-modal.component.js
+++ /dev/null
@@ -1,69 +0,0 @@
-angular.module('socially').directive('addNewPartyModal', function () {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/parties/add-new-party-modal/add-new-party-modal.html',
-    controllerAs: 'addNewPartyModal',
-    controller: function ($scope, $stateParams, $reactive, $mdDialog) {
-      $reactive(this).attach($scope);
-
-      this.helpers({
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        }
-      });
-
-      this.newParty = {};
-
-      this.addNewParty = () => {
-        this.newParty.owner = Meteor.userId();
-        this.newParty.images = this.newParty.images.map((image) => {
-          return image._id;
-        });
-
-        Parties.insert(this.newParty);
-        this.newParty = {};
-        $mdDialog.hide();
-      };
-
-      this.close = () => {
-        $mdDialog.hide();
-      };
-
-      this.addImages = (files) => {
-        if (files.length > 0) {
-          let reader = new FileReader();
-
-          reader.onload = (e) => {
-            $scope.$apply(() => {
-              this.cropImgSrc = e.target.result;
-              this.myCroppedImage = '';
-            });
-          };
-
-          reader.readAsDataURL(files[0]);
-        }
-        else {
-          this.cropImgSrc = undefined;
-        }
-      };
-
-      this.saveCroppedImage = () => {
-        if (this.myCroppedImage !== '') {
-          Images.insert(this.myCroppedImage, (err, fileObj) => {
-            if (!this.newParty.images) {
-              this.newParty.images = [];
-            }
-
-            this.newParty.images.push(fileObj);
-            this.cropImgSrc = undefined;
-            this.myCroppedImage = '';
-          });
-        }
-      };
-
-      this.updateDescription = ($data, image) => {
-        Images.update({_id: image._id}, {$set: {'metadata.description': $data}});
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/parties/add-new-party-modal/add-new-party-modal.html b/client/parties/add-new-party-modal/add-new-party-modal.html
deleted file mode 100644
index 299d8ba..0000000
--- a/client/parties/add-new-party-modal/add-new-party-modal.html
+++ /dev/null
@@ -1,68 +0,0 @@
-<md-dialog style="min-width: 600px;">
-  <div>
-    <md-toolbar>
-      <div class="md-toolbar-tools">
-        <h2> Create a new party</h2>
-        <span flex></span>
-      </div>
-    </md-toolbar>
-    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
-      <div ng-show="addNewPartyModal.isLoggedIn">
-        <md-input-container>
-          <label>Name</label>
-          <input ng-model="addNewPartyModal.newParty.name" id="nameInput" type="text" aria-label="Name">
-        </md-input-container>
-        <md-input-container>
-          <label>Description</label>
-          <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" aria-label="Description">
-        </md-input-container>
-        <md-whiteframe class="md-whiteframe-z1" layout="column">
-          <div layout="row" class="images-container-title">
-            <div flex>
-              <h3>Add photos to your party!</h3>
-                <div ng-hide="addNewPartyModal.cropImgSrc" ngf-drop ngf-select
-                     ngf-change="addNewPartyModal.addImages($files)"
-                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
-                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
-                     ngf-drop-available="true">
-                  <div>Click here to select image</div>
-                  <div>
-                    <strong>OR</strong>
-                  </div>
-                  You can also drop image to here
-                </div>
-              <div ng-show="addNewPartyModal.cropImgSrc" class="ng-crop-container">
-                <h3>Great! Now edit & crop your image...</h3>
-                <md-button ng-click="addNewPartyModal.saveCroppedImage()" ng-disabled="!addNewPartyModal.cropImgSrc" class="md-primary">
-                  Save Image
-                </md-button>
-                <img-crop image="addNewPartyModal.cropImgSrc" result-image="addNewPartyModal.myCroppedImage" area-type="square"></img-crop>
-              </div>
-            </div>
-          </div>
-          <br />
-          <div layout="row" class="images-container-title" sv-root sv-part="addNewPartyModal.newParty.images">
-            <div sv-element class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
-              <div class="main-image" ng-show="$index === 0">Main Image</div>
-              <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
-              <a href="#" editable-text="image.metadata.description"
-                 onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
-            </div>
-          </div>
-        </md-whiteframe>
-        <md-checkbox ng-model="addNewPartyModal.newParty.public" id="public" aria-label="Public">
-          Public
-        </md-checkbox>
-      </div>
-    </md-dialog-content>
-    <div class="md-actions" layout="row">
-      <span flex></span>
-      <md-button ng-click="addNewPartyModal.close()">
-        Close
-      </md-button>
-      <md-button ng-click="addNewPartyModal.addNewParty()" style="margin-right:20px;">
-        Add
-      </md-button>
-    </div>
-  </div>
-</md-dialog>
\ No newline at end of file
diff --git a/client/parties/add-new-party-modal/add-new-party-modal.import.less b/client/parties/add-new-party-modal/add-new-party-modal.import.less
deleted file mode 100644
index b609f03..0000000
--- a/client/parties/add-new-party-modal/add-new-party-modal.import.less
+++ /dev/null
@@ -1,53 +0,0 @@
-.drop-box {
-  background: #F8F8F8;
-  border: 5px dashed #DDD;
-  width: 230px;
-  height: 120px;
-  text-align: center;
-  padding-top: 25px;
-  margin-left: 10px;
-  margin-bottom: 20px;
-}
-
-.drop-box.dragover {
-  border: 5px dashed blue;
-}
-
-.drop-box.dragover-err {
-  border: 5px dashed red;
-}
-
-.uploaded-image {
-  max-height: 100px;
-  max-width: 200px;
-}
-
-.ng-crop-container {
-  height: 400px;
-}
-
-
-.images-container-title {
-  padding-bottom: 30px;
-}
-
-.party-image-container {
-  position: relative;
-  margin-right: 10px;
-  max-height: 200px;
-  max-width: 200px;
-
-  img {
-    max-height: 100%;
-    max-width: 100%;
-  }
-}
-
-.main-image {
-  position: absolute;
-  top: 0;
-  left: 0;
-  width: 100%;
-  text-align: center;
-  background-color: #f8f8f8;
-}
\ No newline at end of file
diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
deleted file mode 100644
index f9d5795..0000000
--- a/client/parties/parties-list/parties-list.component.js
+++ /dev/null
@@ -1,182 +0,0 @@
-angular.module('socially').directive('partiesList', function () {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/parties/parties-list/parties-list.html',
-    controllerAs: 'partiesList',
-    controller: function ($scope, $reactive, $mdDialog, $filter) {
-      $reactive(this).attach($scope);
-
-      this.perPage = 3;
-      this.orderProperty = '1';
-
-      this.helpers({
-        parties: () => {
-          return Parties.find({}, {sort: this.sort});
-        },
-        users: () => {
-          return Meteor.users.find({});
-        },
-        partiesCount: () => {
-          return Counts.get('numberOfParties');
-        },
-        page: 1,
-        sort: {
-          name: 1
-        },
-        searchText: '',
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUserId: () => {
-          return Meteor.userId();
-        },
-        images: () => {
-          return Images.find({});
-        }
-      });
-
-      this.subscribe('images');
-
-      this.map = {
-        center: {
-          latitude: 45,
-          longitude: -73
-        },
-        options: {
-          maxZoom: 10,
-          styles: [{
-            "featureType": "administrative",
-            "elementType": "labels.text.fill",
-            "stylers": [{"color": "#444444"}]
-          }, {
-            "featureType": "landscape",
-            "elementType": "all",
-            "stylers": [{"color": "#f2f2f2"}]
-          }, {
-            "featureType": "poi",
-            "elementType": "all",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "road",
-            "elementType": "all",
-            "stylers": [{"saturation": -100}, {"lightness": 45}]
-          }, {
-            "featureType": "road.highway",
-            "elementType": "all",
-            "stylers": [{"visibility": "simplified"}]
-          }, {
-            "featureType": "road.arterial",
-            "elementType": "labels.icon",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "transit",
-            "elementType": "all",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "water",
-            "elementType": "all",
-            "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
-          }]
-        },
-        zoom: 8
-      };
-
-      this.subscribe('users');
-
-      this.subscribe('parties', () => {
-        return [
-          {
-            limit: parseInt(this.perPage),
-            skip: parseInt((this.page - 1) * this.perPage),
-            sort: this.sort
-          },
-          this.searchText
-        ]
-      });
-
-      this.removeParty = (party) => {
-        Parties.remove({_id: party._id});
-      };
-
-      this.pageChanged = (newPage) => {
-        this.page = newPage;
-      };
-
-      this.updateSort = () => {
-        this.sort = {
-          name: parseInt(this.orderProperty)
-        }
-      };
-
-      this.getPartyCreator = function (party) {
-        if (!party) {
-          return '';
-        }
-
-        let owner = Meteor.users.findOne(party.owner);
-
-        if (!owner) {
-          return 'nobody';
-        }
-
-        if (Meteor.userId() !== null && owner._id === Meteor.userId()) {
-          return 'me';
-        }
-
-        return owner;
-      };
-
-      this.rsvp = (partyId, rsvp) => {
-        Meteor.call('rsvp', partyId, rsvp, (error) => {
-          if (error) {
-            console.log('Oops, unable to rsvp!');
-          }
-          else {
-            console.log('RSVP Done!');
-          }
-        });
-      };
-
-      this.getUserById = (userId) => {
-        return Meteor.users.findOne(userId);
-      };
-
-      this.outstandingInvitations = (party) => {
-        return _.filter(this.users, (user) => {
-          return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
-        });
-      };
-
-      this.openAddNewPartyModal = function () {
-        $mdDialog.show({
-          template: '<add-new-party-modal></add-new-party-modal>',
-          clickOutsideToClose: true
-        });
-      };
-
-      this.isRSVP = (rsvp, party) => {
-        if (Meteor.userId() == null) {
-          return false;
-        }
-
-        let rsvpIndex = party.myRsvpIndex;
-        rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), Meteor.userId());
-
-        if (rsvpIndex !== -1) {
-          party.myRsvpIndex = rsvpIndex;
-          return party.rsvps[rsvpIndex].rsvp === rsvp;
-        }
-      };
-
-      this.getMainImage = (images) => {
-        if (images && images.length && images[0] && images[0]) {
-          var url = $filter('filter')(this.images, {_id: images[0]})[0].url();
-
-          return {
-            'background-image': 'url("' + url + '")'
-          }
-        }
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/parties/parties-list/parties-list.html b/client/parties/parties-list/parties-list.html
deleted file mode 100644
index 15ca915..0000000
--- a/client/parties/parties-list/parties-list.html
+++ /dev/null
@@ -1,77 +0,0 @@
-<md-content flex layout="row" class="ma-parties-list">
-  <div layout="row" flex>
-    <div flex="50">
-      <div>
-        <div layout-padding layout="row">
-          <md-input-container style="width:50%;margin-right:10px;">
-            <label>Search</label>
-            <input type="text" ng-model="partiesList.searchText" placeholder="Search">
-          </md-input-container>
-          <md-select ng-model="partiesList.orderProperty" placeholder="Sort Order" md-on-close="partiesList.updateSort()">
-            <md-option value="1">Ascending</md-option>
-            <md-option value="-1">Descending</md-option>
-          </md-select>
-          <md-button ng-show="partiesList.isLoggedIn" class="md-fab" ng-click="partiesList.openAddNewPartyModal()">
-            <md-icon md-font-set="material-icons"> add </md-icon>
-          </md-button>
-        </div>
-      </div>
-      <md-content class="md-padding" style="padding-top:0;">
-        <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-        <div dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount" class="ma-party">
-          <md-card>
-            <div ng-if="party.images && party.images.length > 0"
-                 ng-style="partiesList.getMainImage(party.images)"
-                 class="party-image">
-            </div>
-            <md-card-content>
-              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
-              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
-              <div layout="row">
-                <div flex="1">
-                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
-                    <small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small>
-                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
-                  </p>
-
-                  <div ng-show="partiesList.isLoggedIn" class="md-actions" layout="row">
-                    <md-button ng-click="partiesList.rsvp(party._id, 'yes')">I'm going!</md-button>
-                    <md-button ng-click="partiesList.rsvp(party._id, 'maybe')">Maybe</md-button>
-                    <md-button ng-click="partiesList.rsvp(party._id, 'no')">No</md-button>
-                  </div>
-                </div>
-                <div  layout="row" layout-align="end end">
-                  <div ng-hide="partiesList.isLoggedIn" style="font-size:13px;margin-bottom:10px;">
-                    Sign in to RSVP for this party
-                  </div>
-                  <div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
-                      <div class="rsvps-title">Yes</div>
-                    </div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
-                      <div class="rsvps-title">Maybe</div>
-                    </div>
-                    <div class="rsvps-sum">
-                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
-                      <div class="rsvps-title">No</div>
-                    </div>
-                  </div>
-                </div>
-              </div>
-            </md-card-content>
-          </md-card>
-        </div>
-      </md-content>
-
-    </div>
-    <div flex="50" layout="row" style="min-height:300px;">
-      <ui-gmap-google-map options="partiesList.map.options" center="partiesList.map.center" zoom="partiesList.map.zoom" flex layout="row">
-        <ui-gmap-markers models="partiesList.parties" coords="'location'"
-                         fit="true" idkey="'_id'" doRebuildAll="true">
-        </ui-gmap-markers>
-      </ui-gmap-google-map>
-    </div>
-  </div>
-</md-content>
\ No newline at end of file
diff --git a/client/parties/parties-list/parties-list.import.less b/client/parties/parties-list/parties-list.import.less
deleted file mode 100644
index 3ce0188..0000000
--- a/client/parties/parties-list/parties-list.import.less
+++ /dev/null
@@ -1,71 +0,0 @@
-parties-list {
-  width: 100%;
-}
-
-.navbar-text {
-  margin-right: 0;
-}
-
-#login-dropdown-list.accounts-dialog {
-  right: 14px;
-  left: auto;
-}
-
-.search-form {
-  margin-bottom: 1em;
-}
-
-.ma-parties-list {
-  .angular-google-map {
-    box-sizing: border-box;
-    -webkit-flex: 1;
-    -ms-flex: 1;
-    flex: 1;
-    -webkit-flex-direction: row;
-    -ms-flex-direction: row;
-    flex-direction: row;
-    box-sizing: border-box;
-    display: -webkit-flex;
-    display: -moz-flex;
-    display: -ms-flexbox;
-    display: flex;
-  }
-
-  .angular-google-map-container {
-    box-sizing: border-box;
-    -webkit-flex: 1;
-    -ms-flex: 1;
-    flex: 1;
-  }
-
-  .rsvps-sum {
-    float: left;
-    width: 50px;
-    text-align: center;
-    .rsvps-amount {
-      font-size: 24px;
-    }
-    .rsvps-title {
-      font-size: 13px;
-      color: #aaa;
-    }
-  }
-
-  .ma-party {
-    .party-image {
-      background-size: cover;
-      width: 100%;
-      height: 200px;
-    }
-
-    .ma-name {
-      a {
-        text-decoration: none;
-        color: #333;
-      }
-    }
-    .ma-description {
-
-    }
-  }
-}
\ No newline at end of file
diff --git a/client/parties/party-details/party-details.component.js b/client/parties/party-details/party-details.component.js
deleted file mode 100644
index 1bf8eca..0000000
--- a/client/parties/party-details/party-details.component.js
+++ /dev/null
@@ -1,97 +0,0 @@
-angular.module('socially').directive('partyDetails', function () {
-  return {
-    restrict: 'E',
-    templateUrl: 'client/parties/party-details/party-details.html',
-    controllerAs: 'partyDetails',
-    controller: function ($scope, $stateParams, $reactive) {
-      $reactive(this).attach($scope);
-
-      this.subscribe('parties');
-      this.subscribe('users');
-
-      this.helpers({
-        party: () => {
-          return Parties.findOne({_id: $stateParams.partyId});
-        },
-        users: () => {
-          return Meteor.users.find({});
-        },
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUserId: () => {
-          return Meteor.userId();
-        }
-      });
-
-      this.map = {
-        center: {
-          latitude: 45,
-          longitude: -73
-        },
-        zoom: 8,
-        events: {
-          click: function (mapModel, eventName, originalEventArgs) {
-            if (!$scope.party)
-              return;
-
-            if (!$scope.party.location)
-              $scope.party.location = {};
-
-            $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
-            $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
-            //scope apply required because this event handler is outside of the angular domain
-            $scope.$apply();
-          }
-        },
-        marker: {
-          options: { draggable: true },
-          events: {
-            dragend: function (marker, eventName, args) {
-              if (!$scope.party.location)
-                $scope.party.location = {};
-
-              $scope.party.location.latitude = marker.getPosition().lat();
-              $scope.party.location.longitude = marker.getPosition().lng();
-            }
-          }
-        }
-      };
-
-      this.save = () => {
-        Parties.update({_id: $stateParams.partyId}, {
-          $set: {
-            name: this.party.name,
-            description: this.party.description,
-            'public': this.party.public
-          }
-        }, (error) => {
-          if (error) {
-            console.log('Oops, unable to update the party...');
-          }
-          else {
-            console.log('Done!');
-          }
-        });
-      };
-
-      this.invite = (user) => {
-        Meteor.call('invite', this.party._id, user._id, (error) => {
-          if (error) {
-            console.log('Oops, unable to invite!');
-          }
-          else {
-            console.log('Invited!');
-          }
-        });
-      };
-
-      this.canInvite = () => {
-        if (!this.party)
-          return false;
-
-        return !this.party.public && this.party.owner === Meteor.userId();
-      };
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/parties/party-details/party-details.html b/client/parties/party-details/party-details.html
deleted file mode 100644
index 4024a14..0000000
--- a/client/parties/party-details/party-details.html
+++ /dev/null
@@ -1,45 +0,0 @@
-<div layout="row" flex class="ma-party-details">
-  <div flex="33" offset="33">
-    <legend style="margin:20px 0;">
-      Here you will see and change the details of the party:
-    </legend>
-    <form layout="column">
-      <md-input-container>
-        <label>Party Name</label>
-        <input ng-model="partyDetails.party.name" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Name">
-      </md-input-container>
-      <md-input-container>
-        <label>Party Description</label>
-        <input ng-model="partyDetails.party.description" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Description">
-      </md-input-container>
-      <md-checkbox ng-model="partyDetails.party.public" ng-disabled="party.owner != partyDetails.currentUserId" aria-label="Public">
-        Is public
-      </md-checkbox>
-
-      <div layout="row" layout-align="left">
-        <md-button ng-show="party.owner == partyDetails.currentUserId" ng-click="partyDetails.save()">Save</md-button>
-        <md-button ng-href="/parties">Back</md-button>
-      </div>
-
-      <md-list ng-show="partyDetails.canInvite()">
-        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
-        <md-list-item ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
-          <div>{{ user | displayName }}</div>
-          <md-button ng-click="partyDetails.invite(user)">Invite</md-button>
-        </md-list-item>
-        <md-list-item ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
-          Everyone are already invited.
-        </md-list-item>
-      </md-list>
-
-      <div class="angular-google-map-container">
-        <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
-                            events="partyDetails.map.events" zoom="partyDetails.map.zoom">
-          <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
-                          events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
-          </ui-gmap-marker>
-        </ui-gmap-google-map>
-      </div>
-    </form>
-  </div>
-</div>
\ No newline at end of file
diff --git a/client/parties/party-details/party-details.import.less b/client/parties/party-details/party-details.import.less
deleted file mode 100644
index dbaf8e2..0000000
--- a/client/parties/party-details/party-details.import.less
+++ /dev/null
@@ -1,10 +0,0 @@
-party-details {
-  width: 100%;
-}
-
-.ma-party-details {
-  .angular-google-map-container, .angular-google-map {
-    width: 100%;
-    height: 400px;
-  }
-}
\ No newline at end of file
diff --git a/client/parties/styles/google-maps.css b/client/parties/styles/google-maps.css
deleted file mode 100644
index 219ff39..0000000
--- a/client/parties/styles/google-maps.css
+++ /dev/null
@@ -1,4 +0,0 @@
-.angular-google-map-container {
-    height: 400px;
-    width: 400px;
-}
\ No newline at end of file
diff --git a/client/styles/main.less b/client/styles/main.less
deleted file mode 100644
index 6c61f8e..0000000
--- a/client/styles/main.less
+++ /dev/null
@@ -1,15 +0,0 @@
-html, body {
-}
-
-md-dialog {
-  opacity: 1 !important;
-}
-
-div[ui-view] > * {
-  width: 100%;
-}
-
-@import "navbar.import.less";
-@import "../parties/parties-list/parties-list.import.less";
-@import "../parties/party-details/party-details.import.less";
-@import "../parties/add-new-party-modal/add-new-party-modal.import.less";
diff --git a/client/styles/navbar.import.less b/client/styles/navbar.import.less
deleted file mode 100644
index 3a4f13f..0000000
--- a/client/styles/navbar.import.less
+++ /dev/null
@@ -1,5 +0,0 @@
-md-toolbar {
-  h2 {
-    margin: 0;
-  }
-}
\ No newline at end of file
diff --git a/packages/socially-browser/client/auth/register/register.component.js b/packages/socially-browser/client/auth/register/register.component.js
new file mode 100644
index 0000000..0aa0163
--- /dev/null
+++ b/packages/socially-browser/client/auth/register/register.component.js
@@ -0,0 +1,28 @@
+angular.module("socially.browser").directive('register', function() {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/auth/register/register.html',
+    controllerAs: 'register',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: '',
+        password: ''
+      };
+
+      this.error = '';
+
+      this.register = () => {
+        Accounts.createUser(this.credentials, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/auth/register/register.html b/packages/socially-browser/client/auth/register/register.html
new file mode 100644
index 0000000..8100629
--- /dev/null
+++ b/packages/socially-browser/client/auth/register/register.html
@@ -0,0 +1,63 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Register a new account</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Use your email?</p>
+      </div>
+
+      <form name="registerForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container >
+          <label> Email </label>
+          <input type="text" ng-model="register.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <md-input-container >
+          <label> Password </label>
+          <input type="password" ng-model="register.credentials.password" placeholder="password" aria-label="password" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="register.register()" aria-label="login" ng-disabled="register.registerForm.$invalid()">Register</md-button>
+        </div>
+      </form>
+
+      <md-divider class="inset"></md-divider>
+
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2"> Want to use an existing account? </p>
+      </div>
+
+      <div layout="row" layout-fill layout-margin layout-padding layout-wrap>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="google" style="color: #DC4A38;"></md-icon>
+          <span> Google</span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="facebook" style="color: #3F62B4;"></md-icon>
+          <span>Facebook </span>
+        </md-button>
+        <md-button class="md-raised">
+          <md-icon md-svg-icon="twitter" style="color: #27AAE2;"></md-icon>
+          <span>Twitter </span>
+        </md-button>
+      </div>
+      <md-toolbar ng-show="register.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ register.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Already a user?</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
diff --git a/packages/socially-browser/client/auth/reset-password/reset-password.component.js b/packages/socially-browser/client/auth/reset-password/reset-password.component.js
new file mode 100644
index 0000000..fb9e59b
--- /dev/null
+++ b/packages/socially-browser/client/auth/reset-password/reset-password.component.js
@@ -0,0 +1,27 @@
+angular.module("socially.browser").directive('resetpw', function() {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/auth/reset-password/reset-password.html',
+    controllerAs: 'resetpw',
+    controller: function ($scope, $reactive, $state) {
+      $reactive(this).attach($scope);
+
+      this.credentials = {
+        email: ''
+      };
+
+      this.error = '';
+
+      this.reset = () => {
+        Accounts.forgotPassword(this.credentials, (err) => {
+          if (err) {
+            this.error = err;
+          }
+          else {
+            $state.go('parties');
+          }
+        });
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/auth/reset-password/reset-password.html b/packages/socially-browser/client/auth/reset-password/reset-password.html
new file mode 100644
index 0000000..138ecf4
--- /dev/null
+++ b/packages/socially-browser/client/auth/reset-password/reset-password.html
@@ -0,0 +1,40 @@
+<md-content layout="row" layout-align="center start" layout-fill layout-margin>
+  <md-whiteframe layout="column" flex flex-md="50" flex-lg="50" flex-gt-lg="33" class="md-whiteframe-z2" layout-fill>
+
+    <md-toolbar class="md-primary md-tall" layout="column" layout-align="end" layout-fill>
+      <div layout="row" class="md-toolbar-tools md-toolbar-tools-bottom">
+        <h3 class="md-display-1"> Reset Password</h3>
+      </div>
+    </md-toolbar>
+
+    <div layout="column" layout-fill layout-margin layout-padding>
+
+      <div layout="row" layout-fill layout-margin>
+        <p class="md-body-2">Enter your email so we can send you a reset link</p>
+      </div>
+
+      <form name="resetForm" layout="column" layout-fill layout-padding layout-margin>
+        <md-input-container>
+          <label> Email </label>
+          <input type="text" ng-model="resetpw.credentials.email" placeholder="email" aria-label="email" required/>
+        </md-input-container>
+        <div layout="row" layout-align="end center">
+          <md-button class="md-raised md-primary" ng-click="resetpw.reset()" aria-label="reset"
+                     ng-disabled="resetpw.resetForm.$invalid()">Send Email
+          </md-button>
+        </div>
+      </form>
+
+      <md-toolbar ng-show="resetpw.error" class="md-warn" layout="row" layout-fill layout-padding layout-margin>
+        <p class="md-body-1">{{ resetpw.error }}</p>
+      </md-toolbar>
+
+      <md-divider></md-divider>
+      <div layout="row" layout-align="center">
+        <a class="md-button" href="/login">Sign in</a>
+      </div>
+
+    </div>
+
+  </md-whiteframe>
+</md-content>
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.component.js b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.component.js
new file mode 100644
index 0000000..a894bc1
--- /dev/null
+++ b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.component.js
@@ -0,0 +1,69 @@
+angular.module('socially.browser').directive('addNewPartyModal', function () {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.html',
+    controllerAs: 'addNewPartyModal',
+    controller: function ($scope, $stateParams, $reactive, $mdDialog) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        }
+      });
+
+      this.newParty = {};
+
+      this.addNewParty = () => {
+        this.newParty.owner = Meteor.userId();
+        this.newParty.images = this.newParty.images.map((image) => {
+          return image._id;
+        });
+
+        Parties.insert(this.newParty);
+        this.newParty = {};
+        $mdDialog.hide();
+      };
+
+      this.close = () => {
+        $mdDialog.hide();
+      };
+
+      this.addImages = (files) => {
+        if (files.length > 0) {
+          let reader = new FileReader();
+
+          reader.onload = (e) => {
+            $scope.$apply(() => {
+              this.cropImgSrc = e.target.result;
+              this.myCroppedImage = '';
+            });
+          };
+
+          reader.readAsDataURL(files[0]);
+        }
+        else {
+          this.cropImgSrc = undefined;
+        }
+      };
+
+      this.saveCroppedImage = () => {
+        if (this.myCroppedImage !== '') {
+          Images.insert(this.myCroppedImage, (err, fileObj) => {
+            if (!this.newParty.images) {
+              this.newParty.images = [];
+            }
+
+            this.newParty.images.push(fileObj);
+            this.cropImgSrc = undefined;
+            this.myCroppedImage = '';
+          });
+        }
+      };
+
+      this.updateDescription = ($data, image) => {
+        Images.update({_id: image._id}, {$set: {'metadata.description': $data}});
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.html b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.html
new file mode 100644
index 0000000..299d8ba
--- /dev/null
+++ b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.html
@@ -0,0 +1,68 @@
+<md-dialog style="min-width: 600px;">
+  <div>
+    <md-toolbar>
+      <div class="md-toolbar-tools">
+        <h2> Create a new party</h2>
+        <span flex></span>
+      </div>
+    </md-toolbar>
+    <md-dialog-content style="min-width:300px;max-width:800px;max-height:810px; ">
+      <div ng-show="addNewPartyModal.isLoggedIn">
+        <md-input-container>
+          <label>Name</label>
+          <input ng-model="addNewPartyModal.newParty.name" id="nameInput" type="text" aria-label="Name">
+        </md-input-container>
+        <md-input-container>
+          <label>Description</label>
+          <input ng-model="addNewPartyModal.newParty.description" id="description" type="text" aria-label="Description">
+        </md-input-container>
+        <md-whiteframe class="md-whiteframe-z1" layout="column">
+          <div layout="row" class="images-container-title">
+            <div flex>
+              <h3>Add photos to your party!</h3>
+                <div ng-hide="addNewPartyModal.cropImgSrc" ngf-drop ngf-select
+                     ngf-change="addNewPartyModal.addImages($files)"
+                     ngf-drag-over-class="{accept:'dragover', reject:'dragover-err', delay:100}" class="drop-box"
+                     ngf-multiple="false" ngf-allow-dir="false" ngf-accept="'image/*'"
+                     ngf-drop-available="true">
+                  <div>Click here to select image</div>
+                  <div>
+                    <strong>OR</strong>
+                  </div>
+                  You can also drop image to here
+                </div>
+              <div ng-show="addNewPartyModal.cropImgSrc" class="ng-crop-container">
+                <h3>Great! Now edit & crop your image...</h3>
+                <md-button ng-click="addNewPartyModal.saveCroppedImage()" ng-disabled="!addNewPartyModal.cropImgSrc" class="md-primary">
+                  Save Image
+                </md-button>
+                <img-crop image="addNewPartyModal.cropImgSrc" result-image="addNewPartyModal.myCroppedImage" area-type="square"></img-crop>
+              </div>
+            </div>
+          </div>
+          <br />
+          <div layout="row" class="images-container-title" sv-root sv-part="addNewPartyModal.newParty.images">
+            <div sv-element class="party-image-container" ng-repeat="image in addNewPartyModal.newParty.images">
+              <div class="main-image" ng-show="$index === 0">Main Image</div>
+              <img draggable="false" ng-src="{{ image.url({store: 'thumbnail'}) }}"/><br/>
+              <a href="#" editable-text="image.metadata.description"
+                 onbeforesave="addNewPartyModal.updateDescription($data, image)">{{ image.metadata.description || 'Click to add description' }}</a>
+            </div>
+          </div>
+        </md-whiteframe>
+        <md-checkbox ng-model="addNewPartyModal.newParty.public" id="public" aria-label="Public">
+          Public
+        </md-checkbox>
+      </div>
+    </md-dialog-content>
+    <div class="md-actions" layout="row">
+      <span flex></span>
+      <md-button ng-click="addNewPartyModal.close()">
+        Close
+      </md-button>
+      <md-button ng-click="addNewPartyModal.addNewParty()" style="margin-right:20px;">
+        Add
+      </md-button>
+    </div>
+  </div>
+</md-dialog>
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.import.less b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.import.less
new file mode 100644
index 0000000..b609f03
--- /dev/null
+++ b/packages/socially-browser/client/parties/add-new-party-modal/add-new-party-modal.import.less
@@ -0,0 +1,53 @@
+.drop-box {
+  background: #F8F8F8;
+  border: 5px dashed #DDD;
+  width: 230px;
+  height: 120px;
+  text-align: center;
+  padding-top: 25px;
+  margin-left: 10px;
+  margin-bottom: 20px;
+}
+
+.drop-box.dragover {
+  border: 5px dashed blue;
+}
+
+.drop-box.dragover-err {
+  border: 5px dashed red;
+}
+
+.uploaded-image {
+  max-height: 100px;
+  max-width: 200px;
+}
+
+.ng-crop-container {
+  height: 400px;
+}
+
+
+.images-container-title {
+  padding-bottom: 30px;
+}
+
+.party-image-container {
+  position: relative;
+  margin-right: 10px;
+  max-height: 200px;
+  max-width: 200px;
+
+  img {
+    max-height: 100%;
+    max-width: 100%;
+  }
+}
+
+.main-image {
+  position: absolute;
+  top: 0;
+  left: 0;
+  width: 100%;
+  text-align: center;
+  background-color: #f8f8f8;
+}
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/parties-list/parties-list.component.js b/packages/socially-browser/client/parties/parties-list/parties-list.component.js
new file mode 100644
index 0000000..f7fffcb
--- /dev/null
+++ b/packages/socially-browser/client/parties/parties-list/parties-list.component.js
@@ -0,0 +1,182 @@
+angular.module('socially.browser').directive('partiesList', function () {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/parties/parties-list/parties-list.html',
+    controllerAs: 'partiesList',
+    controller: function ($scope, $reactive, $mdDialog, $filter) {
+      $reactive(this).attach($scope);
+
+      this.perPage = 3;
+      this.orderProperty = '1';
+
+      this.helpers({
+        parties: () => {
+          return Parties.find({}, {sort: this.sort});
+        },
+        users: () => {
+          return Meteor.users.find({});
+        },
+        partiesCount: () => {
+          return Counts.get('numberOfParties');
+        },
+        page: 1,
+        sort: {
+          name: 1
+        },
+        searchText: '',
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUserId: () => {
+          return Meteor.userId();
+        },
+        images: () => {
+          return Images.find({});
+        }
+      });
+
+      this.subscribe('images');
+
+      this.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        options: {
+          maxZoom: 10,
+          styles: [{
+            "featureType": "administrative",
+            "elementType": "labels.text.fill",
+            "stylers": [{"color": "#444444"}]
+          }, {
+            "featureType": "landscape",
+            "elementType": "all",
+            "stylers": [{"color": "#f2f2f2"}]
+          }, {
+            "featureType": "poi",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "road",
+            "elementType": "all",
+            "stylers": [{"saturation": -100}, {"lightness": 45}]
+          }, {
+            "featureType": "road.highway",
+            "elementType": "all",
+            "stylers": [{"visibility": "simplified"}]
+          }, {
+            "featureType": "road.arterial",
+            "elementType": "labels.icon",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "transit",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "water",
+            "elementType": "all",
+            "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+          }]
+        },
+        zoom: 8
+      };
+
+      this.subscribe('users');
+
+      this.subscribe('parties', () => {
+        return [
+          {
+            limit: parseInt(this.perPage),
+            skip: parseInt((this.page - 1) * this.perPage),
+            sort: this.sort
+          },
+          this.searchText
+        ]
+      });
+
+      this.removeParty = (party) => {
+        Parties.remove({_id: party._id});
+      };
+
+      this.pageChanged = (newPage) => {
+        this.page = newPage;
+      };
+
+      this.updateSort = () => {
+        this.sort = {
+          name: parseInt(this.orderProperty)
+        }
+      };
+
+      this.getPartyCreator = function (party) {
+        if (!party) {
+          return '';
+        }
+
+        let owner = Meteor.users.findOne(party.owner);
+
+        if (!owner) {
+          return 'nobody';
+        }
+
+        if (Meteor.userId() !== null && owner._id === Meteor.userId()) {
+          return 'me';
+        }
+
+        return owner;
+      };
+
+      this.rsvp = (partyId, rsvp) => {
+        Meteor.call('rsvp', partyId, rsvp, (error) => {
+          if (error) {
+            console.log('Oops, unable to rsvp!');
+          }
+          else {
+            console.log('RSVP Done!');
+          }
+        });
+      };
+
+      this.getUserById = (userId) => {
+        return Meteor.users.findOne(userId);
+      };
+
+      this.outstandingInvitations = (party) => {
+        return _.filter(this.users, (user) => {
+          return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
+        });
+      };
+
+      this.openAddNewPartyModal = function () {
+        $mdDialog.show({
+          template: '<add-new-party-modal></add-new-party-modal>',
+          clickOutsideToClose: true
+        });
+      };
+
+      this.isRSVP = (rsvp, party) => {
+        if (Meteor.userId() == null) {
+          return false;
+        }
+
+        let rsvpIndex = party.myRsvpIndex;
+        rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), Meteor.userId());
+
+        if (rsvpIndex !== -1) {
+          party.myRsvpIndex = rsvpIndex;
+          return party.rsvps[rsvpIndex].rsvp === rsvp;
+        }
+      };
+
+      this.getMainImage = (images) => {
+        if (images && images.length && images[0] && images[0]) {
+          var url = $filter('filter')(this.images, {_id: images[0]})[0].url();
+
+          return {
+            'background-image': 'url("' + url + '")'
+          }
+        }
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/parties-list/parties-list.html b/packages/socially-browser/client/parties/parties-list/parties-list.html
new file mode 100644
index 0000000..15ca915
--- /dev/null
+++ b/packages/socially-browser/client/parties/parties-list/parties-list.html
@@ -0,0 +1,77 @@
+<md-content flex layout="row" class="ma-parties-list">
+  <div layout="row" flex>
+    <div flex="50">
+      <div>
+        <div layout-padding layout="row">
+          <md-input-container style="width:50%;margin-right:10px;">
+            <label>Search</label>
+            <input type="text" ng-model="partiesList.searchText" placeholder="Search">
+          </md-input-container>
+          <md-select ng-model="partiesList.orderProperty" placeholder="Sort Order" md-on-close="partiesList.updateSort()">
+            <md-option value="1">Ascending</md-option>
+            <md-option value="-1">Descending</md-option>
+          </md-select>
+          <md-button ng-show="partiesList.isLoggedIn" class="md-fab" ng-click="partiesList.openAddNewPartyModal()">
+            <md-icon md-font-set="material-icons"> add </md-icon>
+          </md-button>
+        </div>
+      </div>
+      <md-content class="md-padding" style="padding-top:0;">
+        <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+        <div dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount" class="ma-party">
+          <md-card>
+            <div ng-if="party.images && party.images.length > 0"
+                 ng-style="partiesList.getMainImage(party.images)"
+                 class="party-image">
+            </div>
+            <md-card-content>
+              <h2 class="md-title ma-name" style=""><a href="/parties/{{party._id}}">{{party.name}}</a></h2>
+              <p class="ma-description" style="padding:0 10px;margin-bottom:35px;margin-top: 6px;">{{party.description}}</p>
+              <div layout="row">
+                <div flex="1">
+                  <p style="margin-top:0px;margin-bottom:3px;font-size:14px;color:#aaa;">
+                    <small>Posted by {{ partiesList.getPartyCreator(party) | displayName }}</small>
+                    <span ng-if="party.public" style="font-size:12px;color:#999;">| Everyone is invited</span>
+                  </p>
+
+                  <div ng-show="partiesList.isLoggedIn" class="md-actions" layout="row">
+                    <md-button ng-click="partiesList.rsvp(party._id, 'yes')">I'm going!</md-button>
+                    <md-button ng-click="partiesList.rsvp(party._id, 'maybe')">Maybe</md-button>
+                    <md-button ng-click="partiesList.rsvp(party._id, 'no')">No</md-button>
+                  </div>
+                </div>
+                <div  layout="row" layout-align="end end">
+                  <div ng-hide="partiesList.isLoggedIn" style="font-size:13px;margin-bottom:10px;">
+                    Sign in to RSVP for this party
+                  </div>
+                  <div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }}</div>
+                      <div class="rsvps-title">Yes</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }}</div>
+                      <div class="rsvps-title">Maybe</div>
+                    </div>
+                    <div class="rsvps-sum">
+                      <div class="rsvps-amount">{{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}</div>
+                      <div class="rsvps-title">No</div>
+                    </div>
+                  </div>
+                </div>
+              </div>
+            </md-card-content>
+          </md-card>
+        </div>
+      </md-content>
+
+    </div>
+    <div flex="50" layout="row" style="min-height:300px;">
+      <ui-gmap-google-map options="partiesList.map.options" center="partiesList.map.center" zoom="partiesList.map.zoom" flex layout="row">
+        <ui-gmap-markers models="partiesList.parties" coords="'location'"
+                         fit="true" idkey="'_id'" doRebuildAll="true">
+        </ui-gmap-markers>
+      </ui-gmap-google-map>
+    </div>
+  </div>
+</md-content>
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/parties-list/parties-list.import.less b/packages/socially-browser/client/parties/parties-list/parties-list.import.less
new file mode 100644
index 0000000..3ce0188
--- /dev/null
+++ b/packages/socially-browser/client/parties/parties-list/parties-list.import.less
@@ -0,0 +1,71 @@
+parties-list {
+  width: 100%;
+}
+
+.navbar-text {
+  margin-right: 0;
+}
+
+#login-dropdown-list.accounts-dialog {
+  right: 14px;
+  left: auto;
+}
+
+.search-form {
+  margin-bottom: 1em;
+}
+
+.ma-parties-list {
+  .angular-google-map {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
+    -webkit-flex-direction: row;
+    -ms-flex-direction: row;
+    flex-direction: row;
+    box-sizing: border-box;
+    display: -webkit-flex;
+    display: -moz-flex;
+    display: -ms-flexbox;
+    display: flex;
+  }
+
+  .angular-google-map-container {
+    box-sizing: border-box;
+    -webkit-flex: 1;
+    -ms-flex: 1;
+    flex: 1;
+  }
+
+  .rsvps-sum {
+    float: left;
+    width: 50px;
+    text-align: center;
+    .rsvps-amount {
+      font-size: 24px;
+    }
+    .rsvps-title {
+      font-size: 13px;
+      color: #aaa;
+    }
+  }
+
+  .ma-party {
+    .party-image {
+      background-size: cover;
+      width: 100%;
+      height: 200px;
+    }
+
+    .ma-name {
+      a {
+        text-decoration: none;
+        color: #333;
+      }
+    }
+    .ma-description {
+
+    }
+  }
+}
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/party-details/party-details.component.js b/packages/socially-browser/client/parties/party-details/party-details.component.js
new file mode 100644
index 0000000..e82101e
--- /dev/null
+++ b/packages/socially-browser/client/parties/party-details/party-details.component.js
@@ -0,0 +1,97 @@
+angular.module('socially.browser').directive('partyDetails', function () {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-browser/client/parties/party-details/party-details.html',
+    controllerAs: 'partyDetails',
+    controller: function ($scope, $stateParams, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.subscribe('parties');
+      this.subscribe('users');
+
+      this.helpers({
+        party: () => {
+          return Parties.findOne({_id: $stateParams.partyId});
+        },
+        users: () => {
+          return Meteor.users.find({});
+        },
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUserId: () => {
+          return Meteor.userId();
+        }
+      });
+
+      this.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        zoom: 8,
+        events: {
+          click: function (mapModel, eventName, originalEventArgs) {
+            if (!$scope.party)
+              return;
+
+            if (!$scope.party.location)
+              $scope.party.location = {};
+
+            $scope.party.location.latitude = originalEventArgs[0].latLng.lat();
+            $scope.party.location.longitude = originalEventArgs[0].latLng.lng();
+            //scope apply required because this event handler is outside of the angular domain
+            $scope.$apply();
+          }
+        },
+        marker: {
+          options: { draggable: true },
+          events: {
+            dragend: function (marker, eventName, args) {
+              if (!$scope.party.location)
+                $scope.party.location = {};
+
+              $scope.party.location.latitude = marker.getPosition().lat();
+              $scope.party.location.longitude = marker.getPosition().lng();
+            }
+          }
+        }
+      };
+
+      this.save = () => {
+        Parties.update({_id: $stateParams.partyId}, {
+          $set: {
+            name: this.party.name,
+            description: this.party.description,
+            'public': this.party.public
+          }
+        }, (error) => {
+          if (error) {
+            console.log('Oops, unable to update the party...');
+          }
+          else {
+            console.log('Done!');
+          }
+        });
+      };
+
+      this.invite = (user) => {
+        Meteor.call('invite', this.party._id, user._id, (error) => {
+          if (error) {
+            console.log('Oops, unable to invite!');
+          }
+          else {
+            console.log('Invited!');
+          }
+        });
+      };
+
+      this.canInvite = () => {
+        if (!this.party)
+          return false;
+
+        return !this.party.public && this.party.owner === Meteor.userId();
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/party-details/party-details.html b/packages/socially-browser/client/parties/party-details/party-details.html
new file mode 100644
index 0000000..4024a14
--- /dev/null
+++ b/packages/socially-browser/client/parties/party-details/party-details.html
@@ -0,0 +1,45 @@
+<div layout="row" flex class="ma-party-details">
+  <div flex="33" offset="33">
+    <legend style="margin:20px 0;">
+      Here you will see and change the details of the party:
+    </legend>
+    <form layout="column">
+      <md-input-container>
+        <label>Party Name</label>
+        <input ng-model="partyDetails.party.name" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Name">
+      </md-input-container>
+      <md-input-container>
+        <label>Party Description</label>
+        <input ng-model="partyDetails.party.description" ng-disabled="party.owner != partyDetails.currentUserId" type="text" aria-label="Description">
+      </md-input-container>
+      <md-checkbox ng-model="partyDetails.party.public" ng-disabled="party.owner != partyDetails.currentUserId" aria-label="Public">
+        Is public
+      </md-checkbox>
+
+      <div layout="row" layout-align="left">
+        <md-button ng-show="party.owner == partyDetails.currentUserId" ng-click="partyDetails.save()">Save</md-button>
+        <md-button ng-href="/parties">Back</md-button>
+      </div>
+
+      <md-list ng-show="partyDetails.canInvite()">
+        <md-subheader class="md-no-sticky">Users to invite:</md-subheader>
+        <md-list-item ng-repeat="user in partyDetails.users | uninvited:partyDetails.party">
+          <div>{{ user | displayName }}</div>
+          <md-button ng-click="partyDetails.invite(user)">Invite</md-button>
+        </md-list-item>
+        <md-list-item ng-if="(partyDetails.users | uninvited:partyDetails.party).length <= 0">
+          Everyone are already invited.
+        </md-list-item>
+      </md-list>
+
+      <div class="angular-google-map-container">
+        <ui-gmap-google-map center="partyDetails.party.location || partyDetails.map.center"
+                            events="partyDetails.map.events" zoom="partyDetails.map.zoom">
+          <ui-gmap-marker coords="partyDetails.party.location" options="partyDetails.map.marker.options"
+                          events="partyDetails.map.marker.events" idkey="partyDetails.party._id">
+          </ui-gmap-marker>
+        </ui-gmap-google-map>
+      </div>
+    </form>
+  </div>
+</div>
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/party-details/party-details.import.less b/packages/socially-browser/client/parties/party-details/party-details.import.less
new file mode 100644
index 0000000..dbaf8e2
--- /dev/null
+++ b/packages/socially-browser/client/parties/party-details/party-details.import.less
@@ -0,0 +1,10 @@
+party-details {
+  width: 100%;
+}
+
+.ma-party-details {
+  .angular-google-map-container, .angular-google-map {
+    width: 100%;
+    height: 400px;
+  }
+}
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/styles/google-maps.css b/packages/socially-browser/client/parties/styles/google-maps.css
new file mode 100644
index 0000000..219ff39
--- /dev/null
+++ b/packages/socially-browser/client/parties/styles/google-maps.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+    height: 400px;
+    width: 400px;
+}
\ No newline at end of file
diff --git a/packages/socially-browser/client/styles/main.less b/packages/socially-browser/client/styles/main.less
new file mode 100644
index 0000000..6c61f8e
--- /dev/null
+++ b/packages/socially-browser/client/styles/main.less
@@ -0,0 +1,15 @@
+html, body {
+}
+
+md-dialog {
+  opacity: 1 !important;
+}
+
+div[ui-view] > * {
+  width: 100%;
+}
+
+@import "navbar.import.less";
+@import "../parties/parties-list/parties-list.import.less";
+@import "../parties/party-details/party-details.import.less";
+@import "../parties/add-new-party-modal/add-new-party-modal.import.less";
diff --git a/packages/socially-browser/client/styles/navbar.import.less b/packages/socially-browser/client/styles/navbar.import.less
new file mode 100644
index 0000000..3a4f13f
--- /dev/null
+++ b/packages/socially-browser/client/styles/navbar.import.less
@@ -0,0 +1,5 @@
+md-toolbar {
+  h2 {
+    margin: 0;
+  }
+}
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 7a2580dc158c504dc2537263a7b7fa1c873ac6b4 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:13:02 +0200
Subject: [PATCH 231/244] Step 22.4: Update the package.js of the brower
 package

---
 packages/socially-browser/package.js | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 4093c55..0a27482 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -13,13 +13,30 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('angular');
+  api.use('less');
 
   api.addFiles([
     'client/lib/module.js',
     'client/auth/login/login.component.js',
     'client/auth/login/login.html',
+    'client/auth/register/register.component.js',
+    'client/auth/register/register.html',
+    'client/auth/reset-password/reset-password.component.js',
+    'client/auth/reset-password/reset-password.html',
     'client/socially/socially.component.js',
-    'client/socially/socially.html'
+    'client/socially/socially.html',
+    'client/parties/add-new-party-modal/add-new-party-modal.component.js',
+    'client/parties/add-new-party-modal/add-new-party-modal.html',
+    'client/parties/parties-list/parties-list.component.js',
+    'client/parties/parties-list/parties-list.html',
+    'client/parties/party-details/party-details.component.js',
+    'client/parties/party-details/party-details.html',
+    'client/parties/styles/google-maps.css',
+    'client/styles/navbar.import.less',
+    'client/parties/party-details/party-details.import.less',
+    'client/parties/parties-list/parties-list.import.less',
+    'client/parties/add-new-party-modal/add-new-party-modal.import.less',
+    'client/styles/main.less'
   ], 'client');
 });
 
-- 
2.3.2 (Apple Git-55)


From e95c138461d6124cf4848dcd6611d5ad960cdbe8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:13:11 +0200
Subject: [PATCH 232/244] Step 22.5: Move the filters

---
 client/filters/displayName.js         | 17 +++++++++++++++++
 client/filters/uninvited.js           | 11 +++++++++++
 client/parties/filters/displayName.js | 17 -----------------
 client/parties/filters/uninvited.js   | 11 -----------
 4 files changed, 28 insertions(+), 28 deletions(-)
 create mode 100644 client/filters/displayName.js
 create mode 100644 client/filters/uninvited.js
 delete mode 100644 client/parties/filters/displayName.js
 delete mode 100644 client/parties/filters/uninvited.js

diff --git a/client/filters/displayName.js b/client/filters/displayName.js
new file mode 100644
index 0000000..279eec7
--- /dev/null
+++ b/client/filters/displayName.js
@@ -0,0 +1,17 @@
+angular.module('socially').filter('displayName', function () {
+  return function (user) {
+    if (!user) {
+      return '';
+    }
+
+    if (user.profile && user.profile.name) {
+      return user.profile.name;
+    }
+    else if (user.emails) {
+      return user.emails[0].address;
+    }
+    else {
+      return user;
+    }
+  }
+});
\ No newline at end of file
diff --git a/client/filters/uninvited.js b/client/filters/uninvited.js
new file mode 100644
index 0000000..45a5360
--- /dev/null
+++ b/client/filters/uninvited.js
@@ -0,0 +1,11 @@
+angular.module('socially').filter('uninvited', function () {
+  return function (users, party) {
+    if (!party) {
+      return false;
+    }
+
+    return _.filter(users, function (user) {
+      return !(user._id == party.owner || _.contains(party.invited, user._id));
+    });
+  }
+});
\ No newline at end of file
diff --git a/client/parties/filters/displayName.js b/client/parties/filters/displayName.js
deleted file mode 100644
index 279eec7..0000000
--- a/client/parties/filters/displayName.js
+++ /dev/null
@@ -1,17 +0,0 @@
-angular.module('socially').filter('displayName', function () {
-  return function (user) {
-    if (!user) {
-      return '';
-    }
-
-    if (user.profile && user.profile.name) {
-      return user.profile.name;
-    }
-    else if (user.emails) {
-      return user.emails[0].address;
-    }
-    else {
-      return user;
-    }
-  }
-});
\ No newline at end of file
diff --git a/client/parties/filters/uninvited.js b/client/parties/filters/uninvited.js
deleted file mode 100644
index 45a5360..0000000
--- a/client/parties/filters/uninvited.js
+++ /dev/null
@@ -1,11 +0,0 @@
-angular.module('socially').filter('uninvited', function () {
-  return function (users, party) {
-    if (!party) {
-      return false;
-    }
-
-    return _.filter(users, function (user) {
-      return !(user._id == party.owner || _.contains(party.invited, user._id));
-    });
-  }
-});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From e915771b6f88ca47fa0c65fbd2704fc9e1f46e7b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:13:58 +0200
Subject: [PATCH 233/244] Step 22.6: Add driftyco:ionic package

---
 packages/socially-mobile/package.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index 56df1f5..a6b3946 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -13,6 +13,7 @@ Package.describe({
 Package.onUse(function(api) {
   api.versionsFrom('1.2.1');
   api.use('angular');
+  api.use('driftyco:ionic');
 
   api.addFiles([
     'client/lib/module.js',
-- 
2.3.2 (Apple Git-55)


From d4d7d53d59ec2dca15936a6acd6d15c84041c0bb Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:14:20 +0200
Subject: [PATCH 234/244] Step 22.7: Add dependency for ionic package

---
 packages/socially-mobile/client/lib/module.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/packages/socially-mobile/client/lib/module.js b/packages/socially-mobile/client/lib/module.js
index f078654..e87b1c4 100644
--- a/packages/socially-mobile/client/lib/module.js
+++ b/packages/socially-mobile/client/lib/module.js
@@ -1 +1 @@
-angular.module('socially.mobile', []);
\ No newline at end of file
+angular.module('socially.mobile', ['ionic']);
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 16e7ce60d18f806fcb4a080c677827244da2bf04 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:16:12 +0200
Subject: [PATCH 235/244] Step 22.8: Add the socially mobile component

---
 .../client/socially/socially.component.js          | 23 ++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100644 packages/socially-mobile/client/socially/socially.component.js

diff --git a/packages/socially-mobile/client/socially/socially.component.js b/packages/socially-mobile/client/socially/socially.component.js
new file mode 100644
index 0000000..915e63f
--- /dev/null
+++ b/packages/socially-mobile/client/socially/socially.component.js
@@ -0,0 +1,23 @@
+angular.module('socially.mobile').directive('socially', function () {
+  return {
+    restrict: 'E',
+    templateUrl: '/packages/socially-mobile/client/socially/socially.html',
+    controllerAs: 'socially',
+    controller: function ($scope, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUser: () => {
+          return Meteor.user();
+        }
+      });
+
+      this.logout = () => {
+        Accounts.logout();
+      }
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From ebb9070a2d4297efb2d6f7267dc58e0907216dc8 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:16:36 +0200
Subject: [PATCH 236/244] Step 22.9: Add the mobile socially component view

---
 .meteor/versions                                       | 3 +++
 packages/socially-mobile/client/socially/socially.html | 3 +++
 2 files changed, 6 insertions(+)
 create mode 100644 packages/socially-mobile/client/socially/socially.html

diff --git a/.meteor/versions b/.meteor/versions
index 2b69ad3..e99fc22 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -13,6 +13,7 @@ angular:angular@1.4.8
 angular:angular-animate@1.4.8
 angular:angular-aria@1.4.8
 angular:angular-material@0.11.4
+angular:angular-sanitize@1.4.8
 angularui:angular-google-maps@2.2.1
 angularui:angular-ui-bootstrap@0.13.0
 angularui:angular-ui-router@0.2.15
@@ -58,6 +59,7 @@ ddp-server@1.2.2
 deps@1.0.9
 diff-sequence@1.0.1
 dotansimha:accounts-ui-angular@0.0.2
+driftyco:ionic@1.1.0_2
 ecmascript@0.1.6
 ecmascript-runtime@0.2.6
 ejson@1.0.7
@@ -125,6 +127,7 @@ tracker@1.0.9
 twitter@1.1.5
 ui@1.0.8
 underscore@1.0.4
+urigo:cancel-fastclick@0.0.2
 url@1.0.5
 vitalets:angular-xeditable@0.1.9
 webapp@1.2.3
diff --git a/packages/socially-mobile/client/socially/socially.html b/packages/socially-mobile/client/socially/socially.html
new file mode 100644
index 0000000..3045103
--- /dev/null
+++ b/packages/socially-mobile/client/socially/socially.html
@@ -0,0 +1,3 @@
+<ion-nav-bar class="bar-positive" align-title="center">
+</ion-nav-bar>
+<ion-nav-view></ion-nav-view>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 3dd077dd010e106f64d6161c5fbdb15c5736e24b Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:21:17 +0200
Subject: [PATCH 237/244] Step 22.10: Update mobile package.js

---
 packages/socially-mobile/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index a6b3946..d6c81f6 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -18,7 +18,8 @@ Package.onUse(function(api) {
   api.addFiles([
     'client/lib/module.js',
     'client/auth/login/login.component.js',
-    'client/auth/login/login.html'
+    'client/auth/login/login.html',
+    'client/socially/socially.html'
   ], 'client');
 });
 
-- 
2.3.2 (Apple Git-55)


From 8b6802a75b75ecfc0768b9020fc098efd56ea3c3 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:22:52 +0200
Subject: [PATCH 238/244] Step 22.11: Share the socially component logic!

---
 client/socially/socially.component.js | 30 ++++++++++++++++++++++++++++++
 1 file changed, 30 insertions(+)
 create mode 100644 client/socially/socially.component.js

diff --git a/client/socially/socially.component.js b/client/socially/socially.component.js
new file mode 100644
index 0000000..1f263e4
--- /dev/null
+++ b/client/socially/socially.component.js
@@ -0,0 +1,30 @@
+angular.module('socially').directive('socially', function () {
+  return {
+    restrict: 'E',
+    templateUrl: () => {
+      if (Meteor.isCordova) {
+        return '/packages/socially-mobile/client/socially/socially.html';
+      }
+      else {
+        return '/packages/socially-browser/client/socially/socially.html';
+      }
+    },
+    controllerAs: 'socially',
+    controller: function ($scope, $reactive) {
+      $reactive(this).attach($scope);
+
+      this.helpers({
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUser: () => {
+          return Meteor.user();
+        }
+      });
+
+      this.logout = () => {
+        Accounts.logout();
+      }
+    }
+  }
+});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 005f819f5e0151cb16d032c7c1c510ac6ae5708f Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:23:18 +0200
Subject: [PATCH 239/244] Step 22.12: Remove the socially logic from the
 browser package

---
 packages/socially-browser/package.js | 1 -
 1 file changed, 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 0a27482..2a10b3c 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -23,7 +23,6 @@ Package.onUse(function(api) {
     'client/auth/register/register.html',
     'client/auth/reset-password/reset-password.component.js',
     'client/auth/reset-password/reset-password.html',
-    'client/socially/socially.component.js',
     'client/socially/socially.html',
     'client/parties/add-new-party-modal/add-new-party-modal.component.js',
     'client/parties/add-new-party-modal/add-new-party-modal.html',
-- 
2.3.2 (Apple Git-55)


From 48a93f64e81da0c731609fad4e3b4e8a71811276 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:23:47 +0200
Subject: [PATCH 240/244] Some cleanup

---
 .../client/socially/socially.component.js          | 23 ----------------------
 .../client/socially/socially.component.js          | 23 ----------------------
 2 files changed, 46 deletions(-)
 delete mode 100644 packages/socially-browser/client/socially/socially.component.js
 delete mode 100644 packages/socially-mobile/client/socially/socially.component.js

diff --git a/packages/socially-browser/client/socially/socially.component.js b/packages/socially-browser/client/socially/socially.component.js
deleted file mode 100644
index a77e445..0000000
--- a/packages/socially-browser/client/socially/socially.component.js
+++ /dev/null
@@ -1,23 +0,0 @@
-angular.module('socially.browser').directive('socially', function () {
-  return {
-    restrict: 'E',
-    templateUrl: '/packages/socially-browser/client/socially/socially.html',
-    controllerAs: 'socially',
-    controller: function ($scope, $reactive) {
-      $reactive(this).attach($scope);
-
-      this.helpers({
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUser: () => {
-          return Meteor.user();
-        }
-      });
-
-      this.logout = () => {
-        Accounts.logout();
-      }
-    }
-  }
-});
\ No newline at end of file
diff --git a/packages/socially-mobile/client/socially/socially.component.js b/packages/socially-mobile/client/socially/socially.component.js
deleted file mode 100644
index 915e63f..0000000
--- a/packages/socially-mobile/client/socially/socially.component.js
+++ /dev/null
@@ -1,23 +0,0 @@
-angular.module('socially.mobile').directive('socially', function () {
-  return {
-    restrict: 'E',
-    templateUrl: '/packages/socially-mobile/client/socially/socially.html',
-    controllerAs: 'socially',
-    controller: function ($scope, $reactive) {
-      $reactive(this).attach($scope);
-
-      this.helpers({
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUser: () => {
-          return Meteor.user();
-        }
-      });
-
-      this.logout = () => {
-        Accounts.logout();
-      }
-    }
-  }
-});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 51707365864ad608c8165d78b640a12007190f3c Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:46:31 +0200
Subject: [PATCH 241/244] Step 22.13: Add mobile parties list view

---
 .../client/parties/parties-list/parties-list.html    | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 packages/socially-mobile/client/parties/parties-list/parties-list.html

diff --git a/packages/socially-mobile/client/parties/parties-list/parties-list.html b/packages/socially-mobile/client/parties/parties-list/parties-list.html
new file mode 100644
index 0000000..7e42f5e
--- /dev/null
+++ b/packages/socially-mobile/client/parties/parties-list/parties-list.html
@@ -0,0 +1,20 @@
+<ion-view title="Socially" hide-back-button="true">
+  <ion-content class="padding">
+    <div class="list card">
+      <div ng-repeat="party in partiesList.parties">
+        <div class="item" ng-class="{'item-avatar': party.images && party.images.length > 0}">
+          <img ng-if="party.images && party.images.length > 0" ng-src="{{ partiesList.getMainImage(party.images, true) }}">
+          {{party.name}}
+        </div>
+        <div class="item item-text-wrap">
+          {{party.description}}
+        </div>
+        <div class="item item-divider">
+          Yes: {{ (party.rsvps | filter:{rsvp:'yes'}).length || "0" }},
+          Maybe: {{ (party.rsvps | filter:{rsvp:'maybe'}).length || "0" }},
+          No: {{ (party.rsvps | filter:{rsvp:'no'}).length || "0" }}
+        </div>
+      </div>
+    </div>
+  </ion-content>
+</ion-view>
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 190fa4c6a593a05ff091b64ffdf4b51cc70ae238 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:46:44 +0200
Subject: [PATCH 242/244] Step 22.14: Update package.js

---
 packages/socially-mobile/package.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/packages/socially-mobile/package.js b/packages/socially-mobile/package.js
index d6c81f6..e74d15b 100644
--- a/packages/socially-mobile/package.js
+++ b/packages/socially-mobile/package.js
@@ -19,7 +19,8 @@ Package.onUse(function(api) {
     'client/lib/module.js',
     'client/auth/login/login.component.js',
     'client/auth/login/login.html',
-    'client/socially/socially.html'
+    'client/socially/socially.html',
+    'client/parties/parties-list/parties-list.html'
   ], 'client');
 });
 
-- 
2.3.2 (Apple Git-55)


From a185eaa75374c0c3395f8ac94ea37ce0609e552d Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:47:08 +0200
Subject: [PATCH 243/244] Step 22.15: Move the parties list back to the root
 project

---
 .../parties/parties-list/parties-list.component.js | 192 +++++++++++++++++++++
 .../parties/parties-list/parties-list.component.js | 182 -------------------
 2 files changed, 192 insertions(+), 182 deletions(-)
 create mode 100644 client/parties/parties-list/parties-list.component.js
 delete mode 100644 packages/socially-browser/client/parties/parties-list/parties-list.component.js

diff --git a/client/parties/parties-list/parties-list.component.js b/client/parties/parties-list/parties-list.component.js
new file mode 100644
index 0000000..41cf2ca
--- /dev/null
+++ b/client/parties/parties-list/parties-list.component.js
@@ -0,0 +1,192 @@
+angular.module('socially').directive('partiesList', function () {
+  return {
+    restrict: 'E',
+    templateUrl: () => {
+      if (Meteor.isCordova) {
+        return '/packages/socially-mobile/client/parties/parties-list/parties-list.html';
+      }
+
+      return '/packages/socially-browser/client/parties/parties-list/parties-list.html';
+    },
+    controllerAs: 'partiesList',
+    controller: function ($scope, $reactive, $mdDialog, $filter) {
+      $reactive(this).attach($scope);
+
+      this.perPage = 3;
+      this.orderProperty = '1';
+
+      this.helpers({
+        parties: () => {
+          return Parties.find({}, {sort: this.sort});
+        },
+        users: () => {
+          return Meteor.users.find({});
+        },
+        partiesCount: () => {
+          return Counts.get('numberOfParties');
+        },
+        page: 1,
+        sort: {
+          name: 1
+        },
+        searchText: '',
+        isLoggedIn: () => {
+          return Meteor.userId() !== null;
+        },
+        currentUserId: () => {
+          return Meteor.userId();
+        },
+        images: () => {
+          return Images.find({});
+        }
+      });
+
+      this.subscribe('images');
+
+      this.map = {
+        center: {
+          latitude: 45,
+          longitude: -73
+        },
+        options: {
+          maxZoom: 10,
+          styles: [{
+            "featureType": "administrative",
+            "elementType": "labels.text.fill",
+            "stylers": [{"color": "#444444"}]
+          }, {
+            "featureType": "landscape",
+            "elementType": "all",
+            "stylers": [{"color": "#f2f2f2"}]
+          }, {
+            "featureType": "poi",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "road",
+            "elementType": "all",
+            "stylers": [{"saturation": -100}, {"lightness": 45}]
+          }, {
+            "featureType": "road.highway",
+            "elementType": "all",
+            "stylers": [{"visibility": "simplified"}]
+          }, {
+            "featureType": "road.arterial",
+            "elementType": "labels.icon",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "transit",
+            "elementType": "all",
+            "stylers": [{"visibility": "off"}]
+          }, {
+            "featureType": "water",
+            "elementType": "all",
+            "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
+          }]
+        },
+        zoom: 8
+      };
+
+      this.subscribe('users');
+
+      this.subscribe('parties', () => {
+        return [
+          {
+            limit: parseInt(this.perPage),
+            skip: parseInt((this.page - 1) * this.perPage),
+            sort: this.sort
+          },
+          this.searchText
+        ]
+      });
+
+      this.removeParty = (party) => {
+        Parties.remove({_id: party._id});
+      };
+
+      this.pageChanged = (newPage) => {
+        this.page = newPage;
+      };
+
+      this.updateSort = () => {
+        this.sort = {
+          name: parseInt(this.orderProperty)
+        }
+      };
+
+      this.getPartyCreator = function (party) {
+        if (!party) {
+          return '';
+        }
+
+        let owner = Meteor.users.findOne(party.owner);
+
+        if (!owner) {
+          return 'nobody';
+        }
+
+        if (Meteor.userId() !== null && owner._id === Meteor.userId()) {
+          return 'me';
+        }
+
+        return owner;
+      };
+
+      this.rsvp = (partyId, rsvp) => {
+        Meteor.call('rsvp', partyId, rsvp, (error) => {
+          if (error) {
+            console.log('Oops, unable to rsvp!');
+          }
+          else {
+            console.log('RSVP Done!');
+          }
+        });
+      };
+
+      this.getUserById = (userId) => {
+        return Meteor.users.findOne(userId);
+      };
+
+      this.outstandingInvitations = (party) => {
+        return _.filter(this.users, (user) => {
+          return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
+        });
+      };
+
+      this.openAddNewPartyModal = function () {
+        $mdDialog.show({
+          template: '<add-new-party-modal></add-new-party-modal>',
+          clickOutsideToClose: true
+        });
+      };
+
+      this.isRSVP = (rsvp, party) => {
+        if (Meteor.userId() == null) {
+          return false;
+        }
+
+        let rsvpIndex = party.myRsvpIndex;
+        rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), Meteor.userId());
+
+        if (rsvpIndex !== -1) {
+          party.myRsvpIndex = rsvpIndex;
+          return party.rsvps[rsvpIndex].rsvp === rsvp;
+        }
+      };
+
+      this.getMainImage = (images, onlyUrl) => {
+        if (images && images.length && images[0] && images[0]) {
+          var url = $filter('filter')(this.images, {_id: images[0]})[0].url();
+
+          if (onlyUrl) {
+            return url;
+          }
+
+          return {
+            'background-image': 'url("' + url + '")'
+          }
+        }
+      };
+    }
+  }
+});
\ No newline at end of file
diff --git a/packages/socially-browser/client/parties/parties-list/parties-list.component.js b/packages/socially-browser/client/parties/parties-list/parties-list.component.js
deleted file mode 100644
index f7fffcb..0000000
--- a/packages/socially-browser/client/parties/parties-list/parties-list.component.js
+++ /dev/null
@@ -1,182 +0,0 @@
-angular.module('socially.browser').directive('partiesList', function () {
-  return {
-    restrict: 'E',
-    templateUrl: '/packages/socially-browser/client/parties/parties-list/parties-list.html',
-    controllerAs: 'partiesList',
-    controller: function ($scope, $reactive, $mdDialog, $filter) {
-      $reactive(this).attach($scope);
-
-      this.perPage = 3;
-      this.orderProperty = '1';
-
-      this.helpers({
-        parties: () => {
-          return Parties.find({}, {sort: this.sort});
-        },
-        users: () => {
-          return Meteor.users.find({});
-        },
-        partiesCount: () => {
-          return Counts.get('numberOfParties');
-        },
-        page: 1,
-        sort: {
-          name: 1
-        },
-        searchText: '',
-        isLoggedIn: () => {
-          return Meteor.userId() !== null;
-        },
-        currentUserId: () => {
-          return Meteor.userId();
-        },
-        images: () => {
-          return Images.find({});
-        }
-      });
-
-      this.subscribe('images');
-
-      this.map = {
-        center: {
-          latitude: 45,
-          longitude: -73
-        },
-        options: {
-          maxZoom: 10,
-          styles: [{
-            "featureType": "administrative",
-            "elementType": "labels.text.fill",
-            "stylers": [{"color": "#444444"}]
-          }, {
-            "featureType": "landscape",
-            "elementType": "all",
-            "stylers": [{"color": "#f2f2f2"}]
-          }, {
-            "featureType": "poi",
-            "elementType": "all",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "road",
-            "elementType": "all",
-            "stylers": [{"saturation": -100}, {"lightness": 45}]
-          }, {
-            "featureType": "road.highway",
-            "elementType": "all",
-            "stylers": [{"visibility": "simplified"}]
-          }, {
-            "featureType": "road.arterial",
-            "elementType": "labels.icon",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "transit",
-            "elementType": "all",
-            "stylers": [{"visibility": "off"}]
-          }, {
-            "featureType": "water",
-            "elementType": "all",
-            "stylers": [{"color": "#46bcec"}, {"visibility": "on"}]
-          }]
-        },
-        zoom: 8
-      };
-
-      this.subscribe('users');
-
-      this.subscribe('parties', () => {
-        return [
-          {
-            limit: parseInt(this.perPage),
-            skip: parseInt((this.page - 1) * this.perPage),
-            sort: this.sort
-          },
-          this.searchText
-        ]
-      });
-
-      this.removeParty = (party) => {
-        Parties.remove({_id: party._id});
-      };
-
-      this.pageChanged = (newPage) => {
-        this.page = newPage;
-      };
-
-      this.updateSort = () => {
-        this.sort = {
-          name: parseInt(this.orderProperty)
-        }
-      };
-
-      this.getPartyCreator = function (party) {
-        if (!party) {
-          return '';
-        }
-
-        let owner = Meteor.users.findOne(party.owner);
-
-        if (!owner) {
-          return 'nobody';
-        }
-
-        if (Meteor.userId() !== null && owner._id === Meteor.userId()) {
-          return 'me';
-        }
-
-        return owner;
-      };
-
-      this.rsvp = (partyId, rsvp) => {
-        Meteor.call('rsvp', partyId, rsvp, (error) => {
-          if (error) {
-            console.log('Oops, unable to rsvp!');
-          }
-          else {
-            console.log('RSVP Done!');
-          }
-        });
-      };
-
-      this.getUserById = (userId) => {
-        return Meteor.users.findOne(userId);
-      };
-
-      this.outstandingInvitations = (party) => {
-        return _.filter(this.users, (user) => {
-          return (_.contains(party.invited, user._id) && !_.findWhere(party.rsvps, {user: user._id}));
-        });
-      };
-
-      this.openAddNewPartyModal = function () {
-        $mdDialog.show({
-          template: '<add-new-party-modal></add-new-party-modal>',
-          clickOutsideToClose: true
-        });
-      };
-
-      this.isRSVP = (rsvp, party) => {
-        if (Meteor.userId() == null) {
-          return false;
-        }
-
-        let rsvpIndex = party.myRsvpIndex;
-        rsvpIndex = rsvpIndex || _.indexOf(_.pluck(party.rsvps, 'user'), Meteor.userId());
-
-        if (rsvpIndex !== -1) {
-          party.myRsvpIndex = rsvpIndex;
-          return party.rsvps[rsvpIndex].rsvp === rsvp;
-        }
-      };
-
-      this.getMainImage = (images) => {
-        if (images && images.length && images[0] && images[0]) {
-          var url = $filter('filter')(this.images, {_id: images[0]})[0].url();
-
-          return {
-            'background-image': 'url("' + url + '")'
-          }
-        }
-      };
-    }
-  }
-});
\ No newline at end of file
-- 
2.3.2 (Apple Git-55)


From 2b4256b10c0d94b192df409bf5a3ff4355d13727 Mon Sep 17 00:00:00 2001
From: Dotan Simha <dotansimha@gmail.com>
Date: Sat, 5 Dec 2015 21:47:22 +0200
Subject: [PATCH 244/244] Step 22.16: Update browser package.js

---
 packages/socially-browser/package.js | 1 -
 1 file changed, 1 deletion(-)

diff --git a/packages/socially-browser/package.js b/packages/socially-browser/package.js
index 2a10b3c..2fc6dea 100644
--- a/packages/socially-browser/package.js
+++ b/packages/socially-browser/package.js
@@ -26,7 +26,6 @@ Package.onUse(function(api) {
     'client/socially/socially.html',
     'client/parties/add-new-party-modal/add-new-party-modal.component.js',
     'client/parties/add-new-party-modal/add-new-party-modal.html',
-    'client/parties/parties-list/parties-list.component.js',
     'client/parties/parties-list/parties-list.html',
     'client/parties/party-details/party-details.component.js',
     'client/parties/party-details/party-details.html',
-- 
2.3.2 (Apple Git-55)

